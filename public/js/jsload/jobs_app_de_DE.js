
var $CL={UNDEFINED_CLASS:404,loadStack:{},LANGUAGE:'de_DE',instances:{},factories:{},fallback_factories:[],non_shared_services:[],invokables:{},stateging:"production",vars:{},basePath:"",beforeAjaxSendListeners:[],init:function(){this.$=jQuery;if(this.has(navigator,"language"))
this.LANGUAGE=navigator.language;else if(this.has(navigator,"browserLanguage"))
this.LANGUAGE=navigator.browserLanguage;this.$.ajaxSetup({beforeSend:$CL.bind(function(jqXhr,request){_.each(this.beforeAjaxSendListeners,function(listener){listener(jqXhr,request);});},this)});if(this.basePath!==""){this.attachBeforeAjaxSend($CL.bind(function(jqXhr,request){var url=request.url;request.url=this.basePath+'/'+url.replace(/^\/(.*)/,'$1');},this));}
this.$.each(this.loadStack,this.bind(function(key,className){var obj=this.makeObj(className);this.register(key,obj);},this));},namespace:function(namespace){var parts=namespace.split("."),parent=window,currentPart='';for(var i=0,length=parts.length;i<length;i++){currentPart=parts[i];parent[currentPart]=parent[currentPart]||{};parent=parent[currentPart];}
return parent;},register:function(key,value){this.instances[key]=value;return this;},unset:function(key){delete this.instances[key];},makeObj:function(className,params){try{if(!this.classExists(className)){throw this.UNDEFINED_CLASS;}
var ClassConstructor=this.namespace(className);if(!this.isDefined(params)){var obj=new ClassConstructor();}else{var obj=new ClassConstructor(params);}
if(typeof obj!="object"){this.exception("undefined class: "+className,"Cl_Core");}
if(_.isFunction(obj.setup)){obj.setup(params||{});}
this.initObj(obj,className);}catch(err){this.exception(err,"Cl_Core",{makeObj:className,params:params});}
return obj;},initObj:function(obj,className){if(!this.has(obj,"__CLASSNAME__")){obj["__CLASSNAME__"]=className;if(_.isFunction(obj.init))
obj.init();}},get:function(key,params){if(!this.isDefined(params)&&this.has(this.instances,key)){return this.instances[key];}
var service=null;if(this.has(this.invokables,key)){var className="";if(typeof this.invokables[key]=="function"){className=this.className(this.invokables[key]);}else{className=this.invokables[key];}
service=this.makeObj(className,params);}else if(this.has(this.factories,key)){var fName=this.factories[key];var factory;if(this.isType(fName,"function")){service=fName(this,params);}else{if(!this.classExists(fName)){this.exception("Factory can not be found","Cl_Core",{factoryName:fName});}
factory=this.makeObj(fName);if(!this.isInstanceOf(factory,Cl.Service.FactoryInterface)){this.exception("factory has to be instance of Cl.Service.FactoryInterface","Cl_Core",{"factoryClass":this.className(factory)});}
service=factory.createService(this,params);}}else if(this.classExists(key)){service=this.makeObj(key,params);}else{for(var i=0;i<this.fallback_factories.length;i++){var fFactory=null;if(typeof this.fallback_factories[i]=="string"){fFactory=this.makeObj(this.fallback_factories[i]);this.fallback_factories[i]=fFactory;}
if(!this.isInstanceOf(fFactory,Cl.Service.FallbackFactoryInterface)){this.exception("FallbackFactory has to be instance of Cl.Service.FallbackFactoryInterface","Cl_Core",{"factoryClass":this.className(fFactory)});}
if(fFactory.canCreateService(key,this,params)){return fFactory.createService(key,this,params);}}}
if(_.indexOf(this.non_shared_services,key)==-1){this.register(key,service);}
return service;},addServiceConfig:function(config){if(this.has(config,'invokables')){_.extend(this.invokables,config.invokables);}
if(this.has(config,'factories')){_.extend(this.factories,config.factories);}
if(this.has(config,'fallback_factories')){$.each(config.fallback_factories,this.bind(function(i,factory){this.fallback_factories[this.fallback_factories.length]=factory;},this));}
if(this.has(config,'non_shared_services')){$.each(config.non_shared_services,this.bind(function(i,serviceKey){this.non_shared_services.push(serviceKey);},this));}},extendClass:function(child,parent,proto){if(!this.isDefined(proto)){proto={};}
if(this.isType(parent['extend'],'function')){child=parent.extend(proto);child.prototype.parent=parent;return child;}
try{var tmpClass=child;child.prototype=new parent();child.prototype.constructor=tmpClass;child.prototype.parent=parent.prototype;for(var key in proto){child.prototype[key]=proto[key];}
return child;}catch(err){$CL.exception(err,"Cl.Core",{child:child,parent:parent,proto:proto});}},bind:function(func,c){return function(){return func.apply(c,arguments);}},require:function(className){},classExists:function(className){var parts=className.split("."),parent=window,currentPart='';for(var i=0,length=parts.length;i<length;i++){currentPart=parts[i];if(!this.isDefined(parent[currentPart])){return false;}
parent=parent[currentPart];}
if(!$CL.isDefined(parent.prototype)){return false;}
return _.isFunction(parent.prototype.constructor);},isInstanceOf:function(obj,className){if(typeof obj=="undefined"){$CL.exception("can not check if object is instance of "
+className
+", cause object is undefined","Cl.Core")}
if(obj instanceof className){return true;}
if(_.isNull(obj)||_.isString(obj)){return false;}
if(typeof obj["__IMPLEMENTS__"]!="undefined"){for(var i=0;i<obj["__IMPLEMENTS__"].length;i++){if(obj["__IMPLEMENTS__"][i]==className){return true;}}}
return false;},className:function(obj){if(typeof obj=="undefined"){return"undefined";}
if(this.has(obj,"__CLASSNAME__")){return obj["__CLASSNAME__"];}else if(typeof obj=="function"){var match=obj.toString().match(/function ([^\(]+).+/);if(match){return match[1];}
return"anonymos function";}else{return typeof obj;}},exception:function(msg,cl,args){if(typeof args=="undefined")
args="";else
args="\nargs: "+JSON.stringify(args);throw new Error(msg+"\nin "+cl+args);},implementThis:function(){$CL.exception("function not implemented",$CL.className(arguments.callee),arguments.callee.caller);},variable:function(key,defaultValue){if(this.isDefined(this.vars,key)){return this.vars[key];}else{return defaultValue;}},isType:function(key,type){return typeof key==type;},isEmpty:function(mixed){if(typeof mixed=="undefined")
return true;else if(typeof mixed=="string"&&(mixed==""||mixed===null))
return true;else if(typeof mixed=="array"&&mixed.legth==0)
return true;else if(typeof mixed=="object"){var check=true;for(var key in mixed){check=false;break;}
return check;}else if(mixed===null)
return true;return false;},has:function(obj,key){return typeof obj[key]!="undefined";},isDefined:function(obj){return typeof obj!="undefined";},pause:function(millis)
{var date=new Date();var curDate=null;do{curDate=new Date();}
while(curDate-date<millis);},log:function(){if(typeof window.console!="undefined")
{if(this.isDefined(console.log)&&this.stateging!="production"){if(this.isType(console.log,'function')){console.log.apply(console,arguments);}
else{$.each(arguments,function(key,value){console.log(value);});}}}},translate:function(value){return value;},setLanguage:function(language){this.LANGUAGE=language;},setStaging:function(stateging){this.stateging=stateging;},clone:function(obj){var newObj={},value=null;if(!_.isObject(obj)&&!_.isArray(obj)){return false;}
if(_.isArray(obj)){newObj=[];}
if($CL.has(obj,'toJSON')){obj=obj.toJSON();}
for(var key in obj){value=obj[key];if(_.isArray(value)||_.isObject(value)){newObj[key]=this.clone(value);}else{newObj[key]=value;}}
return newObj;},jTarget:function(targetEl,nodeName){if(targetEl.nodeName.toLowerCase()==nodeName){return $(targetEl);}
return $(targetEl).parents(nodeName);},sjax:function(){return{get:function(url,callback,type){$.ajaxSetup({async:false});var jqXhr=$.get(url,callback,type);$.ajaxSetup({async:true});return jqXhr;},post:function(url,data,callback,type){$.ajaxSetup({async:false});var jqXhr=$.post(url,data,callback,type);$.ajaxSetup({async:true});return jqXhr;}}},attachBeforeAjaxSend:function(listener){this.beforeAjaxSendListeners.push(listener);},_template:function(tplName){if(!$CL.isDefined(__TEMPLATES__[tplName])){this.exception('Template can not be found!',"Cl.Core",{tplName:tplName});}
return _.template(__TEMPLATES__[tplName]);},setUri:function(uri){window.location.href=this.basePath+uri;},app:function(){return this.get("application");}};var View=$CL.namespace('Cl.Form.View');View.ErrorUl={print:function(errors,elementName,onlyFirst){var html="";if($CL.isDefined(elementName)){if(!$CL.isDefined(errors[elementName])){return html;}
errors={elementName:errors[elementName]};}
if(!$CL.isDefined(onlyFirst)){onlyFirst=true;}
if($CL.isEmpty(errors)){return html;}
html='';var count=0;_.each(errors,function(errors){_.each(errors,function(error){if(onlyFirst&&count>0){return;}
html+='<div class="alert alert-error">'+error.msg+'</div>';count++;});});return html;}}
var View=$CL.namespace('Cl.Form.View');$CL.require('Cl.Form.View.ErrorUl');View.Password={print:function(element,errors,displayErrorMsgs){var html="";if(!$CL.isDefined(displayErrorMsgs)){displayErrorMsgs=true;}
if(displayErrorMsgs){html+=Cl.Form.View.ErrorUl.print(errors,element.getName());}
if(!_.isNull(element.getLabel())){html+='<label for="'+element.getName()+'"><span>'+element.getLabel()+'&nbsp;</span>';}
html+='<input name="'+element.getName()+'" type="password" value="'+_.escape(element.getValue())+'"';html+=($CL.isDefined(errors[element.getName()]))?' class="'+element.errorClass+'"':'';html+=' />';if(!_.isNull(element.getLabel())){html+='</label>';}
return html;}};var View=$CL.namespace('Cl.Form.View');$CL.require('Cl.Form.View.ErrorUl');View.InputText={print:function(element,errors,displayErrorMsgs){var html="";if(!$CL.isDefined(displayErrorMsgs)){displayErrorMsgs=true;}
if(displayErrorMsgs){html+=Cl.Form.View.ErrorUl.print(errors,element.getName());}
if(!_.isNull(element.getLabel())){html+='<label for="'+element.getName()+'"><span>'+element.getLabel()+'&nbsp;</span>';}
html+='<input name="'+element.getName()+'" type="text" value="'+_.escape(element.getValue())+'"';html+=($CL.isDefined(errors[element.getName()]))?' class="'+element.errorClass+'"':'';html+=' />';if(!_.isNull(element.getLabel())){html+='</label>';}
return html;}};var Event=$CL.namespace("Cl.Event");Event.Event=function Event(){};(function(e){e.prototype={setup:function(options){this.propagationStopped=false;this.name=options.name;this.target=options.target;this.params={};if($CL.has(options,"params"))
this.params=_.extend(this.params,options.params);},getParam:function(name,defaultValue){return $CL.has(this.params,name)?this.params[name]:$CL.isDefined(defaultValue)?defaultValue:null;},setParam:function(name,value){this.params[name]=value;return this;},stopPropagation:function(){this.propagationStopped=true;},isPropagationStopped:function(){return this.propagationStopped;}}})(Event.Event);$CL.non_shared_services.push("Cl.Event.Event");var Event=$CL.namespace("Cl.Event");Event.Manager=function(){this.emInstanceId;};(function(m){m.prototype={setup:function(options){this.emInstanceId=this.getSharedManager().getNewInstanceId();this.target=options.target;},getSharedManager:function(){var sharedEM=$CL.get("shared_event_manager");if(null===sharedEM){$CL.exception("Can not get shared EventManager from ServiceManager","Cl.Event.Manager");}
return sharedEM;},attach:function(event,listener,priority,triggerOnce){this.getSharedManager().attach(this.target+'___'+this.emInstanceId,event,listener,priority,triggerOnce);},detach:function(event,listener){this.getSharedManager().detach(this.target+'___'+this.emInstanceId,event,listener);},trigger:function(event){if($CL.isInstanceOf(event,Cl.Event.Event)){if(!$CL.isDefined(event.target)||_.isNull(event.target)){event.target=this.target;}
if(event.target==this.target){event.target+='___'+this.emInstanceId;return this.getSharedManager().trigger(event);}}else if(_.isString(event)){return this.getSharedManager().trigger(this.target+'___'+this.emInstanceId,event);}
$CL.exception("Unknown event provided","Cl.Event.Manager",event);}}})(Event.Manager);$CL.non_shared_services.push("event_manager");$CL.invokables["event_manager"]="Cl.Event.Manager";var View=$CL.namespace("Cl.Application.View");View.RendererInterface=function RendererInterface(){};View.RendererInterface.prototype={render:function(){$CL.implementThis();}};(function(){var t=this;var e=t.Backbone;var i=[];var r=i.push;var s=i.slice;var n=i.splice;var a;if(typeof exports!=="undefined"){a=exports}else{a=t.Backbone={}}a.VERSION="1.0.0";var h=t._;if(!h&&typeof require!=="undefined")h=require("underscore");a.$=t.jQuery||t.Zepto||t.ender||t.$;a.noConflict=function(){t.Backbone=e;return this};a.emulateHTTP=false;a.emulateJSON=false;var o=a.Events={on:function(t,e,i){if(!l(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);r.push({callback:e,context:i,ctx:i||this});return this},once:function(t,e,i){if(!l(this,"once",t,[e,i])||!e)return this;var r=this;var s=h.once(function(){r.off(t,s);e.apply(this,arguments)});s._callback=e;return this.on(t,s,i)},off:function(t,e,i){var r,s,n,a,o,u,c,f;if(!this._events||!l(this,"off",t,[e,i]))return this;if(!t&&!e&&!i){this._events={};return this}a=t?[t]:h.keys(this._events);for(o=0,u=a.length;o<u;o++){t=a[o];if(n=this._events[t]){this._events[t]=r=[];if(e||i){for(c=0,f=n.length;c<f;c++){s=n[c];if(e&&e!==s.callback&&e!==s.callback._callback||i&&i!==s.context){r.push(s)}}}if(!r.length)delete this._events[t]}}return this},trigger:function(t){if(!this._events)return this;var e=s.call(arguments,1);if(!l(this,"trigger",t,e))return this;var i=this._events[t];var r=this._events.all;if(i)c(i,e);if(r)c(r,arguments);return this},stopListening:function(t,e,i){var r=this._listeners;if(!r)return this;var s=!e&&!i;if(typeof e==="object")i=this;if(t)(r={})[t._listenerId]=t;for(var n in r){r[n].off(e,i,this);if(s)delete this._listeners[n]}return this}};var u=/\s+/;var l=function(t,e,i,r){if(!i)return true;if(typeof i==="object"){for(var s in i){t[e].apply(t,[s,i[s]].concat(r))}return false}if(u.test(i)){var n=i.split(u);for(var a=0,h=n.length;a<h;a++){t[e].apply(t,[n[a]].concat(r))}return false}return true};var c=function(t,e){var i,r=-1,s=t.length,n=e[0],a=e[1],h=e[2];switch(e.length){case 0:while(++r<s)(i=t[r]).callback.call(i.ctx);return;case 1:while(++r<s)(i=t[r]).callback.call(i.ctx,n);return;case 2:while(++r<s)(i=t[r]).callback.call(i.ctx,n,a);return;case 3:while(++r<s)(i=t[r]).callback.call(i.ctx,n,a,h);return;default:while(++r<s)(i=t[r]).callback.apply(i.ctx,e)}};var f={listenTo:"on",listenToOnce:"once"};h.each(f,function(t,e){o[e]=function(e,i,r){var s=this._listeners||(this._listeners={});var n=e._listenerId||(e._listenerId=h.uniqueId("l"));s[n]=e;if(typeof i==="object")r=this;e[t](i,r,this);return this}});o.bind=o.on;o.unbind=o.off;h.extend(a,o);var d=a.Model=function(t,e){var i;var r=t||{};e||(e={});this.cid=h.uniqueId("c");this.attributes={};h.extend(this,h.pick(e,p));if(e.parse)r=this.parse(r,e)||{};if(i=h.result(this,"defaults")){r=h.defaults({},r,i)}this.set(r,e);this.changed={};this.initialize.apply(this,arguments)};var p=["url","urlRoot","collection"];h.extend(d.prototype,o,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return h.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return h.escape(this.get(t))},has:function(t){return this.get(t)!=null},set:function(t,e,i){var r,s,n,a,o,u,l,c;if(t==null)return this;if(typeof t==="object"){s=t;i=e}else{(s={})[t]=e}i||(i={});if(!this._validate(s,i))return false;n=i.unset;o=i.silent;a=[];u=this._changing;this._changing=true;if(!u){this._previousAttributes=h.clone(this.attributes);this.changed={}}c=this.attributes,l=this._previousAttributes;if(this.idAttribute in s)this.id=s[this.idAttribute];for(r in s){e=s[r];if(!h.isEqual(c[r],e))a.push(r);if(!h.isEqual(l[r],e)){this.changed[r]=e}else{delete this.changed[r]}n?delete c[r]:c[r]=e}if(!o){if(a.length)this._pending=true;for(var f=0,d=a.length;f<d;f++){this.trigger("change:"+a[f],this,c[a[f]],i)}}if(u)return this;if(!o){while(this._pending){this._pending=false;this.trigger("change",this,i)}}this._pending=false;this._changing=false;return this},unset:function(t,e){return this.set(t,void 0,h.extend({},e,{unset:true}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,h.extend({},t,{unset:true}))},hasChanged:function(t){if(t==null)return!h.isEmpty(this.changed);return h.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?h.clone(this.changed):false;var e,i=false;var r=this._changing?this._previousAttributes:this.attributes;for(var s in t){if(h.isEqual(r[s],e=t[s]))continue;(i||(i={}))[s]=e}return i},previous:function(t){if(t==null||!this._previousAttributes)return null;return this._previousAttributes[t]},previousAttributes:function(){return h.clone(this._previousAttributes)},fetch:function(t){t=t?h.clone(t):{};if(t.parse===void 0)t.parse=true;var e=this;var i=t.success;t.success=function(r){if(!e.set(e.parse(r,t),t))return false;if(i)i(e,r,t);e.trigger("sync",e,r,t)};R(this,t);return this.sync("read",this,t)},save:function(t,e,i){var r,s,n,a=this.attributes;if(t==null||typeof t==="object"){r=t;i=e}else{(r={})[t]=e}if(r&&(!i||!i.wait)&&!this.set(r,i))return false;i=h.extend({validate:true},i);if(!this._validate(r,i))return false;if(r&&i.wait){this.attributes=h.extend({},a,r)}if(i.parse===void 0)i.parse=true;var o=this;var u=i.success;i.success=function(t){o.attributes=a;var e=o.parse(t,i);if(i.wait)e=h.extend(r||{},e);if(h.isObject(e)&&!o.set(e,i)){return false}if(u)u(o,t,i);o.trigger("sync",o,t,i)};R(this,i);s=this.isNew()?"create":i.patch?"patch":"update";if(s==="patch")i.attrs=r;n=this.sync(s,this,i);if(r&&i.wait)this.attributes=a;return n},destroy:function(t){t=t?h.clone(t):{};var e=this;var i=t.success;var r=function(){e.trigger("destroy",e,e.collection,t)};t.success=function(s){if(t.wait||e.isNew())r();if(i)i(e,s,t);if(!e.isNew())e.trigger("sync",e,s,t)};if(this.isNew()){t.success();return false}R(this,t);var s=this.sync("delete",this,t);if(!t.wait)r();return s},url:function(){var t=h.result(this,"urlRoot")||h.result(this.collection,"url")||U();if(this.isNew())return t;return t+(t.charAt(t.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(t){return this._validate({},h.extend(t||{},{validate:true}))},_validate:function(t,e){if(!e.validate||!this.validate)return true;t=h.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;if(!i)return true;this.trigger("invalid",this,i,h.extend(e||{},{validationError:i}));return false}});var v=["keys","values","pairs","invert","pick","omit"];h.each(v,function(t){d.prototype[t]=function(){var e=s.call(arguments);e.unshift(this.attributes);return h[t].apply(h,e)}});var g=a.Collection=function(t,e){e||(e={});if(e.url)this.url=e.url;if(e.model)this.model=e.model;if(e.comparator!==void 0)this.comparator=e.comparator;this._reset();this.initialize.apply(this,arguments);if(t)this.reset(t,h.extend({silent:true},e))};var m={add:true,remove:true,merge:true};var y={add:true,merge:false,remove:false};h.extend(g.prototype,o,{model:d,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return a.sync.apply(this,arguments)},add:function(t,e){return this.set(t,h.defaults(e||{},y))},remove:function(t,e){t=h.isArray(t)?t.slice():[t];e||(e={});var i,r,s,n;for(i=0,r=t.length;i<r;i++){n=this.get(t[i]);if(!n)continue;delete this._byId[n.id];delete this._byId[n.cid];s=this.indexOf(n);this.models.splice(s,1);this.length--;if(!e.silent){e.index=s;n.trigger("remove",n,this,e)}this._removeReference(n)}return this},set:function(t,e){e=h.defaults(e||{},m);if(e.parse)t=this.parse(t,e);if(!h.isArray(t))t=t?[t]:[];var i,s,a,o,u,l;var c=e.at;var f=this.comparator&&c==null&&e.sort!==false;var d=h.isString(this.comparator)?this.comparator:null;var p=[],v=[],g={};for(i=0,s=t.length;i<s;i++){if(!(a=this._prepareModel(t[i],e)))continue;if(u=this.get(a)){if(e.remove)g[u.cid]=true;if(e.merge){u.set(a.attributes,e);if(f&&!l&&u.hasChanged(d))l=true}}else if(e.add){p.push(a);a.on("all",this._onModelEvent,this);this._byId[a.cid]=a;if(a.id!=null)this._byId[a.id]=a}}if(e.remove){for(i=0,s=this.length;i<s;++i){if(!g[(a=this.models[i]).cid])v.push(a)}if(v.length)this.remove(v,e)}if(p.length){if(f)l=true;this.length+=p.length;if(c!=null){n.apply(this.models,[c,0].concat(p))}else{r.apply(this.models,p)}}if(l)this.sort({silent:true});if(e.silent)return this;for(i=0,s=p.length;i<s;i++){(a=p[i]).trigger("add",a,this,e)}if(l)this.trigger("sort",this,e);return this},reset:function(t,e){e||(e={});for(var i=0,r=this.models.length;i<r;i++){this._removeReference(this.models[i])}e.previousModels=this.models;this._reset();this.add(t,h.extend({silent:true},e));if(!e.silent)this.trigger("reset",this,e);return this},push:function(t,e){t=this._prepareModel(t,e);this.add(t,h.extend({at:this.length},e));return t},pop:function(t){var e=this.at(this.length-1);this.remove(e,t);return e},unshift:function(t,e){t=this._prepareModel(t,e);this.add(t,h.extend({at:0},e));return t},shift:function(t){var e=this.at(0);this.remove(e,t);return e},slice:function(t,e){return this.models.slice(t,e)},get:function(t){if(t==null)return void 0;return this._byId[t.id!=null?t.id:t.cid||t]},at:function(t){return this.models[t]},where:function(t,e){if(h.isEmpty(t))return e?void 0:[];return this[e?"find":"filter"](function(e){for(var i in t){if(t[i]!==e.get(i))return false}return true})},findWhere:function(t){return this.where(t,true)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");t||(t={});if(h.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(h.bind(this.comparator,this))}if(!t.silent)this.trigger("sort",this,t);return this},sortedIndex:function(t,e,i){e||(e=this.comparator);var r=h.isFunction(e)?e:function(t){return t.get(e)};return h.sortedIndex(this.models,t,r,i)},pluck:function(t){return h.invoke(this.models,"get",t)},fetch:function(t){t=t?h.clone(t):{};if(t.parse===void 0)t.parse=true;var e=t.success;var i=this;t.success=function(r){var s=t.reset?"reset":"set";i[s](r,t);if(e)e(i,r,t);i.trigger("sync",i,r,t)};R(this,t);return this.sync("read",this,t)},create:function(t,e){e=e?h.clone(e):{};if(!(t=this._prepareModel(t,e)))return false;if(!e.wait)this.add(t,e);var i=this;var r=e.success;e.success=function(s){if(e.wait)i.add(t,e);if(r)r(t,s,e)};t.save(null,e);return t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(t,e){if(t instanceof d){if(!t.collection)t.collection=this;return t}e||(e={});e.collection=this;var i=new this.model(t,e);if(!i._validate(t,e)){this.trigger("invalid",this,t,e);return false}return i},_removeReference:function(t){if(this===t.collection)delete t.collection;t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,r){if((t==="add"||t==="remove")&&i!==this)return;if(t==="destroy")this.remove(e,r);if(e&&t==="change:"+e.idAttribute){delete this._byId[e.previous(e.idAttribute)];if(e.id!=null)this._byId[e.id]=e}this.trigger.apply(this,arguments)}});var _=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];h.each(_,function(t){g.prototype[t]=function(){var e=s.call(arguments);e.unshift(this.models);return h[t].apply(h,e)}});var w=["groupBy","countBy","sortBy"];h.each(w,function(t){g.prototype[t]=function(e,i){var r=h.isFunction(e)?e:function(t){return t.get(e)};return h[t](this.models,r,i)}});var b=a.View=function(t){this.cid=h.uniqueId("view");this._configure(t||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var x=/^(\S+)\s*(.*)$/;var E=["model","collection","el","id","attributes","className","tagName","events"];h.extend(b.prototype,o,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(t,e){if(this.$el)this.undelegateEvents();this.$el=t instanceof a.$?t:a.$(t);this.el=this.$el[0];if(e!==false)this.delegateEvents();return this},delegateEvents:function(t){if(!(t||(t=h.result(this,"events"))))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(!h.isFunction(i))i=this[t[e]];if(!i)continue;var r=e.match(x);var s=r[1],n=r[2];i=h.bind(i,this);s+=".delegateEvents"+this.cid;if(n===""){this.$el.on(s,i)}else{this.$el.on(s,n,i)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(t){if(this.options)t=h.extend({},h.result(this,"options"),t);h.extend(this,h.pick(t,E));this.options=t},_ensureElement:function(){if(!this.el){var t=h.extend({},h.result(this,"attributes"));if(this.id)t.id=h.result(this,"id");if(this.className)t["class"]=h.result(this,"className");var e=a.$("<"+h.result(this,"tagName")+">").attr(t);this.setElement(e,false)}else{this.setElement(h.result(this,"el"),false)}}});a.sync=function(t,e,i){var r=k[t];h.defaults(i||(i={}),{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var s={type:r,dataType:"json"};if(!i.url){s.url=h.result(e,"url")||U()}if(i.data==null&&e&&(t==="create"||t==="update"||t==="patch")){s.contentType="application/json";s.data=JSON.stringify(i.attrs||e.toJSON(i))}if(i.emulateJSON){s.contentType="application/x-www-form-urlencoded";s.data=s.data?{model:s.data}:{}}if(i.emulateHTTP&&(r==="PUT"||r==="DELETE"||r==="PATCH")){s.type="POST";if(i.emulateJSON)s.data._method=r;var n=i.beforeSend;i.beforeSend=function(t){t.setRequestHeader("X-HTTP-Method-Override",r);if(n)return n.apply(this,arguments)}}if(s.type!=="GET"&&!i.emulateJSON){s.processData=false}if(s.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var o=i.xhr=a.ajax(h.extend(s,i));e.trigger("request",e,o,i);return o};var k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};a.ajax=function(){return a.$.ajax.apply(a.$,arguments)};var S=a.Router=function(t){t||(t={});if(t.routes)this.routes=t.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var $=/\((.*?)\)/g;var T=/(\(\?)?:\w+/g;var H=/\*\w+/g;var A=/[\-{}\[\]+?.,\\\^$|#\s]/g;h.extend(S.prototype,o,{initialize:function(){},route:function(t,e,i){if(!h.isRegExp(t))t=this._routeToRegExp(t);if(h.isFunction(e)){i=e;e=""}if(!i)i=this[e];var r=this;a.history.route(t,function(s){var n=r._extractParameters(t,s);i&&i.apply(r,n);r.trigger.apply(r,["route:"+e].concat(n));r.trigger("route",e,n);a.history.trigger("route",r,e,n)});return this},navigate:function(t,e){a.history.navigate(t,e);return this},_bindRoutes:function(){if(!this.routes)return;this.routes=h.result(this,"routes");var t,e=h.keys(this.routes);while((t=e.pop())!=null){this.route(t,this.routes[t])}},_routeToRegExp:function(t){t=t.replace(A,"\\$&").replace($,"(?:$1)?").replace(T,function(t,e){return e?t:"([^/]+)"}).replace(H,"(.*?)");return new RegExp("^"+t+"$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return h.map(i,function(t){return t?decodeURIComponent(t):null})}});var I=a.History=function(){this.handlers=[];h.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var N=/^[#\/]|\s+$/g;var P=/^\/+|\/+$/g;var O=/msie [\w.]+/;var C=/\/$/;I.started=false;h.extend(I.prototype,o,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(t==null){if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(C,"");if(!t.indexOf(i))t=t.substr(i.length)}else{t=this.getHash()}}return t.replace(N,"")},start:function(t){if(I.started)throw new Error("Backbone.history has already been started");I.started=true;this.options=h.extend({},{root:"/"},this.options,t);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var e=this.getFragment();var i=document.documentMode;var r=O.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(P,"/");if(r&&this._wantsHashChange){this.iframe=a.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(e)}if(this._hasPushState){a.$(window).on("popstate",this.checkUrl)}else if(this._wantsHashChange&&"onhashchange"in window&&!r){a.$(window).on("hashchange",this.checkUrl)}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}this.fragment=e;var s=this.location;var n=s.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!n){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else if(this._wantsPushState&&this._hasPushState&&n&&s.hash){this.fragment=this.getHash().replace(N,"");this.history.replaceState({},document.title,this.root+this.fragment+s.search)}if(!this.options.silent)return this.loadUrl()},stop:function(){a.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);I.started=false},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe){e=this.getFragment(this.getHash(this.iframe))}if(e===this.fragment)return false;if(this.iframe)this.navigate(e);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(t){var e=this.fragment=this.getFragment(t);var i=h.any(this.handlers,function(t){if(t.route.test(e)){t.callback(e);return true}});return i},navigate:function(t,e){if(!I.started)return false;if(!e||e===true)e={trigger:e};t=this.getFragment(t||"");if(this.fragment===t)return;this.fragment=t;var i=this.root+t;if(this._hasPushState){this.history[e.replace?"replaceState":"pushState"]({},document.title,i)}else if(this._wantsHashChange){this._updateHash(this.location,t,e.replace);if(this.iframe&&t!==this.getFragment(this.getHash(this.iframe))){if(!e.replace)this.iframe.document.open().close();this._updateHash(this.iframe.location,t,e.replace)}}else{return this.location.assign(i)}if(e.trigger)this.loadUrl(t)},_updateHash:function(t,e,i){if(i){var r=t.href.replace(/(javascript:|#).*$/,"");t.replace(r+"#"+e)}else{t.hash="#"+e}}});a.history=new I;var j=function(t,e){var i=this;var r;if(t&&h.has(t,"constructor")){r=t.constructor}else{r=function(){return i.apply(this,arguments)}}h.extend(r,i,e);var s=function(){this.constructor=r};s.prototype=i.prototype;r.prototype=new s;if(t)h.extend(r.prototype,t);r.__super__=i.prototype;return r};d.extend=g.extend=S.extend=b.extend=I.extend=j;var U=function(){throw new Error('A "url" property or function must be specified')};var R=function(t,e){var i=e.error;e.error=function(r){if(i)i(t,r,e);t.trigger("error",t,r,e)}}}).call(this);var ClBackbone=$CL.namespace("Cl.Backbone");$CL.require("Cl.Backbone.Backbone");$CL.require("Cl.Application.View.RendererInterface");$CL.require("Cl.Event.Manager");$CL.require("Cl.Event.Event");ClBackbone.View=function(){};ClBackbone.View=$CL.extendClass(ClBackbone.View,Backbone.View,{tpl:"",data:{},__IMPLEMENTS__:[Cl.Application.View.RendererInterface],setup:function(){this.on("all",$CL.bind(this.triggerClEvent,this));},triggerClEvent:function(){var eventName=arguments[0];var newArgs=[];for(var i in arguments){if(i!=0)
newArgs[newArgs.length]=arguments[i];}
var event=$CL.get("Cl.Event.Event",{params:{arguments:newArgs},name:eventName});this.clEvents().trigger(event);},clEvents:function(){if(!$CL.has(this,"__eventManager")){this["__eventManager"]=$CL.get("event_manager",{target:$CL.className(this)});}
return this["__eventManager"];},setModel:function(model){this.model=model;return this;},setData:function(data){this.data=data;return this;},setTemplate:function(template){this.tpl=template;return this;},render:function(){this.$el.html(this.tpl(this.data));},stopPropagation:function(e){e.stopPropagation();}});var ClBackbone=$CL.namespace('Cl.Backbone');$CL.require('Cl.Backbone.View');ClBackbone.FormView=function(){};ClBackbone.FormView=$CL.extendClass(ClBackbone.FormView,ClBackbone.View,{form:null,submitCallback:function(){},events:{'click input[type=submit]':'onSubmit','submit form':'onSubmit',},setForm:function(form){this.form=form;},getForm:function(){return this.form;},setSubmitCallback:function(submitCallback){this.submitCallback=submitCallback;},render:function(){this.data['form']=this.getForm();Cl.Backbone.View.prototype.render.call(this);this.form.refresh();},onSubmit:function(e){e.preventDefault();if(this.form.isValid()){this.submitCallback(this.form.getData());}else{this.render();}}});var Form=$CL.namespace('Ginger.Users.View.Form');$CL.require('Cl.Backbone.FormView');$CL.require('Cl.Form.View.InputText');$CL.require('Cl.Form.View.Password');Form.User=function(){};Form.User=$CL.extendClass(Form.User,Cl.Backbone.FormView);var Validator=$CL.namespace('Cl.Form.Validator');Validator.EmailAddress=function(){};Validator.EmailAddress.prototype={error:null,isValid:function(val){var regEx=new RegExp("^[^@]+@[^\\.]+\\.[^\\.]{2,}$");if(regEx.test(val)){return true;}else{this.error={name:"EmailAddressError",msg:$CL.translate("Value has no valid email format!")};return false;}},getError:function(){return this.error;}}
var Validator=$CL.namespace('Cl.Form.Validator');Validator.NotEmpty=function(){};Validator.NotEmpty.prototype={error:null,isValid:function(val){if($CL.isEmpty(val)===false){return true;}else{this.error={name:"NotEmptyError",msg:$CL.translate("Value is empty!")};return false;}},getError:function(){return this.error;}}
String.prototype.reverse=function(){return this.split("").reverse().join("");};String.prototype.trim=function(trimChars){if(typeof trimChars!="string")
trimChars=" ";else{trimChars=trimChars.replace("\\","\\\\");trimChars=trimChars.replace(".","\\.");}
var regPatFront=new RegExp("^("+trimChars+"){1,}");var regPatEnd=new RegExp("("+trimChars+"){1,}$")
return this.replace(regPatFront,"").replace(regPatEnd,"");};String.prototype.toArray=function(trenner){var str=this;var arr=new Array();var pos=0;var i=0;if(typeof(trenner)=="undefined")
{trenner=",";}
str=this.trim(trenner);while(str.indexOf(trenner)>-1)
{pos=str.indexOf(trenner);arr[i]=str.substring(0,pos);str=str.substring(pos+trenner.length);i++;}
arr[i]=str;return arr;};String.prototype.ucfirst=function(){var f=this.charAt(0).toUpperCase();return f+this.substr(1);};String.prototype.toElementID=function(){return this.replace(/[^a-zA-Z0-9-_]/g,"_");};String.prototype.nl2br=function(is_xhtml){var breakTag=(is_xhtml||!$CL.isDefined(is_xhtml))?'<br />':'<br>';return this.replace(/([^>\r\n]*)(\r\n|\n\r|\r|\n)/g,'$1'+breakTag+'$2');}
var Filter=$CL.namespace('Cl.Form.Filter');$CL.require("Cl.Core.String");Filter.StringTrim=function(){};Filter.StringTrim.prototype={filter:function(val){if(!$CL.isDefined(val)||_.isNull(val)){return"";}
return val.trim();}};var Element=$CL.namespace('Cl.Form.Element');Element.AbstractElement=function(){};Element.AbstractElement.prototype={name:null,label:null,filters:null,validators:null,$el:null,errorClass:"failed",passedClass:"passed",required:true,errors:[],elSelector:"",_valueProvider:function(val){if(!$CL.isDefined(val)){return this.$el.val();}else{this.$el.val(val);}},setErrors:function(errors){this.errors=errors;this.setErrorClass();},getErrors:function(){return this.errors;},setErrorClass:function(){this.$el.addClass(this.errorClass);this.$el.removeClass(this.passedClass);},setPassed:function(){this.$el.removeClass(this.errorClass);this.$el.addClass(this.passedClass);this.errors=[];},setup:function(options){if($CL.isDefined(options.name)){this.name=options.name;}
if($CL.isDefined(options.label)){this.label=options.label;}
if($CL.isDefined(options.filters)){this.filters=options.filters;}else{this.filters=[];}
if($CL.isDefined(options.validators)){this.validators=options.validators;}else{this.validators=[];}
if($CL.isDefined(options.selector)){this.elSelector=options.selector;}
if($CL.isDefined(options.required)){this.required=options.required;}
this.selectElement();},selectElement:function(){this.$el=$(this.elSelector);},setElement:function($el){this.$el=$el;},setName:function(name){this.name=name;},setLabel:function(label){this.label=label;},addFilter:function(filter){this.filters.push(filter);},addValidator:function(validator){this.validators.push(validator);},getName:function(){return this.name;},getLabel:function(){return this.label;},getValue:function(){var val=this._valueProvider();_.each(this.filters,function(filter){val=filter.filter(val);});return val;},setValue:function(val){this._valueProvider(val);},isValid:function(){var valid=true;var val=this.getValue();this.errors=[];if(!this.required&&$CL.isEmpty(val)){this.setPassed();return true;}
_.each(this.validators,function(validator){if(!validator.isValid(val)){var error=validator.getError();this.errors.push(error);valid=false;}},this);if(!valid){this.setErrorClass();}else{this.setPassed();}
return valid;},refresh:function(){this.selectElement();}};var Element=$CL.namespace('Cl.Form.Element');$CL.require("Cl.Form.Element.AbstractElement");$CL.require("Cl.Form.Filter.StringTrim");$CL.require("Cl.Form.Validator.NotEmpty");Element.Text=function(){};Element.Text=$CL.extendClass(Element.Text,Element.AbstractElement,{init:function(){this.addFilter($CL.get('Cl.Form.Filter.StringTrim'));this.addValidator($CL.get('Cl.Form.Validator.NotEmpty'));},selectElement:function(){this.$el=$('input[name='+this.getName()+']');this.$el.unbind('blur.form-element');this.$el.bind('blur.form-element',$CL.bind(function(e){this.isValid();},this));}});var Element=$CL.namespace('Cl.Form.Element');$CL.require("Cl.Form.Element.Text");$CL.require("Cl.Form.Validator.EmailAddress");Element.Email=function(){};Element.Email=$CL.extendClass(Element.Email,Element.Text,{init:function(){this.parent.init.apply(this);this.addValidator($CL.get('Cl.Form.Validator.EmailAddress'));}});var Event=$CL.namespace("Cl.Form.Event");$CL.require("Cl.Event.Event");Event.FormData=function(){};$CL.extendClass(Event.FormData,Cl.Event.Event,{setup:function(options){this.parent.setup.call(this,_.extend(options,{name:"getData"}));},setFormData:function(formData){this.setParam('formData',formData);},getFormData:function(){return this.getParam('formData',{});}});var Form=$CL.namespace("Cl.Form");$CL.require('Cl.Event.Manager');$CL.require('Cl.Form.Event.FormData');Form.Form=function(){};Form.Form.prototype={name:null,elements:[],elementErrors:{},events:function(){if(!$CL.has(this,"__eventManager")){this["__eventManager"]=$CL.get("event_manager",{target:$CL.className(this)+'.'+this.name});}
return this["__eventManager"];},setup:function(options){if($CL.isDefined(options.name)){this.name=options.name;}
if($CL.isDefined(options.elements)){this.elements=options.elements;}},addElement:function(element){this.elements.push(element);},getElement:function(name){return _.find(this.elements,function(el){return el.getName()==name;});},setData:function(data){$.each(data,$CL.bind(function(key,value){var el=this.getElement(key);el.setValue(value);},this));},getData:function(){var data={};_.each(this.elements,function(element){data[element.getName()]=element.getValue();});var formDataEvent=$CL.makeObj('Cl.Form.Event.FormData');formDataEvent.setFormData(data);this.events().trigger(formDataEvent);data=formDataEvent.getFormData();return data;},isValid:function(){var valid=true;this.elementErrors={};_.each(this.elements,function(element){if(!element.isValid()){valid=false;var elErrors={};this.elementErrors[element.getName()]=element.getErrors();}},this);return valid;},setErrors:function(elementErrors){this.elementErrors=elementErrors;$.each(elementErrors,$CL.bind(function(elementName,errors){var el=this.getElement(elementName);el.setErrors(errors);},this));},getErrors:function(){return this.elementErrors;},refresh:function(){_.each(this.elements,function(element){element.refresh();});}}
var Form=$CL.namespace('Ginger.Users.Form');$CL.require('Cl.Form.Form');$CL.require('Cl.Form.Element.Text');$CL.require('Cl.Form.Element.Email');Form.User=function(){};Form.User=$CL.extendClass(Form.User,Cl.Form.Form,{name:"user",init:function(){this.elements=[$CL.makeObj('Cl.Form.Element.Text',{'name':'username','label':$CL.translate('USERS::FORM::LABEL::USERNAME')}),$CL.makeObj('Cl.Form.Element.Text',{'name':'lastname','label':$CL.translate('USERS::FORM::LABEL::LASTNAME')}),$CL.makeObj('Cl.Form.Element.Text',{'name':'firstname','label':$CL.translate('USERS::FORM::LABEL::FIRSTNAME')}),$CL.makeObj('Cl.Form.Element.Email',{'name':'email','label':$CL.translate('USERS::FORM::LABEL::EMAIL')}),$CL.makeObj('Cl.Form.Element.Text',{'name':'password','label':$CL.translate('USERS::FORM::LABEL::PASSWORD')})]}});var Event=$CL.namespace("Cl.Event");$CL.require('Cl.Event.Manager');Event.EventManagerProvider={events:function(){if(!$CL.has(this,"__eventManager")){this["__eventManager"]=$CL.get("event_manager",{target:$CL.className(this)});}
return this["__eventManager"];}};var Mvc=$CL.namespace("Cl.Application.Mvc");$CL.require("Cl.Event.Event");Mvc.ControllerEvent=function ControllerEvent(){};Mvc.ControllerEvent=$CL.extendClass(Mvc.ControllerEvent,Cl.Event.Event,{setup:function(options){var params={mvcEvent:options.mvcEvent};if($CL.isDefined(options.params)){params=_.extend(options.params,params);}
options.params=params;this.parent.setup.call(this,options);},getMvcEvent:function(){return this.params.mvcEvent;},setResponse:function(response){this.setParam("response",response);return this;},getResponse:function(){return this.getParam("response");}});var Mvc=$CL.namespace("Cl.Application.Mvc");Mvc.ControllerInterface=function ControllerInterface(){};Mvc.ControllerInterface.prototype={dispatch:function(mvcEvent){$CL.implementThis();}};var Mvc=$CL.namespace("Cl.Application.Mvc");$CL.require("Cl.Application.Mvc.ControllerInterface");$CL.require("Cl.Application.Mvc.ControllerEvent");$CL.require("Cl.Event.EventManagerProvider");Mvc.AbstractController=function AbstractController(){this.__IMPLEMENTS__=[Mvc.ControllerInterface];};Mvc.AbstractController.prototype={mvcEvent:null,controllerEvent:null,getMvcEvent:function(){return this.mvcEvent;},getControllerEvent:function(){if(_.isNull(this.controllerEvent)){this.controllerEvent=$CL.makeObj('Cl.Application.Mvc.ControllerEvent',{target:$CL.className(this),name:'dispatch.pre',mvcEvent:this.getMvcEvent()});}
return this.controllerEvent;},dispatch:function(mvcEvent){var response;this.mvcEvent=mvcEvent;this.events().trigger(this.getControllerEvent());if(this.getControllerEvent().isPropagationStopped()){response=this.getControllerEvent().getResponse();this.controllerEvent=null;return response;}
var action=mvcEvent.getRouteMatch().getAction()+"Action";if($CL.has(this,action)&&typeof this[action]=="function"){response=this[action]();this.getControllerEvent().setResponse(response);this.getControllerEvent().name='dispatch.post';this.events().trigger(this.getControllerEvent());response=this.getControllerEvent().getResponse();this.controllerEvent=null;return response;}else{$CL.exception("action not found",$CL.className(this),action);}}}
_.extend(Mvc.AbstractController.prototype,Cl.Event.EventManagerProvider);var Controller=$CL.namespace("Ginger.Users.Controller");$CL.require("Cl.Application.Mvc.AbstractController");Controller.Index=function(){};Controller.Index=$CL.extendClass(Controller.Index,Cl.Application.Mvc.AbstractController,{indexAction:function(){var v=$CL.get("Ginger.Users.View.Form.User");v.setSubmitCallback(function(formData){alert(formData);});v.setData({headline:$CL.translate('USERS::HEADLINE::ADD_USER')});return v;}});var Module=$CL.namespace("Cl.Application.Module");Module.ModuleInterface=function ModuleInterface(){};Module.ModuleInterface.prototype={};var Users=$CL.namespace('Ginger.Users');$CL.require("Cl.Application.Module.ModuleInterface");$CL.require("Ginger.Users.Controller.Index");$CL.require("Ginger.Users.Form.User");$CL.require("Ginger.Users.View.Form.User");Users.Module=function(){this.__IMPLEMENTS__=[Cl.Application.Module.ModuleInterface];};Users.Module.prototype={getConfig:function(){return{router:{routes:{'users_overview':{route:'users/overview/',callback:function(){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Users.Module",controller:"index",action:"index"});},build:function(routeParams){return this.route;}}}},service_manager:{factories:{'Ginger.Users.View.Form.User':function(sl){var v=$CL.makeObj('Ginger.Users.View.Form.User');v.setForm($CL.makeObj('Ginger.Users.Form.User'));v.setTemplate($CL._template('users_form_user'));return v;}}}};},getController:function(controllerName){controllerName=controllerName.ucfirst();if($CL.classExists("Ginger.Users.Controller."+controllerName)){return $CL.get("Ginger.Users.Controller."+controllerName);}else{$CL.exception("unknown controllername","Ginger.Users.Module",controllerName);}}}
var ClBackbone=$CL.namespace("Cl.Backbone");$CL.require("Cl.Backbone.Backbone");$CL.require("Cl.Event.Manager");$CL.require("Cl.Event.Event");$CL.require("Cl.Event.EventManagerProvider");(function(undefined){"use strict";var _,Backbone,exports;if(typeof window==='undefined'){_=require('underscore');Backbone=require('backbone');exports=module.exports=Backbone;}
else{_=window._;Backbone=window.Backbone;exports=window;}
Backbone.Relational={showWarnings:true};Backbone.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable){throw new Error('Max permits acquired');}
else{this._permitsUsed++;}},release:function(){if(this._permitsUsed===0){throw new Error('All permits released');}
else{this._permitsUsed--;}},isLocked:function(){return this._permitsUsed>0;},setAvailablePermits:function(amount){if(this._permitsUsed>amount){throw new Error('Available permits cannot be less than used permits');}
this._permitsAvailable=amount;}};Backbone.BlockingQueue=function(){this._queue=[];};_.extend(Backbone.BlockingQueue.prototype,Backbone.Semaphore,{_queue:null,add:function(func){if(this.isBlocked()){this._queue.push(func);}
else{func();}},process:function(){while(this._queue&&this._queue.length){this._queue.shift()();}},block:function(){this.acquire();},unblock:function(){this.release();if(!this.isBlocked()){this.process();}},isBlocked:function(){return this.isLocked();}});Backbone.Relational.eventQueue=new Backbone.BlockingQueue();Backbone.Store=function(){this._collections=[];this._reverseRelations=[];this._orphanRelations=[];this._subModels=[];this._modelScopes=[exports];};_.extend(Backbone.Store.prototype,Backbone.Events,{initializeRelation:function(model,relation,options){var type=!_.isString(relation.type)?relation.type:Backbone[relation.type]||this.getObjectByName(relation.type);if(type&&type.prototype instanceof Backbone.Relation){new type(model,relation,options);}
else{Backbone.Relational.showWarnings&&typeof console!=='undefined'&&console.warn('Relation=%o; missing or invalid relation type!',relation);}},addModelScope:function(scope){this._modelScopes.push(scope);},removeModelScope:function(scope){this._modelScopes=_.without(this._modelScopes,scope);},addSubModels:function(subModelTypes,superModelType){this._subModels.push({'superModelType':superModelType,'subModels':subModelTypes});},setupSuperModel:function(modelType){_.find(this._subModels,function(subModelDef){return _.find(subModelDef.subModels||[],function(subModelTypeName,typeValue){var subModelType=this.getObjectByName(subModelTypeName);if(modelType===subModelType){subModelDef.superModelType._subModels[typeValue]=modelType;modelType._superModel=subModelDef.superModelType;modelType._subModelTypeValue=typeValue;modelType._subModelTypeAttribute=subModelDef.superModelType.prototype.subModelTypeAttribute;return true;}},this);},this);},addReverseRelation:function(relation){var exists=_.any(this._reverseRelations,function(rel){return _.all(relation||[],function(val,key){return val===rel[key];});});if(!exists&&relation.model&&relation.type){this._reverseRelations.push(relation);this._addRelation(relation.model,relation);this.retroFitRelation(relation);}},addOrphanRelation:function(relation){var exists=_.any(this._orphanRelations,function(rel){return _.all(relation||[],function(val,key){return val===rel[key];});});if(!exists&&relation.model&&relation.type){this._orphanRelations.push(relation);}},processOrphanRelations:function(){_.each(this._orphanRelations.slice(0),function(rel){var relatedModel=Backbone.Relational.store.getObjectByName(rel.relatedModel);if(relatedModel){this.initializeRelation(null,rel);this._orphanRelations=_.without(this._orphanRelations,rel);}},this);},_addRelation:function(type,relation){if(!type.prototype.relations){type.prototype.relations=[];}
type.prototype.relations.push(relation);_.each(type._subModels||[],function(subModel){this._addRelation(subModel,relation);},this);},retroFitRelation:function(relation){var coll=this.getCollection(relation.model,false);coll&&coll.each(function(model){if(!(model instanceof relation.model)){return;}
new relation.type(model,relation);},this);},getCollection:function(type,create){if(type instanceof Backbone.RelationalModel){type=type.constructor;}
var rootModel=type;while(rootModel._superModel){rootModel=rootModel._superModel;}
var coll=_.findWhere(this._collections,{model:rootModel});if(!coll&&create!==false){coll=this._createCollection(rootModel);}
return coll;},getObjectByName:function(name){var parts=name.split('.'),type=null;_.find(this._modelScopes,function(scope){type=_.reduce(parts||[],function(memo,val){return memo?memo[val]:undefined;},scope);if(type&&type!==scope){return true;}},this);return type;},_createCollection:function(type){var coll;if(type instanceof Backbone.RelationalModel){type=type.constructor;}
if(type.prototype instanceof Backbone.RelationalModel){coll=new Backbone.Collection();coll.model=type;this._collections.push(coll);}
return coll;},resolveIdForItem:function(type,item){var id=_.isString(item)||_.isNumber(item)?item:null;if(id===null){if(item instanceof Backbone.RelationalModel){id=item.id;}
else if(_.isObject(item)){id=item[type.prototype.idAttribute];}}
if(!id&&id!==0){id=null;}
return id;},find:function(type,item){var id=this.resolveIdForItem(type,item);var coll=this.getCollection(type);if(coll){var obj=coll.get(id);if(obj instanceof type){return obj;}}
return null;},register:function(model){var coll=this.getCollection(model);if(coll){var modelColl=model.collection;coll.add(model);this.listenTo(model,'destroy',this.unregister,this);model.collection=modelColl;}},checkId:function(model,id){var coll=this.getCollection(model),duplicate=coll&&coll.get(id);if(duplicate&&model!==duplicate){if(Backbone.Relational.showWarnings&&typeof console!=='undefined'){console.warn('Duplicate id! Old RelationalModel=%o, new RelationalModel=%o',duplicate,model);}
throw new Error("Cannot instantiate more than one Backbone.RelationalModel with the same id per type!");}},update:function(model){var coll=this.getCollection(model);coll._onModelEvent('change:'+model.idAttribute,model,coll);model.trigger('relational:change:id',model,coll);},unregister:function(model){this.stopListening(model,'destroy',this.unregister);var coll=this.getCollection(model);coll&&coll.remove(model);},reset:function(){this.stopListening();this._collections=[];this._subModels=[];this._modelScopes=[exports];}});Backbone.Relational.store=new Backbone.Store();Backbone.Relation=function(instance,options,opts){this.instance=instance;options=_.isObject(options)?options:{};this.reverseRelation=_.defaults(options.reverseRelation||{},this.options.reverseRelation);this.options=_.defaults(options,this.options,Backbone.Relation.prototype.options);this.reverseRelation.type=!_.isString(this.reverseRelation.type)?this.reverseRelation.type:Backbone[this.reverseRelation.type]||Backbone.Relational.store.getObjectByName(this.reverseRelation.type);this.key=this.options.key;this.keySource=this.options.keySource||this.key;this.keyDestination=this.options.keyDestination||this.keySource||this.key;this.model=this.options.model||this.instance.constructor;this.relatedModel=this.options.relatedModel;if(_.isString(this.relatedModel)){this.relatedModel=Backbone.Relational.store.getObjectByName(this.relatedModel);}
if(!this.checkPreconditions()){return;}
if(!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key){Backbone.Relational.store.addReverseRelation(_.defaults({isAutoRelation:true,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation));}
if(instance){var contentKey=this.keySource;if(contentKey!==this.key&&typeof this.instance.get(this.key)==='object'){contentKey=this.key;}
this.setKeyContents(this.instance.get(contentKey));this.relatedCollection=Backbone.Relational.store.getCollection(this.relatedModel);if(this.keySource!==this.key){this.instance.unset(this.keySource,{silent:true});}
this.instance._relations[this.key]=this;this.initialize(opts);if(this.options.autoFetch){this.instance.fetchRelated(this.key,_.isObject(this.options.autoFetch)?this.options.autoFetch:{});}
this.listenTo(this.instance,'destroy',this.destroy).listenTo(this.relatedCollection,'relational:add relational:change:id',this.tryAddRelated).listenTo(this.relatedCollection,'relational:remove',this.removeRelated)}};Backbone.Relation.extend=Backbone.Model.extend;_.extend(Backbone.Relation.prototype,Backbone.Events,Backbone.Semaphore,{options:{createModels:true,includeInJSON:true,isAutoRelation:false,autoFetch:false,parse:false},instance:null,key:null,keyContents:null,relatedModel:null,relatedCollection:null,reverseRelation:null,related:null,checkPreconditions:function(){var i=this.instance,k=this.key,m=this.model,rm=this.relatedModel,warn=Backbone.Relational.showWarnings&&typeof console!=='undefined';if(!m||!k||!rm){warn&&console.warn('Relation=%o: missing model, key or relatedModel (%o, %o, %o).',this,m,k,rm);return false;}
if(!(m.prototype instanceof Backbone.RelationalModel)){warn&&console.warn('Relation=%o: model does not inherit from Backbone.RelationalModel (%o).',this,i);return false;}
if(!(rm.prototype instanceof Backbone.RelationalModel)){warn&&console.warn('Relation=%o: relatedModel does not inherit from Backbone.RelationalModel (%o).',this,rm);return false;}
if(this instanceof Backbone.HasMany&&this.reverseRelation.type===Backbone.HasMany){warn&&console.warn('Relation=%o: relation is a HasMany, and the reverseRelation is HasMany as well.',this);return false;}
if(i&&_.keys(i._relations).length){var existing=_.find(i._relations,function(rel){return rel.key===k;},this);if(existing){warn&&console.warn('Cannot create relation=%o on %o for model=%o: already taken by relation=%o.',this,k,i,existing);return false;}}
return true;},setRelated:function(related){this.related=related;this.instance.acquire();this.instance.attributes[this.key]=related;this.instance.release();},_isReverseRelation:function(relation){return relation.instance instanceof this.relatedModel&&this.reverseRelation.key===relation.key&&this.key===relation.reverseRelation.key;},getReverseRelations:function(model){var reverseRelations=[];var models=!_.isUndefined(model)?[model]:this.related&&(this.related.models||[this.related]);_.each(models||[],function(related){_.each(related.getRelations()||[],function(relation){if(this._isReverseRelation(relation)){reverseRelations.push(relation);}},this);},this);return reverseRelations;},destroy:function(){this.stopListening();if(this instanceof Backbone.HasOne){this.setRelated(null);}
else if(this instanceof Backbone.HasMany){this.setRelated(this._prepareCollection());}
_.each(this.getReverseRelations(),function(relation){relation.removeRelated(this.instance);},this);}});Backbone.HasOne=Backbone.Relation.extend({options:{reverseRelation:{type:'HasMany'}},initialize:function(opts){this.listenTo(this.instance,'relational:change:'+this.key,this.onChange);var related=this.findRelated(opts);this.setRelated(related);_.each(this.getReverseRelations(),function(relation){relation.addRelated(this.instance,opts);},this);},findRelated:function(options){var related=null;options=_.defaults({parse:this.options.parse},options);if(this.keyContents instanceof this.relatedModel){related=this.keyContents;}
else if(this.keyContents||this.keyContents===0){var opts=_.defaults({create:this.options.createModels},options);related=this.relatedModel.findOrCreate(this.keyContents,opts);}
if(this.related){this.keyId=null;}
return related;},setKeyContents:function(keyContents){this.keyContents=keyContents;this.keyId=Backbone.Relational.store.resolveIdForItem(this.relatedModel,this.keyContents);},onChange:function(model,attr,options){if(this.isLocked()){return;}
this.acquire();options=options?_.clone(options):{};var changed=_.isUndefined(options.__related),oldRelated=changed?this.related:options.__related;if(changed){this.setKeyContents(attr);var related=this.findRelated(options);this.setRelated(related);}
if(oldRelated&&this.related!==oldRelated){_.each(this.getReverseRelations(oldRelated),function(relation){relation.removeRelated(this.instance,null,options);},this);}
_.each(this.getReverseRelations(),function(relation){relation.addRelated(this.instance,options);},this);if(!options.silent&&this.related!==oldRelated){var dit=this;this.changed=true;Backbone.Relational.eventQueue.add(function(){dit.instance.trigger('change:'+dit.key,dit.instance,dit.related,options,true);dit.changed=false;});}
this.release();},tryAddRelated:function(model,coll,options){if((this.keyId||this.keyId===0)&&model.id===this.keyId){this.addRelated(model,options);this.keyId=null;}},addRelated:function(model,options){var dit=this;model.queue(function(){if(model!==dit.related){var oldRelated=dit.related||null;dit.setRelated(model);dit.onChange(dit.instance,model,_.defaults({__related:oldRelated},options));}});},removeRelated:function(model,coll,options){if(!this.related){return;}
if(model===this.related){var oldRelated=this.related||null;this.setRelated(null);this.onChange(this.instance,model,_.defaults({__related:oldRelated},options));}}});Backbone.HasMany=Backbone.Relation.extend({collectionType:null,options:{reverseRelation:{type:'HasOne'},collectionType:Backbone.Collection,collectionKey:true,collectionOptions:{}},initialize:function(opts){this.listenTo(this.instance,'relational:change:'+this.key,this.onChange);this.collectionType=this.options.collectionType;if(_.isString(this.collectionType)){this.collectionType=Backbone.Relational.store.getObjectByName(this.collectionType);}
if(this.collectionType!==Backbone.Collection&&!(this.collectionType.prototype instanceof Backbone.Collection)){throw new Error('`collectionType` must inherit from Backbone.Collection');}
var related=this.findRelated(opts);this.setRelated(related);},_prepareCollection:function(collection){if(this.related){this.stopListening(this.related);}
if(!collection||!(collection instanceof Backbone.Collection)){var options=_.isFunction(this.options.collectionOptions)?this.options.collectionOptions(this.instance):this.options.collectionOptions;collection=new this.collectionType(null,options);}
collection.model=this.relatedModel;if(this.options.collectionKey){var key=this.options.collectionKey===true?this.options.reverseRelation.key:this.options.collectionKey;if(collection[key]&&collection[key]!==this.instance){if(Backbone.Relational.showWarnings&&typeof console!=='undefined'){console.warn('Relation=%o; collectionKey=%s already exists on collection=%o',this,key,this.options.collectionKey);}}
else if(key){collection[key]=this.instance;}}
this.listenTo(collection,'relational:add',this.handleAddition).listenTo(collection,'relational:remove',this.handleRemoval).listenTo(collection,'relational:reset',this.handleReset);return collection;},findRelated:function(options){var related=null;options=_.defaults({parse:this.options.parse},options);if(this.keyContents instanceof Backbone.Collection){this._prepareCollection(this.keyContents);related=this.keyContents;}
else{var toAdd=[];_.each(this.keyContents,function(attributes){if(attributes instanceof this.relatedModel){var model=attributes;}
else{model=this.relatedModel.findOrCreate(attributes,_.extend({merge:true},options,{create:this.options.createModels}));}
model&&toAdd.push(model);},this);if(this.related instanceof Backbone.Collection){related=this.related;}
else{related=this._prepareCollection();}
related.set(toAdd,_.defaults({merge:false,parse:false},options));}
this.keyIds=_.difference(this.keyIds,_.pluck(related.models,'id'));return related;},setKeyContents:function(keyContents){this.keyContents=keyContents instanceof Backbone.Collection?keyContents:null;this.keyIds=[];if(!this.keyContents&&(keyContents||keyContents===0)){this.keyContents=_.isArray(keyContents)?keyContents:[keyContents];_.each(this.keyContents,function(item){var itemId=Backbone.Relational.store.resolveIdForItem(this.relatedModel,item);if(itemId||itemId===0){this.keyIds.push(itemId);}},this);}},onChange:function(model,attr,options){options=options?_.clone(options):{};this.setKeyContents(attr);this.changed=false;var related=this.findRelated(options);this.setRelated(related);if(!options.silent){var dit=this;Backbone.Relational.eventQueue.add(function(){if(dit.changed){dit.instance.trigger('change:'+dit.key,dit.instance,dit.related,options,true);dit.changed=false;}});}},handleAddition:function(model,coll,options){options=options?_.clone(options):{};this.changed=true;_.each(this.getReverseRelations(model),function(relation){relation.addRelated(this.instance,options);},this);var dit=this;!options.silent&&Backbone.Relational.eventQueue.add(function(){dit.instance.trigger('add:'+dit.key,model,dit.related,options);});},handleRemoval:function(model,coll,options){options=options?_.clone(options):{};this.changed=true;_.each(this.getReverseRelations(model),function(relation){relation.removeRelated(this.instance,null,options);},this);var dit=this;!options.silent&&Backbone.Relational.eventQueue.add(function(){dit.instance.trigger('remove:'+dit.key,model,dit.related,options);});},handleReset:function(coll,options){var dit=this;options=options?_.clone(options):{};!options.silent&&Backbone.Relational.eventQueue.add(function(){dit.instance.trigger('reset:'+dit.key,dit.related,options);});},tryAddRelated:function(model,coll,options){var item=_.contains(this.keyIds,model.id);if(item){this.addRelated(model,options);this.keyIds=_.without(this.keyIds,model.id);}},addRelated:function(model,options){var dit=this;model.queue(function(){if(dit.related&&!dit.related.get(model)){dit.related.add(model,_.defaults({parse:false},options));}});},removeRelated:function(model,coll,options){if(this.related.get(model)){this.related.remove(model,options);}}});Backbone.RelationalModel=Backbone.Model.extend({relations:null,_relations:null,_isInitialized:false,_deferProcessing:false,_queue:null,subModelTypeAttribute:'type',subModelTypes:null,constructor:function(attributes,options){if(options&&options.collection){var dit=this,collection=this.collection=options.collection;delete options.collection;this._deferProcessing=true;var processQueue=function(model){if(model===dit){dit._deferProcessing=false;dit.processQueue();collection.off('relational:add',processQueue);}};collection.on('relational:add',processQueue);_.defer(function(){processQueue(dit);});}
Backbone.Relational.store.processOrphanRelations();this._queue=new Backbone.BlockingQueue();this._queue.block();Backbone.Relational.eventQueue.block();try{Backbone.Model.apply(this,arguments);}
finally{Backbone.Relational.eventQueue.unblock();}},trigger:function(eventName){if(eventName.length>5&&eventName.indexOf('change')===0){var dit=this,args=arguments;Backbone.Relational.eventQueue.add(function(){if(!dit._isInitialized){return;}
var changed=true;if(eventName==='change'){changed=dit.hasChanged();}
else{var attr=eventName.slice(7),rel=dit.getRelation(attr);if(rel){changed=(args[4]===true);if(changed){dit.changed[attr]=args[2];}
else if(!rel.changed){delete dit.changed[attr];}}}
changed&&Backbone.Model.prototype.trigger.apply(dit,args);});}
else{Backbone.Model.prototype.trigger.apply(this,arguments);}
return this;},initializeRelations:function(options){this.acquire();this._relations={};_.each(this.relations||[],function(rel){Backbone.Relational.store.initializeRelation(this,rel,options);},this);this._isInitialized=true;this.release();this.processQueue();},updateRelations:function(options){if(this._isInitialized&&!this.isLocked()){_.each(this._relations,function(rel){var val=this.attributes[rel.keySource]||this.attributes[rel.key];if(rel.related!==val){this.trigger('relational:change:'+rel.key,this,val,options||{});}},this);}},queue:function(func){this._queue.add(func);},processQueue:function(){if(this._isInitialized&&!this._deferProcessing&&this._queue.isBlocked()){this._queue.unblock();}},getRelation:function(key){return this._relations[key];},getRelations:function(){return _.values(this._relations);},fetchRelated:function(key,options,refresh){options=_.extend({update:true,remove:false},options);var setUrl,requests=[],rel=this.getRelation(key),idsToFetch=rel&&(rel.keyIds||((rel.keyId||rel.keyId===0)?[rel.keyId]:[]));if(refresh){var models=rel.related instanceof Backbone.Collection?rel.related.models:[rel.related];_.each(models,function(model){if(model.id||model.id===0){idsToFetch.push(model.id);}});}
if(idsToFetch&&idsToFetch.length){var created=[],models=_.map(idsToFetch,function(id){var model=Backbone.Relational.store.find(rel.relatedModel,id);if(!model){var attrs={};attrs[rel.relatedModel.prototype.idAttribute]=id;model=rel.relatedModel.findOrCreate(attrs,options);created.push(model);}
return model;},this);if(rel.related instanceof Backbone.Collection&&_.isFunction(rel.related.url)){setUrl=rel.related.url(models);}
if(setUrl&&setUrl!==rel.related.url()){var opts=_.defaults({error:function(){var args=arguments;_.each(created,function(model){model.trigger('destroy',model,model.collection,options);options.error&&options.error.apply(model,args);});},url:setUrl},options);requests=[rel.related.fetch(opts)];}
else{requests=_.map(models,function(model){var opts=_.defaults({error:function(){if(_.contains(created,model)){model.trigger('destroy',model,model.collection,options);options.error&&options.error.apply(model,arguments);}}},options);return model.fetch(opts);},this);}}
return requests;},get:function(attr){var originalResult=Backbone.Model.prototype.get.call(this,attr);if(!this.dotNotation||attr.indexOf('.')===-1){return originalResult;}
var splits=attr.split('.');var result=_.reduce(splits,function(model,split){if(!(model instanceof Backbone.Model)){throw new Error('Attribute must be an instanceof Backbone.Model. Is: '+model+', currentSplit: '+split);}
return Backbone.Model.prototype.get.call(model,split);},this);if(originalResult!==undefined&&result!==undefined){throw new Error("Ambiguous result for '"+attr+"'. direct result: "+originalResult+", dotNotation: "+result);}
return originalResult||result;},set:function(key,value,options){Backbone.Relational.eventQueue.block();var attributes;if(_.isObject(key)||key==null){attributes=key;options=value;}
else{attributes={};attributes[key]=value;}
try{var id=this.id,newId=attributes&&this.idAttribute in attributes&&attributes[this.idAttribute];Backbone.Relational.store.checkId(this,newId);var result=Backbone.Model.prototype.set.apply(this,arguments);if(!this._isInitialized&&!this.isLocked()){this.constructor.initializeModelHierarchy();Backbone.Relational.store.register(this);this.initializeRelations(options);}
else if(newId&&newId!==id){Backbone.Relational.store.update(this);}
if(attributes){this.updateRelations(options);}}
finally{Backbone.Relational.eventQueue.unblock();}
return result;},unset:function(attribute,options){Backbone.Relational.eventQueue.block();var result=Backbone.Model.prototype.unset.apply(this,arguments);this.updateRelations(options);Backbone.Relational.eventQueue.unblock();return result;},clear:function(options){Backbone.Relational.eventQueue.block();var result=Backbone.Model.prototype.clear.apply(this,arguments);this.updateRelations(options);Backbone.Relational.eventQueue.unblock();return result;},clone:function(){var attributes=_.clone(this.attributes);if(!_.isUndefined(attributes[this.idAttribute])){attributes[this.idAttribute]=null;}
_.each(this.getRelations(),function(rel){delete attributes[rel.key];});return new this.constructor(attributes);},toJSON:function(options){if(this.isLocked()){return this.id;}
this.acquire();var json=Backbone.Model.prototype.toJSON.call(this,options);if(this.constructor._superModel&&!(this.constructor._subModelTypeAttribute in json)){json[this.constructor._subModelTypeAttribute]=this.constructor._subModelTypeValue;}
_.each(this._relations,function(rel){var related=json[rel.key],includeInJSON=rel.options.includeInJSON,value=null;if(includeInJSON===true){if(related&&_.isFunction(related.toJSON)){value=related.toJSON(options);}}
else if(_.isString(includeInJSON)){if(related instanceof Backbone.Collection){value=related.pluck(includeInJSON);}
else if(related instanceof Backbone.Model){value=related.get(includeInJSON);}
if(includeInJSON===rel.relatedModel.prototype.idAttribute){if(rel instanceof Backbone.HasMany){value=value.concat(rel.keyIds);}
else if(rel instanceof Backbone.HasOne){value=value||rel.keyId;}}}
else if(_.isArray(includeInJSON)){if(related instanceof Backbone.Collection){value=[];related.each(function(model){var curJson={};_.each(includeInJSON,function(key){curJson[key]=model.get(key);});value.push(curJson);});}
else if(related instanceof Backbone.Model){value={};_.each(includeInJSON,function(key){value[key]=related.get(key);});}}
else{delete json[rel.key];}
if(includeInJSON){json[rel.keyDestination]=value;}
if(rel.keyDestination!==rel.key){delete json[rel.key];}});this.release();return json;}},{setup:function(superModel){this.prototype.relations=(this.prototype.relations||[]).slice(0);this._subModels={};this._superModel=null;if(this.prototype.hasOwnProperty('subModelTypes')){Backbone.Relational.store.addSubModels(this.prototype.subModelTypes,this);}
else{this.prototype.subModelTypes=null;}
_.each(this.prototype.relations||[],function(rel){if(!rel.model){rel.model=this;}
if(rel.reverseRelation&&rel.model===this){var preInitialize=true;if(_.isString(rel.relatedModel)){var relatedModel=Backbone.Relational.store.getObjectByName(rel.relatedModel);preInitialize=relatedModel&&(relatedModel.prototype instanceof Backbone.RelationalModel);}
if(preInitialize){Backbone.Relational.store.initializeRelation(null,rel);}
else if(_.isString(rel.relatedModel)){Backbone.Relational.store.addOrphanRelation(rel);}}},this);return this;},build:function(attributes,options){var model=this;this.initializeModelHierarchy();if(this._subModels&&this.prototype.subModelTypeAttribute in attributes){var subModelTypeAttribute=attributes[this.prototype.subModelTypeAttribute];var subModelType=this._subModels[subModelTypeAttribute];if(subModelType){model=subModelType;}}
return new model(attributes,options);},initializeModelHierarchy:function(){if(_.isUndefined(this._superModel)||_.isNull(this._superModel)){Backbone.Relational.store.setupSuperModel(this);if(this._superModel&&this._superModel.prototype.relations){var inheritedRelations=_.select(this._superModel.prototype.relations||[],function(superRel){return!_.any(this.prototype.relations||[],function(rel){return superRel.relatedModel===rel.relatedModel&&superRel.key===rel.key;},this);},this);this.prototype.relations=inheritedRelations.concat(this.prototype.relations);}
else{this._superModel=false;}}
if(this.prototype.subModelTypes&&_.keys(this.prototype.subModelTypes).length!==_.keys(this._subModels).length){_.each(this.prototype.subModelTypes||[],function(subModelTypeName){var subModelType=Backbone.Relational.store.getObjectByName(subModelTypeName);subModelType&&subModelType.initializeModelHierarchy();});}},findOrCreate:function(attributes,options){options||(options={});var parsedAttributes=(_.isObject(attributes)&&options.parse&&this.prototype.parse)?this.prototype.parse(attributes):attributes;var model=Backbone.Relational.store.find(this,parsedAttributes);if(_.isObject(attributes)){if(model&&options.merge!==false){delete options.collection;model.set(parsedAttributes,options);}
else if(!model&&options.create!==false){model=this.build(attributes,options);}}
return model;}});_.extend(Backbone.RelationalModel.prototype,Backbone.Semaphore);Backbone.Collection.prototype.__prepareModel=Backbone.Collection.prototype._prepareModel;Backbone.Collection.prototype._prepareModel=function(attrs,options){var model;if(attrs instanceof Backbone.Model){if(!attrs.collection){attrs.collection=this;}
model=attrs;}
else{options||(options={});options.collection=this;if(typeof this.model.findOrCreate!=='undefined'){model=this.model.findOrCreate(attrs,options);}
else{model=new this.model(attrs,options);}
if(model&&model.isNew()&&!model._validate(attrs,options)){this.trigger('invalid',this,attrs,options);model=false;}}
return model;};var set=Backbone.Collection.prototype.__set=Backbone.Collection.prototype.set;Backbone.Collection.prototype.set=function(models,options){if(!(this.model.prototype instanceof Backbone.RelationalModel)){return set.apply(this,arguments);}
if(options&&options.parse){models=this.parse(models,options);}
if(!_.isArray(models)){models=models?[models]:[];}
var newModels=[],toAdd=[];_.each(models,function(model){if(!(model instanceof Backbone.Model)){model=Backbone.Collection.prototype._prepareModel.call(this,model,options);}
if(model){toAdd.push(model);if(!(this.get(model)||this.get(model.cid))){newModels.push(model);}
else if(model.id!=null){this._byId[model.id]=model;}}},this);set.call(this,toAdd,_.defaults({parse:false},options));_.each(newModels,function(model){if(this.get(model)||this.get(model.cid)){this.trigger('relational:add',model,this,options);}},this);return this;};var remove=Backbone.Collection.prototype.__remove=Backbone.Collection.prototype.remove;Backbone.Collection.prototype.remove=function(models,options){if(!(this.model.prototype instanceof Backbone.RelationalModel)){return remove.apply(this,arguments);}
models=_.isArray(models)?models.slice():[models];options||(options={});var toRemove=[];_.each(models,function(model){model=this.get(model)||this.get(model.cid);model&&toRemove.push(model);},this);if(toRemove.length){remove.call(this,toRemove,options);_.each(toRemove,function(model){this.trigger('relational:remove',model,this,options);},this);}
return this;};var reset=Backbone.Collection.prototype.__reset=Backbone.Collection.prototype.reset;Backbone.Collection.prototype.reset=function(models,options){options=_.extend({merge:true},options);reset.call(this,models,options);if(this.model.prototype instanceof Backbone.RelationalModel){this.trigger('relational:reset',this,options);}
return this;};var sort=Backbone.Collection.prototype.__sort=Backbone.Collection.prototype.sort;Backbone.Collection.prototype.sort=function(options){sort.call(this,options);if(this.model.prototype instanceof Backbone.RelationalModel){this.trigger('relational:reset',this,options);}
return this;};var trigger=Backbone.Collection.prototype.__trigger=Backbone.Collection.prototype.trigger;Backbone.Collection.prototype.trigger=function(eventName){if(!(this.model.prototype instanceof Backbone.RelationalModel)){return trigger.apply(this,arguments);}
if(eventName==='add'||eventName==='remove'||eventName==='reset'){var dit=this,args=arguments;if(_.isObject(args[3])){args=_.toArray(args);args[3]=_.clone(args[3]);}
Backbone.Relational.eventQueue.add(function(){trigger.apply(dit,args);});}
else{trigger.apply(this,arguments);}
return this;};Backbone.RelationalModel.extend=function(protoProps,classProps){var child=Backbone.Model.extend.apply(this,arguments);child.setup(this);return child;};})();ClBackbone.RelationalModel=function(){};ClBackbone.RelationalModel=$CL.extendClass(ClBackbone.RelationalModel,Backbone.RelationalModel,{extend:function(protoProps,classProps){var child=Backbone.Model.extend.apply(this,arguments);child.setup(this);child.on("all",$CL.bind(this.triggerClEvent,this));return child;},getParams:function(){return this.toJSON();},triggerClEvent:function(){var eventName=arguments[0];var newArgs=[];for(var i in arguments){if(i!=0)
newArgs[newArgs.length]=arguments[i];}
var event=$CL.get("Cl.Event.Event",{params:{arguments:newArgs},name:eventName});this.events().trigger(event);}});_.extend(ClBackbone.RelationalModel.prototype,Cl.Event.EventManagerProvider);var Entity=$CL.namespace('Ginger.Jobs.Entity');$CL.require('Cl.Backbone.RelationalModel');Entity.Jobrun=function(){};Entity.Jobrun=$CL.extendClass(Entity.Jobrun,Cl.Backbone.RelationalModel);var ClBackbone=$CL.namespace("Cl.Backbone");$CL.require("Cl.Backbone.Backbone");$CL.require("Cl.Event.Manager");$CL.require("Cl.Event.Event");$CL.require("Cl.Event.EventManagerProvider");ClBackbone.Collection=function ClBackboneCollection(){};ClBackbone.Collection=$CL.extendClass(ClBackbone.Collection,Backbone.Collection,{setup:function(){this.on("all",$CL.bind(this.triggerClEvent,this));this.on("add",$CL.bind(function(model){$CL.initObj(model,this.modelClass);},this));},triggerClEvent:function(){var eventName=arguments[0];var newArgs=[];for(var i in arguments){if(i!=0)
newArgs[newArgs.length]=arguments[i];}
var event=$CL.get("Cl.Event.Event",{params:{arguments:newArgs},name:eventName});this.events().trigger(event);}});_.extend(ClBackbone.Collection.prototype,Cl.Event.EventManagerProvider);var Collection=$CL.namespace('Ginger.Jobs.Collection');$CL.require("Cl.Backbone.Collection");$CL.require("Ginger.Jobs.Entity.Jobrun");Collection.LatestJobruns=function(){};Collection.LatestJobruns=$CL.extendClass(Collection.LatestJobruns,Cl.Backbone.Collection,{url:"/rest/latest-jobruns",modelClass:"Ginger.Jobs.Entity.Jobrun",model:Ginger.Jobs.Entity.Jobrun,comparator:function(model1,model2){var model1Date=model1.get('startTime'),model2Date=model2.get('startTime'),model1Ts=0,model2Ts=0;if(model1Date){model1Ts=Date.parseDate(model1Date,Date.getDbStrFmt(true)).toTimestamp();}
if(model2Date){model2Ts=Date.parseDate(model2Date,Date.getDbStrFmt(true)).toTimestamp();}
if(model1Ts==0&&model2Ts==0){return 0;}
if(model1Ts==0){return-1;}
if(model2Ts==0){return 1;}
if(model1Ts>model2Ts){return-1;}
if(model1Ts==model2Ts){return 0;}
if(model1Ts<model2Ts){return 1;}}});var Entity=$CL.namespace('Ginger.Jobs.Entity');$CL.require('Cl.Backbone.RelationalModel');Entity.Feature=function(){};Entity.Feature=$CL.extendClass(Entity.Feature,Cl.Backbone.RelationalModel);var Collection=$CL.namespace('Ginger.Jobs.Collection');$CL.require("Cl.Backbone.Collection");$CL.require("Ginger.Jobs.Entity.Feature");Collection.Features=function(){};Collection.Features=$CL.extendClass(Collection.Features,Cl.Backbone.Collection,{url:"/rest/features",modelClass:"Ginger.Jobs.Entity.Feature",model:Ginger.Jobs.Entity.Feature,comparator:function(model){return model.get('module')+'::'+model.get('name');}});var Entity=$CL.namespace('Ginger.Jobs.Entity');$CL.require('Cl.Backbone.RelationalModel');Entity.TargetInfo=function(){};Entity.TargetInfo=$CL.extendClass(Entity.TargetInfo,Cl.Backbone.RelationalModel);var Collection=$CL.namespace('Ginger.Jobs.Collection');$CL.require("Cl.Backbone.Collection");$CL.require("Ginger.Jobs.Entity.TargetInfo");Collection.TargetInfos=function(){};Collection.TargetInfos=$CL.extendClass(Collection.TargetInfos,Cl.Backbone.Collection,{url:"/rest/targetinfo",modelClass:"Ginger.Jobs.Entity.TargetInfo",model:Ginger.Jobs.Entity.TargetInfo});var Entity=$CL.namespace('Ginger.Jobs.Entity');$CL.require('Cl.Backbone.RelationalModel');Entity.Target=function(){};Entity.Target=$CL.extendClass(Entity.Target,Cl.Backbone.RelationalModel);var Collection=$CL.namespace('Ginger.Jobs.Collection');$CL.require("Cl.Backbone.Collection");$CL.require("Ginger.Jobs.Entity.Target");Collection.Targets=function(){};Collection.Targets=$CL.extendClass(Collection.Targets,Cl.Backbone.Collection,{url:"/rest/targets",modelClass:"Ginger.Jobs.Entity.Target",model:Ginger.Jobs.Entity.Target,comparator:function(model){return model.get('module')+'::'+model.get('name');}});var Entity=$CL.namespace('Ginger.Jobs.Entity');$CL.require('Cl.Backbone.RelationalModel');Entity.Mapper=function(){};Entity.Mapper=$CL.extendClass(Entity.Mapper,Cl.Backbone.RelationalModel);var Collection=$CL.namespace('Ginger.Jobs.Collection');$CL.require("Cl.Backbone.Collection");$CL.require("Ginger.Jobs.Entity.Mapper");Collection.Mappers=function(){};Collection.Mappers=$CL.extendClass(Collection.Mappers,Cl.Backbone.Collection,{url:"/rest/mappers",modelClass:"Ginger.Jobs.Entity.Mapper",model:Ginger.Jobs.Entity.Mapper});var Entity=$CL.namespace('Ginger.Jobs.Entity');$CL.require('Cl.Backbone.RelationalModel');Entity.SourceInfo=function(){};Entity.SourceInfo=$CL.extendClass(Entity.SourceInfo,Cl.Backbone.RelationalModel);var Collection=$CL.namespace('Ginger.Jobs.Collection');$CL.require("Cl.Backbone.Collection");$CL.require("Ginger.Jobs.Entity.SourceInfo");Collection.SourceInfos=function(){};Collection.SourceInfos=$CL.extendClass(Collection.SourceInfos,Cl.Backbone.Collection,{url:"/rest/sourceinfo",modelClass:"Ginger.Jobs.Entity.SourceInfo",model:Ginger.Jobs.Entity.SourceInfo});var Entity=$CL.namespace('Ginger.Jobs.Entity');$CL.require('Cl.Backbone.RelationalModel');Entity.Source=function(){};Entity.Source=$CL.extendClass(Entity.Source,Cl.Backbone.RelationalModel);var Collection=$CL.namespace('Ginger.Jobs.Collection');$CL.require("Cl.Backbone.Collection");$CL.require("Ginger.Jobs.Entity.Source");Collection.Sources=function(){};Collection.Sources=$CL.extendClass(Collection.Sources,Cl.Backbone.Collection,{url:"/rest/sources",modelClass:"Ginger.Jobs.Entity.Source",model:Ginger.Jobs.Entity.Source,comparator:function(model){return model.get('module')+'::'+model.get('name');}});var Collection=$CL.namespace('Ginger.Jobs.Collection');$CL.require("Cl.Backbone.Collection");$CL.require("Ginger.Jobs.Entity.Jobrun");Collection.Jobruns=function(){};Collection.Jobruns=$CL.extendClass(Collection.Jobruns,Cl.Backbone.Collection,{urlBase:"/rest/jobruns",url:"",modelClass:"Ginger.Jobs.Entity.Jobrun",model:Ginger.Jobs.Entity.Jobrun,setJobName:function(jobName){this.url=this.urlBase+"/"+jobName;},comparator:function(model1,model2){var model1Date=model1.get('startTime'),model2Date=model2.get('startTime'),model1Ts=0,model2Ts=0;if(model1Date){model1Ts=Date.parseDate(model1Date,Date.getDbStrFmt(true)).toTimestamp();}
if(model2Date){model2Ts=Date.parseDate(model2Date,Date.getDbStrFmt(true)).toTimestamp();}
if(model1Ts==0&&model2Ts==0){return 0;}
if(model1Ts==0){return-1;}
if(model2Ts==0){return 1;}
if(model1Ts>model2Ts){return-1;}
if(model1Ts==model2Ts){return 0;}
if(model1Ts<model2Ts){return 1;}}});var Entity=$CL.namespace('Ginger.Jobs.Entity');$CL.require('Cl.Backbone.RelationalModel');Entity.Configuration=function(){};Entity.Configuration=$CL.extendClass(Entity.Configuration,Cl.Backbone.RelationalModel);var Collection=$CL.namespace('Ginger.Jobs.Collection');$CL.require("Cl.Backbone.Collection");$CL.require("Ginger.Jobs.Entity.Configuration");Collection.Configurations=function(){};Collection.Configurations=$CL.extendClass(Collection.Configurations,Cl.Backbone.Collection,{urlBase:"/rest/configurations",url:"",modelClass:"Ginger.Jobs.Entity.Configuration",model:Ginger.Jobs.Entity.Configuration,setJobName:function(jobName){this.url=this.urlBase+"/"+jobName;}});var Entity=$CL.namespace('Ginger.Jobs.Entity');$CL.require('Cl.Backbone.RelationalModel');$CL.require("Ginger.Jobs.Entity.Configuration");$CL.require("Ginger.Jobs.Entity.Jobrun");$CL.require("Ginger.Jobs.Collection.Configurations");$CL.require("Ginger.Jobs.Collection.Jobruns");Entity.Job=function(){};Entity.Job=$CL.extendClass(Entity.Job,Cl.Backbone.RelationalModel,{idAttribute:'name',defaults:{description:""},relations:[{type:'HasMany',key:'configurations',relatedModel:Ginger.Jobs.Entity.Configuration,collectionType:Ginger.Jobs.Collection.Configurations,reverseRelation:{key:'job'}},{type:'HasMany',key:'jobruns',relatedModel:Ginger.Jobs.Entity.Jobrun,collectionType:Ginger.Jobs.Collection.Jobruns,reverseRelation:{key:'job'}}],get:function(key){var value=this.parent.prototype.get.apply(this,arguments);if(key=="configurations"||key=="jobruns"){if(value){value.setJobName(this.get('name'));}}
return value;}});var Collection=$CL.namespace('Ginger.Jobs.Collection');$CL.require("Cl.Backbone.Collection");$CL.require("Ginger.Jobs.Entity.Job");Collection.Jobs=function(){};Collection.Jobs=$CL.extendClass(Collection.Jobs,Cl.Backbone.Collection,{url:"/rest/jobs",modelClass:"Ginger.Jobs.Entity.Job",model:Ginger.Jobs.Entity.Job,parse:function(models,options){_.each(models,function(model){var configs=[].concat(model.configurations),jobruns=[].concat(model.jobruns);model.configurations=$CL.makeObj('Ginger.Jobs.Collection.Configurations');model.configurations.set(configs);model.jobruns=$CL.makeObj('Ginger.Jobs.Collection.Jobruns');model.jobruns.set(jobruns);});return models;}});var Element=$CL.namespace('Cl.Form.Element');$CL.require("Cl.Form.Element.AbstractElement");$CL.require("Cl.Form.Filter.StringTrim");$CL.require("Cl.Form.Validator.NotEmpty");Element.Textarea=function(){};Element.Textarea=$CL.extendClass(Element.Textarea,Element.AbstractElement,{init:function(){this.addFilter($CL.get('Cl.Form.Filter.StringTrim'));this.addValidator($CL.get('Cl.Form.Validator.NotEmpty'));},selectElement:function(){this.$el=$('textarea[name='+this.getName()+']');this.$el.unbind('blur.form-element');this.$el.bind('blur.form-element',$CL.bind(function(e){this.isValid();},this));}});var Form=$CL.namespace('Ginger.Jobs.Form');$CL.require('Cl.Form.Form');$CL.require('Cl.Form.Element.Text');$CL.require('Cl.Form.Element.Textarea');Form.AddJob=function(){};Form.AddJob=$CL.extendClass(Form.AddJob,Cl.Form.Form,{name:"AddJob",init:function(){this.elements=[$CL.makeObj('Cl.Form.Element.Text',{'name':'name','label':$CL.translate('JOBS::FORM::LABEL::JOBNAME')}),$CL.makeObj('Cl.Form.Element.Textarea',{'name':'description','label':$CL.translate('FORM::LABEL::DESCRIPTION')})]}});var Jobrun=$CL.namespace('Ginger.Jobs.View.Jobrun');$CL.require('Cl.Backbone.View');Jobrun.Entry=function(){};Jobrun.Entry=$CL.extendClass(Jobrun.Entry,Cl.Backbone.View,{isTerminal:function(){return true;}});var Jobrun=$CL.namespace('Ginger.Jobs.View.Jobrun');$CL.require('Cl.Backbone.View');Jobrun.Show=function(){};Jobrun.Show=$CL.extendClass(Jobrun.Show,Cl.Backbone.View,{log:null,activeFilter:'all',runningRefresh:null,events:{'click .js-more-text':'onMoreTextClick','click .js-filter':'onFilterClick'},setData:function(data){this.parent.prototype.setData.call(this,data);var jobFinished=this._prepareLog();this.data.log=[].concat(this.log);this.data.log.reverse();if(this.runningRefresh){window.clearTimeout(this.runningRefresh);}
if(!jobFinished){this.runningRefresh=window.setTimeout($CL.bind(function(){$CL.app().router.forward('jobs_jobrun_refresh',{jobname:this.data.jobname,id:this.data.id});},this),3000);}
this.data.jobFinished=jobFinished;return this;},render:function(){this.parent.prototype.render.apply(this);this._markActiveFilter();},onMoreTextClick:function(e){e.preventDefault();var $a=$CL.jTarget(e.target,'a'),$subMsg=$a.parents('.sub-msg'),$fullMsg=$subMsg.next();if($fullMsg.is(':hidden')){$a.find('i').removeClass('icon-arrow-down').addClass('icon-arrow-up');$fullMsg.slideDown();}else{$fullMsg.slideUp();$a.find('i').removeClass('icon-arrow-up').addClass('icon-arrow-down');}},onFilterClick:function(e){e.preventDefault();var $a=$CL.jTarget(e.target,'a');if($a.hasClass('js-all')){this.activeFilter='all';}else if($a.hasClass('js-success')){this.activeFilter='success';}else if($a.hasClass('js-warning')){this.activeFilter='warning';}else if($a.hasClass('js-error')){this.activeFilter='error';}
this.data.log=this._filterLog(this.activeFilter);this.data.log.reverse();this.render();},_filterLog:function(filter){if(filter=="all"){return[].concat(this.log);}
return _.where(this.log,{status:filter});},_prepareLog:function(){var jobrun=this.data,nonSuccessfulConfigrun=false,statusWord,configEndMsg,totalItems=0,insertedItems=0;this.log=[];this._addLogMsg('success',helpers.time(jobrun.startTime),$CL.translate('JOBS::JOBRUN::STARTED').replace(':jobname',jobrun.jobname));$.each(jobrun.configurationRuns,$CL.bind(function(i,configRun){var configuration=_.find(this.data.configurations,function(config){return config.id==configRun.configurationId;});if(nonSuccessfulConfigrun){this._addLogMsg('warning',helpers.time(configRun.startTime),$CL.translate('JOBS::JOBRUN::CONTINUE_AFTER_FAILURE'));}
this._addLogMsg('success',helpers.time(configRun.startTime),$CL.translate('JOBS::JOBRUN::CONFIG::STARTED').replace(':number',i+1));_.each(configRun.messages,function(message){this._addLogMsg((message.type=="info")?'success':message.type,helpers.time(message.timestamp),message.text);},this);if(!configRun.endTime){return;}
statusWord=(configRun.success)?$CL.translate('GENERAL::SUCCESSFUL'):$CL.translate('GENERAL::ERRORFUL');configEndMsg=$CL.translate('JOBS::JOBRUN::CONFIG::END').replace(':number',i+1).replace(':status',statusWord);if(configRun.totalItemCount>0){configEndMsg+=' '+$CL.translate('JOBS::JOBRUN::CONFIG::END_ITEMS').replace(':totalItems',configRun.totalItemCount).replace(':insertedItems',configRun.insertedItemCount).replace(':pluralItemName',$CL.translatePlural('CONFIGURATION::ITEM_NAME::'+configuration.source.itemName,2)).replace(':pastAction',$CL.translate('CONFIGURATION::TARGET_ACTION_PAST::'+configuration.target.action));}
this._addLogMsg((configRun.success)?'success':'error',helpers.time(configRun.endTime),configEndMsg);totalItems+=configRun.totalItemCount;insertedItems+=configRun.insertedItemCount;if(!configRun.success){nonSuccessfulConfigrun=true;}},this));if(!jobrun.endTime){return false;}
statusWord=(jobrun.success)?$CL.translate('GENERAL::SUCCESSFUL'):$CL.translate('GENERAL::ERRORFUL');this._addLogMsg((jobrun.success)?'success':'error',helpers.time(jobrun.endTime),$CL.translate('JOBS::JOBRUN::END').replace(':jobname',jobrun.jobname).replace(':status',statusWord).replace(':totalItems',totalItems).replace(':insertedItems',insertedItems));return true;},_addLogMsg:function(status,time,msg){if(_.isNull(this.log)){this.log=[];}
this.log.push({status:status,time:time,msg:msg});},_markActiveFilter:function(){$('.js-'+this.activeFilter).addClass('active');}});(function($){$.fn.extend({fullWidth:function(){if($.browser.msie&&parseInt($.browser.version)<9){return this.width();}else
return this.outerWidth();}});})
(jQuery);(function($){$.fn.extend({fullHeight:function(){if($.browser.msie&&parseInt($.browser.version)<9){return this.height();}else
return this.outerHeight();}});})
(jQuery);(function($,undefined){var uuid=0,runiqueId=/^ui-id-\d+$/;$.ui=$.ui||{};if($.ui.version){return;}
$.extend($.ui,{version:"1.10.1",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});$.fn.extend({_focus:$.fn.focus,focus:function(delay,fn){return typeof delay==="number"?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus();if(fn){fn.call(elem);}},delay);}):this._focus.apply(this,arguments);},scrollParent:function(){var scrollParent;if(($.ui.ie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){scrollParent=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test($.css(this,"position"))&&(/(auto|scroll)/).test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"));}).eq(0);}else{scrollParent=this.parents().filter(function(){return(/(auto|scroll)/).test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"));}).eq(0);}
return(/fixed/).test(this.css("position"))||!scrollParent.length?$(document):scrollParent;},zIndex:function(zIndex){if(zIndex!==undefined){return this.css("zIndex",zIndex);}
if(this.length){var elem=$(this[0]),position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value;}}
elem=elem.parent();}}
return 0;},uniqueId:function(){return this.each(function(){if(!this.id){this.id="ui-id-"+(++uuid);}});},removeUniqueId:function(){return this.each(function(){if(runiqueId.test(this.id)){$(this).removeAttr("id");}});}});function focusable(element,isTabIndexNotNaN){var map,mapName,img,nodeName=element.nodeName.toLowerCase();if("area"===nodeName){map=element.parentNode;mapName=map.name;if(!element.href||!mapName||map.nodeName.toLowerCase()!=="map"){return false;}
img=$("img[usemap=#"+mapName+"]")[0];return!!img&&visible(img);}
return(/input|select|textarea|button|object/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element);}
function visible(element){return $.expr.filters.visible(element)&&!$(element).parents().addBack().filter(function(){return $.css(this,"visibility")==="hidden";}).length;}
$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName);};}):function(elem,i,match){return!!$.data(elem,match[3]);},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")));},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN);}});if(!$("<a>").outerWidth(1).jquery){$.each(["Width","Height"],function(i,name){var side=name==="Width"?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};function reduce(elem,size,border,margin){$.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0;if(border){size-=parseFloat($.css(elem,"border"+this+"Width"))||0;}
if(margin){size-=parseFloat($.css(elem,"margin"+this))||0;}});return size;}
$.fn["inner"+name]=function(size){if(size===undefined){return orig["inner"+name].call(this);}
return this.each(function(){$(this).css(type,reduce(this,size)+"px");});};$.fn["outer"+name]=function(size,margin){if(typeof size!=="number"){return orig["outer"+name].call(this,size);}
return this.each(function(){$(this).css(type,reduce(this,size,true,margin)+"px");});};});}
if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));};}
if($("<a>").data("a-b","a").removeData("a-b").data("a-b")){$.fn.removeData=(function(removeData){return function(key){if(arguments.length){return removeData.call(this,$.camelCase(key));}else{return removeData.call(this);}};})($.fn.removeData);}
$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());$.support.selectstart="onselectstart"in document.createElement("div");$.fn.extend({disableSelection:function(){return this.bind(($.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(event){event.preventDefault();});},enableSelection:function(){return this.unbind(".ui-disableSelection");}});$.extend($.ui,{plugin:{add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]]);}},call:function(instance,name,args){var i,set=instance.plugins[name];if(!set||!instance.element[0].parentNode||instance.element[0].parentNode.nodeType===11){return;}
for(i=0;i<set.length;i++){if(instance.options[set[i][0]]){set[i][1].apply(instance.element,args);}}}},hasScroll:function(el,a){if($(el).css("overflow")==="hidden"){return false;}
var scroll=(a&&a==="left")?"scrollLeft":"scrollTop",has=false;if(el[scroll]>0){return true;}
el[scroll]=1;has=(el[scroll]>0);el[scroll]=0;return has;}});})(jQuery);(function($,undefined){var uuid=0,slice=Array.prototype.slice,_cleanData=$.cleanData;$.cleanData=function(elems){for(var i=0,elem;(elem=elems[i])!=null;i++){try{$(elem).triggerHandler("remove");}catch(e){}}
_cleanData(elems);};$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget;}
$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName);};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element);}
if(arguments.length){this._createWidget(options,element);}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base();basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return;}
proxiedPrototype[prop]=(function(){var _super=function(){return base.prototype[prop].apply(this,arguments);},_superApply=function(args){return base.prototype[prop].apply(this,args);};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue;};})();});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto);});delete existingConstructor._childConstructors;}else{base._childConstructors.push(constructor);}
$.widget.bridge(name,constructor);};$.widget.extend=function(target){var input=slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value);}else{target[key]=value;}}}}
return target;};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=slice.call(arguments,1),returnValue=this;options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'");}
if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance");}
methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false;}});}else{this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{})._init();}else{$.data(this,fullName,new object(options,this));}});}
return returnValue;};};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=uuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy();}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow);}
this._create();this._trigger("create",null,this._getCreateEventData());this._init();},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");},_destroy:$.noop,widget:function(){return this.element;},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options);}
if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]];}
key=parts.pop();if(value===undefined){return curOption[key]===undefined?null:curOption[key];}
curOption[key]=value;}else{if(value===undefined){return this.options[key]===undefined?null:this.options[key];}
options[key]=value;}}
this._setOptions(options);return this;},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key]);}
return this;},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!value).attr("aria-disabled",value);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");}
return this;},enable:function(){return this._setOption("disabled",false);},disable:function(){return this._setOption("disabled",true);},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false;}
if(!handlers){handlers=element;element=this.element;delegateElement=this.widget();}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element);}
$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass("ui-state-disabled"))){return;}
return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++;}
var match=event.match(/^(\w+)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy);}else{element.bind(eventName,handlerProxy);}});},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;element.unbind(eventName).undelegate(eventName);},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
var instance=this;return setTimeout(handlerProxy,delay||0);},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover");},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover");}});},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus");},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus");}});},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop];}}}
this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented());}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options};}
var hasOptions,effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options};}
hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay);}
if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options);}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback);}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0]);}
next();});}};});})(jQuery);(function($,undefined){var mouseHandled=false;$(document).mouseup(function(){mouseHandled=false;});$.widget("ui.mouse",{version:"1.10.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.bind("mousedown."+this.widgetName,function(event){return that._mouseDown(event);}).bind("click."+this.widgetName,function(event){if(true===$.data(event.target,that.widgetName+".preventClickEvent")){$.removeData(event.target,that.widgetName+".preventClickEvent");event.stopImmediatePropagation();return false;}});this.started=false;},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);}},_mouseDown:function(event){if(mouseHandled){return;}
(this._mouseStarted&&this._mouseUp(event));this._mouseDownEvent=event;var that=this,btnIsLeft=(event.which===1),elIsCancel=(typeof this.options.cancel==="string"&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:false);if(!btnIsLeft||elIsCancel||!this._mouseCapture(event)){return true;}
this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=true;},this.options.delay);}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(event)!==false);if(!this._mouseStarted){event.preventDefault();return true;}}
if(true===$.data(event.target,this.widgetName+".preventClickEvent")){$.removeData(event.target,this.widgetName+".preventClickEvent");}
this._mouseMoveDelegate=function(event){return that._mouseMove(event);};this._mouseUpDelegate=function(event){return that._mouseUp(event);};$(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);event.preventDefault();mouseHandled=true;return true;},_mouseMove:function(event){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button){return this._mouseUp(event);}
if(this._mouseStarted){this._mouseDrag(event);return event.preventDefault();}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,event)!==false);(this._mouseStarted?this._mouseDrag(event):this._mouseUp(event));}
return!this._mouseStarted;},_mouseUp:function(event){$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(event.target===this._mouseDownEvent.target){$.data(event.target,this.widgetName+".preventClickEvent",true);}
this._mouseStop(event);}
return false;},_mouseDistanceMet:function(event){return(Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance);},_mouseDelayMet:function(){return this.mouseDelayMet;},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true;}});})(jQuery);$CL.require("Cl.Jquery.Plugin.Ui.Core");(function($,undefined){$.widget("ui.draggable",$.ui.mouse,{version:"1.10.1",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false,drag:null,start:null,stop:null},_create:function(){if(this.options.helper==="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative";}
if(this.options.addClasses){this.element.addClass("ui-draggable");}
if(this.options.disabled){this.element.addClass("ui-draggable-disabled");}
this._mouseInit();},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();},_mouseCapture:function(event){var o=this.options;if(this.helper||o.disabled||$(event.target).closest(".ui-resizable-handle").length>0){return false;}
this.handle=this._getHandle(event);if(!this.handle){return false;}
$(o.iframeFix===true?"iframe":o.iframeFix).each(function(){$("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css($(this).offset()).appendTo("body");});return true;},_mouseStart:function(event){var o=this.options;this.helper=this._createHelper(event);this.helper.addClass("ui-draggable-dragging");this._cacheHelperProportions();if($.ui.ddmanager){$.ui.ddmanager.current=this;}
this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(event);this.originalPageX=event.pageX;this.originalPageY=event.pageY;(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));if(o.containment){this._setContainment();}
if(this._trigger("start",event)===false){this._clear();return false;}
this._cacheHelperProportions();if($.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}
this._mouseDrag(event,true);if($.ui.ddmanager){$.ui.ddmanager.dragStart(this,event);}
return true;},_mouseDrag:function(event,noPropagation){this.position=this._generatePosition(event);this.positionAbs=this._convertPositionTo("absolute");if(!noPropagation){var ui=this._uiHash();if(this._trigger("drag",event,ui)===false){this._mouseUp({});return false;}
this.position=ui.position;}
if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px";}
if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px";}
if($.ui.ddmanager){$.ui.ddmanager.drag(this,event);}
return false;},_mouseStop:function(event){var element,that=this,elementInDom=false,dropped=false;if($.ui.ddmanager&&!this.options.dropBehaviour){dropped=$.ui.ddmanager.drop(this,event);}
if(this.dropped){dropped=this.dropped;this.dropped=false;}
element=this.element[0];while(element&&(element=element.parentNode)){if(element===document){elementInDom=true;}}
if(!elementInDom&&this.options.helper==="original"){return false;}
if((this.options.revert==="invalid"&&!dropped)||(this.options.revert==="valid"&&dropped)||this.options.revert===true||($.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped))){$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(that._trigger("stop",event)!==false){that._clear();}});}else{if(this._trigger("stop",event)!==false){this._clear();}}
return false;},_mouseUp:function(event){$("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this);});if($.ui.ddmanager){$.ui.ddmanager.dragStop(this,event);}
return $.ui.mouse.prototype._mouseUp.call(this,event);},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({});}else{this._clear();}
return this;},_getHandle:function(event){var handle=!this.options.handle||!$(this.options.handle,this.element).length?true:false;$(this.options.handle,this.element).find("*").addBack().each(function(){if(this===event.target){handle=true;}});return handle;},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event])):(o.helper==="clone"?this.element.clone().removeAttr("id"):this.element);if(!helper.parents("body").length){helper.appendTo((o.appendTo==="parent"?this.element[0].parentNode:o.appendTo));}
if(helper[0]!==this.element[0]&&!(/(fixed|absolute)/).test(helper.css("position"))){helper.css("position","absolute");}
return helper;},_adjustOffsetFromHelper:function(obj){if(typeof obj==="string"){obj=obj.split(" ");}
if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0};}
if("left"in obj){this.offset.click.left=obj.left+this.margins.left;}
if("right"in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left;}
if("top"in obj){this.offset.click.top=obj.top+this.margins.top;}
if("bottom"in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top;}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop();}
if((this.offsetParent[0]===document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&$.ui.ie)){po={top:0,left:0};}
return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var p=this.element.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()};}else{return{top:0,left:0};}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)};},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};},_setContainment:function(){var over,c,ce,o=this.options;if(o.containment==="parent"){o.containment=this.helper[0].parentNode;}
if(o.containment==="document"||o.containment==="window"){this.containment=[o.containment==="document"?0:$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,o.containment==="document"?0:$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(o.containment==="document"?0:$(window).scrollLeft())+$(o.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,(o.containment==="document"?0:$(window).scrollTop())+($(o.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];}
if(!(/^(document|window|parent)$/).test(o.containment)&&o.containment.constructor!==Array){c=$(o.containment);ce=c[0];if(!ce){return;}
over=($(ce).css("overflow")!=="hidden");this.containment=[(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0),(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0),(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=c;}else if(o.containment.constructor===Array){this.containment=o.containment;}},_convertPositionTo:function(d,pos){if(!pos){pos=this.position;}
var mod=d==="absolute"?1:-1,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);return{top:(pos.top+
this.offset.relative.top*mod+
this.offset.parent.top*mod-
((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop()))*mod)),left:(pos.left+
this.offset.relative.left*mod+
this.offset.parent.left*mod-
((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod))};},_generatePosition:function(event){var containment,co,top,left,o=this.options,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName),pageX=event.pageX,pageY=event.pageY;if(this.originalPosition){if(this.containment){if(this.relative_container){co=this.relative_container.offset();containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top];}
else{containment=this.containment;}
if(event.pageX-this.offset.click.left<containment[0]){pageX=containment[0]+this.offset.click.left;}
if(event.pageY-this.offset.click.top<containment[1]){pageY=containment[1]+this.offset.click.top;}
if(event.pageX-this.offset.click.left>containment[2]){pageX=containment[2]+this.offset.click.left;}
if(event.pageY-this.offset.click.top>containment[3]){pageY=containment[3]+this.offset.click.top;}}
if(o.grid){top=o.grid[1]?this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY;pageY=containment?((top-this.offset.click.top>=containment[1]||top-this.offset.click.top>containment[3])?top:((top-this.offset.click.top>=containment[1])?top-o.grid[1]:top+o.grid[1])):top;left=o.grid[0]?this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX;pageX=containment?((left-this.offset.click.left>=containment[0]||left-this.offset.click.left>containment[2])?left:((left-this.offset.click.left>=containment[0])?left-o.grid[0]:left+o.grid[0])):left;}}
return{top:(pageY-
this.offset.click.top-
this.offset.relative.top-
this.offset.parent.top+
((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop())))),left:(pageX-
this.offset.click.left-
this.offset.relative.left-
this.offset.parent.left+
((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())))};},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval){this.helper.remove();}
this.helper=null;this.cancelHelperRemoval=false;},_trigger:function(type,event,ui){ui=ui||this._uiHash();$.ui.plugin.call(this,type,[event,ui]);if(type==="drag"){this.positionAbs=this._convertPositionTo("absolute");}
return $.Widget.prototype._trigger.call(this,type,event,ui);},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs};}});$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui){var inst=$(this).data("ui-draggable"),o=inst.options,uiSortable=$.extend({},ui,{item:inst.element});inst.sortables=[];$(o.connectToSortable).each(function(){var sortable=$.data(this,"ui-sortable");if(sortable&&!sortable.options.disabled){inst.sortables.push({instance:sortable,shouldRevert:sortable.options.revert});sortable.refreshPositions();sortable._trigger("activate",event,uiSortable);}});},stop:function(event,ui){var inst=$(this).data("ui-draggable"),uiSortable=$.extend({},ui,{item:inst.element});$.each(inst.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;inst.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=true;}
this.instance._mouseStop(event);this.instance.options.helper=this.instance.options._helper;if(inst.options.helper==="original"){this.instance.currentItem.css({top:"auto",left:"auto"});}}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",event,uiSortable);}});},drag:function(event,ui){var inst=$(this).data("ui-draggable"),that=this;$.each(inst.sortables,function(){var innermostIntersecting=false,thisSortable=this;this.instance.positionAbs=inst.positionAbs;this.instance.helperProportions=inst.helperProportions;this.instance.offset.click=inst.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){innermostIntersecting=true;$.each(inst.sortables,function(){this.instance.positionAbs=inst.positionAbs;this.instance.helperProportions=inst.helperProportions;this.instance.offset.click=inst.offset.click;if(this!==thisSortable&&this.instance._intersectsWith(this.instance.containerCache)&&$.contains(thisSortable.instance.element[0],this.instance.element[0])){innermostIntersecting=false;}
return innermostIntersecting;});}
if(innermostIntersecting){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=$(that).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return ui.helper[0];};event.target=this.instance.currentItem[0];this.instance._mouseCapture(event,true);this.instance._mouseStart(event,true,true);this.instance.offset.click.top=inst.offset.click.top;this.instance.offset.click.left=inst.offset.click.left;this.instance.offset.parent.left-=inst.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=inst.offset.parent.top-this.instance.offset.parent.top;inst._trigger("toSortable",event);inst.dropped=this.instance.element;inst.currentItem=inst.element;this.instance.fromOutside=inst;}
if(this.instance.currentItem){this.instance._mouseDrag(event);}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",event,this.instance._uiHash(this.instance));this.instance._mouseStop(event,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove();}
inst._trigger("fromSortable",event);inst.dropped=false;}}});}});$.ui.plugin.add("draggable","cursor",{start:function(){var t=$("body"),o=$(this).data("ui-draggable").options;if(t.css("cursor")){o._cursor=t.css("cursor");}
t.css("cursor",o.cursor);},stop:function(){var o=$(this).data("ui-draggable").options;if(o._cursor){$("body").css("cursor",o._cursor);}}});$.ui.plugin.add("draggable","opacity",{start:function(event,ui){var t=$(ui.helper),o=$(this).data("ui-draggable").options;if(t.css("opacity")){o._opacity=t.css("opacity");}
t.css("opacity",o.opacity);},stop:function(event,ui){var o=$(this).data("ui-draggable").options;if(o._opacity){$(ui.helper).css("opacity",o._opacity);}}});$.ui.plugin.add("draggable","scroll",{start:function(){var i=$(this).data("ui-draggable");if(i.scrollParent[0]!==document&&i.scrollParent[0].tagName!=="HTML"){i.overflowOffset=i.scrollParent.offset();}},drag:function(event){var i=$(this).data("ui-draggable"),o=i.options,scrolled=false;if(i.scrollParent[0]!==document&&i.scrollParent[0].tagName!=="HTML"){if(!o.axis||o.axis!=="x"){if((i.overflowOffset.top+i.scrollParent[0].offsetHeight)-event.pageY<o.scrollSensitivity){i.scrollParent[0].scrollTop=scrolled=i.scrollParent[0].scrollTop+o.scrollSpeed;}else if(event.pageY-i.overflowOffset.top<o.scrollSensitivity){i.scrollParent[0].scrollTop=scrolled=i.scrollParent[0].scrollTop-o.scrollSpeed;}}
if(!o.axis||o.axis!=="y"){if((i.overflowOffset.left+i.scrollParent[0].offsetWidth)-event.pageX<o.scrollSensitivity){i.scrollParent[0].scrollLeft=scrolled=i.scrollParent[0].scrollLeft+o.scrollSpeed;}else if(event.pageX-i.overflowOffset.left<o.scrollSensitivity){i.scrollParent[0].scrollLeft=scrolled=i.scrollParent[0].scrollLeft-o.scrollSpeed;}}}else{if(!o.axis||o.axis!=="x"){if(event.pageY-$(document).scrollTop()<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed);}else if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed);}}
if(!o.axis||o.axis!=="y"){if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed);}else if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed);}}}
if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(i,event);}}});$.ui.plugin.add("draggable","snap",{start:function(){var i=$(this).data("ui-draggable"),o=i.options;i.snapElements=[];$(o.snap.constructor!==String?(o.snap.items||":data(ui-draggable)"):o.snap).each(function(){var $t=$(this),$o=$t.offset();if(this!==i.element[0]){i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left});}});},drag:function(event,ui){var ts,bs,ls,rs,l,r,t,b,i,first,inst=$(this).data("ui-draggable"),o=inst.options,d=o.snapTolerance,x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(i=inst.snapElements.length-1;i>=0;i--){l=inst.snapElements[i].left;r=l+inst.snapElements[i].width;t=inst.snapElements[i].top;b=t+inst.snapElements[i].height;if(!((l-d<x1&&x1<r+d&&t-d<y1&&y1<b+d)||(l-d<x1&&x1<r+d&&t-d<y2&&y2<b+d)||(l-d<x2&&x2<r+d&&t-d<y1&&y1<b+d)||(l-d<x2&&x2<r+d&&t-d<y2&&y2<b+d))){if(inst.snapElements[i].snapping){(inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})));}
inst.snapElements[i].snapping=false;continue;}
if(o.snapMode!=="inner"){ts=Math.abs(t-y2)<=d;bs=Math.abs(b-y1)<=d;ls=Math.abs(l-x2)<=d;rs=Math.abs(r-x1)<=d;if(ts){ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top-inst.margins.top;}
if(bs){ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top-inst.margins.top;}
if(ls){ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left-inst.margins.left;}
if(rs){ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left-inst.margins.left;}}
first=(ts||bs||ls||rs);if(o.snapMode!=="outer"){ts=Math.abs(t-y1)<=d;bs=Math.abs(b-y2)<=d;ls=Math.abs(l-x1)<=d;rs=Math.abs(r-x2)<=d;if(ts){ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top-inst.margins.top;}
if(bs){ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top-inst.margins.top;}
if(ls){ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left-inst.margins.left;}
if(rs){ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left-inst.margins.left;}}
if(!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)){(inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})));}
inst.snapElements[i].snapping=(ts||bs||ls||rs||first);}}});$.ui.plugin.add("draggable","stack",{start:function(){var min,o=this.data("ui-draggable").options,group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0);});if(!group.length){return;}
min=parseInt($(group[0]).css("zIndex"),10)||0;$(group).each(function(i){$(this).css("zIndex",min+i);});this.css("zIndex",(min+group.length));}});$.ui.plugin.add("draggable","zIndex",{start:function(event,ui){var t=$(ui.helper),o=$(this).data("ui-draggable").options;if(t.css("zIndex")){o._zIndex=t.css("zIndex");}
t.css("zIndex",o.zIndex);},stop:function(event,ui){var o=$(this).data("ui-draggable").options;if(o._zIndex){$(ui.helper).css("zIndex",o._zIndex);}}});})(jQuery);(function($,undefined){function isOverAxis(x,reference,size){return(x>reference)&&(x<(reference+size));}
$.widget("ui.droppable",{version:"1.10.1",widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var o=this.options,accept=o.accept;this.isover=false;this.isout=true;this.accept=$.isFunction(accept)?accept:function(d){return d.is(accept);};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};$.ui.ddmanager.droppables[o.scope]=$.ui.ddmanager.droppables[o.scope]||[];$.ui.ddmanager.droppables[o.scope].push(this);(o.addClasses&&this.element.addClass("ui-droppable"));},_destroy:function(){var i=0,drop=$.ui.ddmanager.droppables[this.options.scope];for(;i<drop.length;i++){if(drop[i]===this){drop.splice(i,1);}}
this.element.removeClass("ui-droppable ui-droppable-disabled");},_setOption:function(key,value){if(key==="accept"){this.accept=$.isFunction(value)?value:function(d){return d.is(value);};}
$.Widget.prototype._setOption.apply(this,arguments);},_activate:function(event){var draggable=$.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass);}
if(draggable){this._trigger("activate",event,this.ui(draggable));}},_deactivate:function(event){var draggable=$.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass);}
if(draggable){this._trigger("deactivate",event,this.ui(draggable));}},_over:function(event){var draggable=$.ui.ddmanager.current;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return;}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass);}
this._trigger("over",event,this.ui(draggable));}},_out:function(event){var draggable=$.ui.ddmanager.current;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return;}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass);}
this._trigger("out",event,this.ui(draggable));}},_drop:function(event,custom){var draggable=custom||$.ui.ddmanager.current,childrenIntersection=false;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return false;}
this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var inst=$.data(this,"ui-droppable");if(inst.options.greedy&&!inst.options.disabled&&inst.options.scope===draggable.options.scope&&inst.accept.call(inst.element[0],(draggable.currentItem||draggable.element))&&$.ui.intersect(draggable,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance)){childrenIntersection=true;return false;}});if(childrenIntersection){return false;}
if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass);}
if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass);}
this._trigger("drop",event,this.ui(draggable));return this.element;}
return false;},ui:function(c){return{draggable:(c.currentItem||c.element),helper:c.helper,position:c.position,offset:c.positionAbs};}});$.ui.intersect=function(draggable,droppable,toleranceMode){if(!droppable.offset){return false;}
var draggableLeft,draggableTop,x1=(draggable.positionAbs||draggable.position.absolute).left,x2=x1+draggable.helperProportions.width,y1=(draggable.positionAbs||draggable.position.absolute).top,y2=y1+draggable.helperProportions.height,l=droppable.offset.left,r=l+droppable.proportions.width,t=droppable.offset.top,b=t+droppable.proportions.height;switch(toleranceMode){case"fit":return(l<=x1&&x2<=r&&t<=y1&&y2<=b);case"intersect":return(l<x1+(draggable.helperProportions.width/2)&&x2-(draggable.helperProportions.width/2)<r&&t<y1+(draggable.helperProportions.height/2)&&y2-(draggable.helperProportions.height/2)<b);case"pointer":draggableLeft=((draggable.positionAbs||draggable.position.absolute).left+(draggable.clickOffset||draggable.offset.click).left);draggableTop=((draggable.positionAbs||draggable.position.absolute).top+(draggable.clickOffset||draggable.offset.click).top);return isOverAxis(draggableTop,t,droppable.proportions.height)&&isOverAxis(draggableLeft,l,droppable.proportions.width);case"touch":return((y1>=t&&y1<=b)||(y2>=t&&y2<=b)||(y1<t&&y2>b))&&((x1>=l&&x1<=r)||(x2>=l&&x2<=r)||(x1<l&&x2>r));default:return false;}};$.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,event){var i,j,m=$.ui.ddmanager.droppables[t.options.scope]||[],type=event?event.type:null,list=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(i=0;i<m.length;i++){if(m[i].options.disabled||(t&&!m[i].accept.call(m[i].element[0],(t.currentItem||t.element)))){continue;}
for(j=0;j<list.length;j++){if(list[j]===m[i].element[0]){m[i].proportions.height=0;continue droppablesLoop;}}
m[i].visible=m[i].element.css("display")!=="none";if(!m[i].visible){continue;}
if(type==="mousedown"){m[i]._activate.call(m[i],event);}
m[i].offset=m[i].element.offset();m[i].proportions={width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight};}},drop:function(draggable,event){var dropped=false;$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(!this.options){return;}
if(!this.options.disabled&&this.visible&&$.ui.intersect(draggable,this,this.options.tolerance)){dropped=this._drop.call(this,event)||dropped;}
if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){this.isout=true;this.isover=false;this._deactivate.call(this,event);}});return dropped;},dragStart:function(draggable,event){draggable.element.parentsUntil("body").bind("scroll.droppable",function(){if(!draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event);}});},drag:function(draggable,event){if(draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event);}
$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return;}
var parentInstance,scope,parent,intersects=$.ui.intersect(draggable,this,this.options.tolerance),c=!intersects&&this.isover?"isout":(intersects&&!this.isover?"isover":null);if(!c){return;}
if(this.options.greedy){scope=this.options.scope;parent=this.element.parents(":data(ui-droppable)").filter(function(){return $.data(this,"ui-droppable").options.scope===scope;});if(parent.length){parentInstance=$.data(parent[0],"ui-droppable");parentInstance.greedyChild=(c==="isover");}}
if(parentInstance&&c==="isover"){parentInstance.isover=false;parentInstance.isout=true;parentInstance._out.call(parentInstance,event);}
this[c]=true;this[c==="isout"?"isover":"isout"]=false;this[c==="isover"?"_over":"_out"].call(this,event);if(parentInstance&&c==="isout"){parentInstance.isout=false;parentInstance.isover=true;parentInstance._over.call(parentInstance,event);}});},dragStop:function(draggable,event){draggable.element.parentsUntil("body").unbind("scroll.droppable");if(!draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event);}}};})(jQuery);var Opacity=$CL.namespace('Cl.Effect.Opacity');Opacity.Opacity=function(){this.isOn=false;this.EL_ID="pageOpacity";this.IMG_ID="bOpLoadImg";this.imgLoadingUrl="/img/loading.gif";this.css={position:"fixed",top:"0px",left:"0px",width:"100%",height:"100%",zIndex:"100000"};this.className=null;};(function(cl){cl.prototype.setup=function(clArgs){cl=this;if($CL.has(clArgs,'className')){cl.className=clArgs.className;}else{if(typeof cl['css']==='undefined'){if(typeof clArgs['css']==='undefined'){$CL.exception('no css proberties provided for opacity div',Cl_Effect_Opacity,clArgs);}
for(var key in clArgs.css){cl.css[key]=clArgs.css[key];}}}
if(typeof clArgs['imgLoadingUrl']!=='undefined'){cl.imgLoadingUrl=clArgs.imgLoadingUrl;}};cl.prototype.on=function(loading){var cl=this;var $opacityDiv=$("<div />").attr({id:cl.EL_ID}).appendTo('body');cl.setStyle($opacityDiv);if(typeof loading!="undefined"&&loading===true){$("<img />").attr({src:cl.imgLoadingUrl,id:cl.IMG_ID}).css({position:"fixed",top:"47%",left:"47%",zIndex:10000}).appendTo("body");}
else{var opacityVal=cl.getOpacityVal($opacityDiv);this.isOn=true;$opacityDiv.css("opacity","0.0").animate({opacity:opacityVal},800);}};cl.prototype.setStyle=function($div){var cl=this;$div.css(cl.css);if(cl.isClassName()){$div.addClass(cl.className);}};cl.prototype.isClassName=function(){return typeof this.className!=='undefined';};cl.prototype.getOpacityVal=function($div){var opacityVal='0.5';if(typeof $div.css('opacity')!=='undefined'){opacityVal=$div.css('opacity');}
return opacityVal;};cl.prototype.off=function(){var c=this;if(typeof $("#"+c.IMG_ID)[0]!="undefined")
$("#"+c.IMG_ID).remove();if(typeof $("#"+c.EL_ID)[0]!="undefined"){$("#"+c.EL_ID).animate({opacity:"0.0"},800,function(){$("#"+c.EL_ID).remove();c.isOn=false;});}};cl.prototype.fastOff=function(){var c=this;if(typeof $("#"+c.EL_ID)[0]!="undefined"){$("#"+c.EL_ID).remove();}}})(Opacity.Opacity);var Opacity=$CL.namespace('Cl.Effect.Opacity');$CL.require('Cl.Effect.Opacity.Opacity');Opacity.Black=function(){this.isOn=false;this.EL_ID="blackOpacity";this.IMG_ID="bOpLoadImg";this.imgLoadingUrl="/img/loading.gif";this.css={position:"fixed",top:"0px",left:"0px",width:"100%",height:"100%",backgroundColor:"#000",opacity:"0.5",zIndex:"10000"};};Opacity.Black=$CL.extendClass(Opacity.Black,Opacity.Opacity);if(typeof $CL.effects!="object")
$CL.effects={};$CL.effects.bOp=new Opacity.Black();var Element=$CL.namespace('Cl.Element');Element.WindowMass=function(){var height=0;var width=0;var $checkDiv=$("<div />").css({position:"absolute",top:"-1px",left:"0px",height:"1px",width:"100%"}).attr({id:"fenster_checkDiv"});$("body").append($checkDiv);width=$("#fenster_checkDiv").width();height=$(window).height();$("#fenster_checkDiv").remove();return{"height":height,"width":width};};var Element=$CL.namespace('Cl.Element');$CL.require('Cl.Element.WindowMass');Element.Center=function(e,scrollVals){if(typeof scrollVals=="undefined")
scrollVals=true;var w={},scroll={};w.height=Cl.Element.WindowMass().height;w.width=Cl.Element.WindowMass().width;scroll.top=$(window).scrollTop();scroll.left=$(window).scrollLeft();var top=parseInt((w.height/2)-($(e).outerHeight()/2));var left=parseInt((w.width/2)-($(e).outerWidth()/2));var dif=0;if($(e).outerHeight()>(w.height-top))
{dif=$(e).outerHeight()-(w.height-top);top=top-dif;}
if($(e).outerWidth()>(w.width-left))
{dif=$(e).outerWidth()-(w.width-left);left=left-dif;}
if(scrollVals){top+=scroll.top;left+=scroll.left;if(top<=scroll.top)
top=scroll.top+10;if(left<=scroll.left)
left=scroll.left+10;}
return{top:top,left:left};}
var Popup=$CL.namespace('Cl.Popup');Popup.Store=function(){this.popups={};this.minimized=0;this.minimizedLayer=1;this.minimizedObjs=[];this.zIndex=10000;};Popup.Store.prototype={addPopup:function(id,ppObj){this.popups[id]=ppObj;},setMinimized:function(num){this.minimized=num;},decreaseMinimized:function(){this.minimized--;},increaseMinimized:function(){this.minimized++;},setMinimizedLayer:function(num){this.minimizedLayer=num;},decreaseMinimizedLayer:function(){this.minimizedLayer--;},increaseMinimizedLayer:function(){this.minimizedLayer++;},addMinimizedObj:function(index,ppObj){this.minimizedObjs[index]=ppObj;this.increaseMinimized();},increaseZIndex:function(){this.zIndex++;}}
var Popup=$CL.namespace('Cl.Popup');$CL.require("Cl.Popup.Store");$CL.require("Cl.Element.Center");$CL.require("Cl.Effect.Opacity.Black");$CL.require("Cl.Jquery.Plugin.Ui.Dragable");$CL.require("Cl.Jquery.Plugin.Css.Size");Popup.Dialog=function(){this.SEL;this.$el;this.clsArgs={};this.store=$CL.get("Cl.Popup.Store");};Popup.Dialog.prototype.setup=function(clsArgs){if(typeof clsArgs.selector=="undefined")
throw new Error("no selector provided for popup");this.SEL=clsArgs.selector;this.$el=$(this.SEL);this.clsArgs=clsArgs;var defs={top:0,left:0,height:0,width:0,minWidth:0,maxWidth:0,overflow:"",bOp:false,title:false,minText:"minimize Window",maxText:"maximize Window",closeText:"close Window",position:"fixed",minimizedIndex:0,isMinimizedObjs:false};$.extend(defs,clsArgs);$.extend(this,defs);this.exists=true;this.status="closed";if(this.bOp)
this.bOp=new Cl.Effect.Opacity.Black();};Popup.Dialog.prototype.initPopup=function(){var c=this;if($(c.SEL).length==0){c.exists=false;}else{$(c.SEL).click(function(e){c.setOnTop();});$(c.SEL).find(".popupMinimize").bind("click",function(e){e.preventDefault();c.store.popups[c.SEL].minimize();});$(c.SEL).find(".popupClose").bind("click",function(e){e.preventDefault();c.store.popups[c.SEL].close();});$(c.SEL).find(".popupMaximize").bind('click',function(e){e.preventDefault();c.store.popups[c.SEL].maximize(true);}).hide();}
c.store.addPopup(c.SEL,c);c.$el=$(c.SEL);c.$el.css(c.filterCss(c.clsArgs));};Popup.Dialog.prototype.filterCss=function(args){var cssObj={};$CL.$.each(args,function(argKey,argValue){switch(argKey){case"width":case"height":case"minWidth":case"maxWidth":case"top":case"left":case"position":case"overflow":cssObj[argKey]=argValue;break;default:}});return cssObj;};Popup.Dialog.prototype.setOnTop=function(){var c=this;c.store.increaseZIndex();c.$el.css("zIndex",c.store.zIndex);};Popup.Dialog.prototype.show=function(args){var c=this;var def={top:false,left:false,e:false,callback:function(){}};$.extend(def,args);function _showPopup(){var scrollVals=(c.$el.css("position")=="absolute")?true:false;if(!def.top)
def.top=Cl.Element.Center(c.$el[0],scrollVals).top;if(!def.left)
def.left=Cl.Element.Center(c.$el[0],scrollVals).left;if(c.$el.css("display")=="none"){if(c.bOp){c.bOp.on();}
var docHeight=$(document).height();c.$el.css({top:def.top,left:def.left}).draggable({handle:".dragBar"}).fadeIn(c.A_SPEED,function(){c.checkViewable(docHeight);def.callback();});return"open";}
else{if(c.bOp){c.bOp.off();}
c.$el.fadeOut(c.A_SPEED,def.callback);return"closed";}};if(def.e){def.e.stopPropagation();}
if(c.exists&&c.status=="closed"){c.setOnTop();c.status=_showPopup();}
else if(c.exists&&c.status=="minimized"){c.maximize(true);}
else if(!c.exists)
throw c.SEL+" PopupObj wurde nicht gefunden!";};Popup.Dialog.prototype.close=function(){this.$el.css("display","none");this.status="closed";if(this.status=="minimized")
this.maximize(false,true);if(this.bOp){this.bOp.off();}};Popup.Dialog.prototype.minimize=function(){var c=this;this.top=parseInt(this.$el.css("top"));this.left=parseInt(this.$el.css("left"));this.width=parseInt(this.$el.fullWidth())+"px";this.minWidth=(parseInt(this.$el.css("minWidth"))>0)?this.$el.css("minWidth"):null;this.maxWidth=(parseInt($("#"+this.idO).css("maxWidth"))>0)?this.$el.css("maxWidth"):null;this.overflow=this.$el.css("overflow");this.position=this.$el.css("position");if(isNaN(parseInt(this.$el.css("width"))))
this.width="auto";this.minimizePosition();var firstDragB=this.$el.find(".dragBar")[0];var firstMinimize=this.$el.find(".popupMinimize")[0];var firstMaximize=this.$el.find(".popupMaximize")[0];var firstClose=this.$el.find(".popupClose")[0];$(firstDragB).css({cursor:"default"});$(firstMinimize).hide();$(firstMaximize).show();$(firstClose).unbind().bind("click",function(e){e.preventDefault();window.setTimeout(function(){c.maximize(false,true);},1000);c.close();});if(this.bOp)
this.bOp.off();this.$el.find(".modal-body").css("display","none");this.$el.find(".modal-footer").css("display","none");var title="";if(this.title){title=this.title;}else{title=this.$el.find(".modal-header h3").html();}
this.$el.find(".modal-header h3").hide();this.$el.find(".modal-header").append($("<span />").html(title).addClass("popupTitle"));this.status="minimized";return false;};Popup.Dialog.prototype.minimizePosition=function(){var c=this;var screenWidth=Cl.Element.WindowMass().width;var popupAnzahl=parseInt(screenWidth/260);var layer=(this.store.minimized>0)?parseInt(this.store.minimized/popupAnzahl):0;var right=(this.store.minimized*200)-(popupAnzahl*layer*200);var bottom=60*layer;this.minimizedIndex=this.store.minimized;this.store.addMinimizedObj(this.minimizedIndex,this);this.isInMinimizedObjs=true;this.$el.css({top:"auto",left:"auto",bottom:bottom+"px",right:right+"px",width:"200px",minWidth:"auto",maxWidth:"auto",overflow:"hidden",position:"fixed",zIndex:10000}).draggable("option","disabled",true);};Popup.Dialog.prototype.maximize=function(setStatus,isClosing){var c=this;if(typeof setStatus=="undefined")
setStatus=true;if(typeof isClosing=="undefined")
isClosing=false;this.orderMinimized();this.setOnTop();var firstDragB=this.$el.find(".dragBar")[0];var firstMinimize=this.$el.find(".popupMinimize")[0];var firstMaximize=this.$el.find(".popupMaximize")[0];var firstClose=this.$el.find(".popupClose")[0];$(firstDragB).css({cursor:"move"});$(firstMinimize).show();$(firstMaximize).hide();$(firstClose).unbind("click").bind("click",function(e){e.preventDefault();window.setTimeout(function(){c.maximize(false,true);},1000);c.close();});this.$el.find(".modal-body").css("display","block");this.$el.find(".modal-footer").css("display","block");this.$el.find(".modal-header .popupTitle").remove();this.$el.find(".modal-header h3").show();if(setStatus){this.status="open";if(this.bOp)
this.bOp.on();}
this.$el.css({top:c.top+"px",left:c.left+"px",bottom:"auto",right:"auto",width:c.width,overflow:c.overflow,position:c.position}).draggable("option","disabled",false);this.$el.css("minWidth",this.minWidth);this.$el.css("maxWidth",this.maxWidth);return false;};Popup.Dialog.prototype.orderMinimized=function(){if(this.isInMinimizedObjs){var i=this.store.minimizedObjs.length-1;var cObj={};var dropedObjs=new Array();for(i;i>=0;i--){cObj=this.store.minimizedObjs[i];if(cObj.minimizedIndex>this.minimizedIndex){dropedObjs[dropedObjs.length]=this.store.minimizedObjs.pop();this.store.decreaseMinimized();}else if(cObj.minimizedIndex==this.minimizedIndex){this.store.minimizedObjs.pop();this.store.decreaseMinimized();this.isInMinimizedObjs=false;}}
var dI=dropedObjs.length-1;for(dI;dI>=0;dI--){dropedObjs[dI].minimizePosition();}}};Popup.Dialog.prototype.isNotOpen=function(){return this.status!="open";};Popup.Dialog.prototype.isInViewport=function(){var viewportTop=$(document).scrollTop();var viewportBottom=viewportTop+$CL.$(window).height();return this.$el.offset().top>=viewportTop&&this.$el.offset().top<=viewportBottom;};Popup.Dialog.prototype.checkViewable=function(docHeight){var c=this;if(typeof docHeight=="undefined")
docHeight=false;if(c.$el.fullHeight()>$(window).height()){if(c.$el.css("position")=="fixed"){c.$el.css("position","absolute");c.position="absolute";c.close();c.show();}}
if(docHeight&&c.position=="absolute"){var ppBottom=c.$el.offset().top+c.$el.fullHeight();if(ppBottom>docHeight){var diff=ppBottom-docHeight;c.$el.css({top:c.$el.offset().top-diff});}}
c.$el.draggable("option","containment","document");};!function($){"use strict";var Modal=function(element,options){this.options=options
this.$element=$(element).delegate('[data-dismiss="modal"]','click.dismiss.modal',$.proxy(this.hide,this))
this.options.remote&&this.$element.find('.modal-body').load(this.options.remote)}
Modal.prototype={constructor:Modal,toggle:function(){return this[!this.isShown?'show':'hide']()},show:function(){var that=this,e=$.Event('show')
this.$element.trigger(e)
if(this.isShown||e.isDefaultPrevented())return
this.isShown=true
this.escape()
this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass('fade')
if(!that.$element.parent().length){that.$element.appendTo(document.body)}
that.$element.show()
if(transition){that.$element[0].offsetWidth}
that.$element.addClass('in').attr('aria-hidden',false)
that.enforceFocus()
transition?that.$element.one($.support.transition.end,function(){that.$element.focus().trigger('shown')}):that.$element.focus().trigger('shown')})},hide:function(e){e&&e.preventDefault()
var that=this
e=$.Event('hide')
this.$element.trigger(e)
if(!this.isShown||e.isDefaultPrevented())return
this.isShown=false
this.escape()
$(document).off('focusin.modal')
this.$element.removeClass('in').attr('aria-hidden',true)
$.support.transition&&this.$element.hasClass('fade')?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var that=this
$(document).on('focusin.modal',function(e){if(that.$element[0]!==e.target&&!that.$element.has(e.target).length){that.$element.focus()}})},escape:function(){var that=this
if(this.isShown&&this.options.keyboard){this.$element.on('keyup.dismiss.modal',function(e){e.which==27&&that.hide()})}else if(!this.isShown){this.$element.off('keyup.dismiss.modal')}},hideWithTransition:function(){var that=this,timeout=setTimeout(function(){that.$element.off($.support.transition.end)
that.hideModal()},500)
this.$element.one($.support.transition.end,function(){clearTimeout(timeout)
that.hideModal()})},hideModal:function(that){this.$element.hide().trigger('hidden')
this.backdrop()},removeBackdrop:function(){this.$backdrop.remove()
this.$backdrop=null},backdrop:function(callback){var that=this,animate=this.$element.hasClass('fade')?'fade':''
if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate
this.$backdrop=$('<div class="modal-backdrop '+animate+'" />').appendTo(document.body)
this.$backdrop.click(this.options.backdrop=='static'?$.proxy(this.$element[0].focus,this.$element[0]):$.proxy(this.hide,this))
if(doAnimate)this.$backdrop[0].offsetWidth
this.$backdrop.addClass('in')
doAnimate?this.$backdrop.one($.support.transition.end,callback):callback()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass('in')
$.support.transition&&this.$element.hasClass('fade')?this.$backdrop.one($.support.transition.end,$.proxy(this.removeBackdrop,this)):this.removeBackdrop()}else if(callback){callback()}}}
var old=$.fn.modal
$.fn.modal=function(option){return this.each(function(){var $this=$(this),data=$this.data('modal'),options=$.extend({},$.fn.modal.defaults,$this.data(),typeof option=='object'&&option)
if(!data)$this.data('modal',(data=new Modal(this,options)))
if(typeof option=='string')data[option]()
else if(options.show)data.show()})}
$.fn.modal.defaults={backdrop:true,keyboard:true,show:true}
$.fn.modal.Constructor=Modal
$.fn.modal.noConflict=function(){$.fn.modal=old
return this}
$(document).on('click.modal.data-api','[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr('href'),$target=$($this.attr('data-target')||(href&&href.replace(/.*(?=#[^\s]+$)/,''))),option=$target.data('modal')?'toggle':$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data())
e.preventDefault()
$target.modal(option).one('hide',function(){$this.focus()})})}(window.jQuery);var Configuration=$CL.namespace('Ginger.Jobs.View.Configuration');$CL.require('Cl.Backbone.View');$CL.require('Cl.Bootstrap.Modal');$CL.require('Cl.Popup.Dialog');Configuration.Footer=function(){};Configuration.Footer=$CL.extendClass(Configuration.Footer,Cl.Backbone.View,{saveEnabled:false,importModal:null,events:{'click .js-btn-save':'onSaveClick','click .js-btn-cancel':'onCancelClick','click .js-btn-export':'onExportClick','click .js-btn-import':'onImportClick','click .js-perform-import':'onPerformImportClick','click .js-cancel-import':'onCancelImportClick','click #import-search-btn':'onImportSearchClick','change input[name=import-file]':'onImportFileChange'},render:function(){this.parent.prototype.render.apply(this);if(!this.saveEnabled){this.disableSave();}
this.importModal=$CL.makeObj('Cl.Popup.Dialog',{selector:'#configurationImportModal'});this.importModal.initPopup();},onSaveClick:function(){if(!this.$el.find('.js-btn-save').hasClass('disabled')){this.trigger('save');}},onCancelClick:function(){this.trigger('cancel');},onImportSearchClick:function(){this.$el.find('input[name=import-file]').trigger('click');},onImportFileChange:function(e){var file=$(e.target).val().split('\\').pop();this.$el.find('#import-file-name-label').html(file);},onExportClick:function(){this.trigger('export');},onImportClick:function(){this.importModal.show();},onCancelImportClick:function(e){e.preventDefault();this.importModal.close();},onPerformImportClick:function(e){e.preventDefault();this.$el.find('form[name=js-import]').submit();$('#import-response').load($CL.bind(function(){this.importModal.close();var config=$.parseJSON($('#import-response').contents().find('body textarea').html());this.trigger('import',config);},this));},enableSave:function(){this.saveEnabled=true;this.$el.find('.js-btn-save').removeClass('disabled');},disableSave:function(){this.saveEnabled=false;this.$el.find('.js-btn-save').addClass('disabled');},showSavedSuccessful:function(){this.$el.find('.alert-success').removeClass('hide');window.setTimeout($CL.bind(function(){this.$el.find('.alert-success').addClass('hide');},this),3000);}});(function($,undefined){$.fn.extend({clickableSort:function(options){var _sorted=options&&options.sorted?options.sorted:function(){};this.children().addClass('ui-sort-item');if(options&&options.cancel){this.children().filter(options.cancel).removeClass('ui-sort-item');}
this.find('.js-sort-up').bind('click.clickableSort',$.proxy(function(e){e.preventDefault();var $target=$(e.target).hasClass('ui-sort-item')?$(e.target):$(e.target).parents('.ui-sort-item');if(this.find('.ui-sort-item').first()[0]!=$target[0]){var $prev=$target.prev('.ui-sort-item');$prev.before($target);_sorted($target);}},this));this.find('.js-sort-down').bind('click.clickableSort',$.proxy(function(e){e.preventDefault();var $target=$(e.target).hasClass('ui-sort-item')?$(e.target):$(e.target).parents('.ui-sort-item');if(this.find('.ui-sort-item').last()[0]!=$target[0]){var $next=$target.next('.ui-sort-item');$next.after($target);_sorted($target);}},this));}});})(jQuery);var Configuration=$CL.namespace('Ginger.Jobs.View.Configuration');$CL.require('Cl.Backbone.View');$CL.require('Cl.Jquery.Plugin.ClickableSort');Configuration.Sidebar=function(){};Configuration.Sidebar=$CL.extendClass(Configuration.Sidebar,Cl.Backbone.View,{featureCollection:null,elementLoader:null,activatedFeatures:null,activeFeature:null,activeFeatureData:null,activeFeatureView:null,activeFeatureHelpView:null,isEnabled:false,editFeatureId:-1,mainEditView:null,setElementLoader:function(elementLoader){this.elementLoader=elementLoader;},setMainEditView:function(editView){this.mainEditView=editView;},events:{'click .js-add-feature':'onAddFeatureClick','change select[name=js-feature-filter]':'onFeatureFilterChange','change select[name=feature-edit]':'onFeatureEditChange','click .feature-tab .js-btn-next':'onNextClick','click .feature-tab .js-btn-cancel':'onCancelClick','click .feature-tab .js-btn-save':'onSaveClick','click .activated-feature .js-edit':'onEditFeatureClick','click .activated-feature .js-remove':'onRemoveFeatureClick'},render:function(){this.data.isEnabled=this.isEnabled;this.parent.prototype.render.apply(this);this.activatedFeatures=[];this.editFeatureId=-1;if(this.data.config&&this.data.config.features){_.each(this.data.config.features,function(featureData){this.activatedFeatures.push({elementData:featureData,options:featureData.options});},this);this._renderActivatedFeatures();}},setElement:function(){this.parent.prototype.setElement.apply(this,arguments);this.isEnabled=false;},setFeatureCollection:function(featureCollection){this.featureCollection=featureCollection;},onConfigSave:function(configData){configData['features']=[];if(this.activatedFeatures&&this.activatedFeatures.length>0){$('#activated-features .ui-sort-item').each($CL.bind(function(i,row){var featureId=$(row).find('.js-edit').data('id');$CL.log(featureId);var featureData=this._getFeatureData(featureId);configData['features'].push({id:featureData.elementData.id,options:featureData.elementData.options});},this));}},onEnableFeatures:function(){var $area=this.$el.find('#js-feature-area');this.isEnabled=true;if($area.hasClass('disabled')){$area.removeClass('disabled');$area.find('legend').removeClass('muted');$area.find('.js-add-feature').removeClass('disabled');}},onDisableFeatures:function(){var $area=this.$el.find('#js-feature-area');this.isEnabled=false;$area.addClass('disabled').find('legend').addClass('muted');$area.find('.js-add-feature').addClass('disabled');},onNextClick:function(){var $sel=this.$el.find('select[name=feature-edit]');if($sel.val()=="none"){$sel.parent().addClass('error');}else{this.$el.find('.feature-tab').addClass('hide').filter('.js-feature-options').removeClass('hide');}},onCancelClick:function(){this.editFeatureId=-1;this.$el.find('.feature-tab').addClass('hide').filter('.activated-features').removeClass('hide');},onSaveClick:function(){if(this.activeFeature){var options=this.activeFeature.collectOptions(),featureId=this.$el.find('select[name=feature-edit]').val();if(!options){return;}
var feature=this.featureCollection.findWhere({id:parseInt(featureId)});if(this.editFeatureId>-1){this._replaceEditedFeature(feature,options);}else{this._activateFeature(feature,options);}
this.$el.find('.feature-tab .js-btn-cancel').first().click();}},onEditFeatureClick:function(e){e.preventDefault();var $a=$CL.jTarget(e.target,'a'),elementData=this._getFeatureData($a.data('id')).elementData,_processFeatureData=$CL.bind(function(){this.processFeatureData(elementData);this._fillFeatureSelect('all');this.$el.find('select[name=feature-edit]').val(elementData.id);this.$el.find('.feature-tab .js-btn-next').click();},this);this.editFeatureId=$a.data('id');if(this.featureCollection.isEmpty()){$CL.app().wait();this.featureCollection.fetch({success:$CL.bind(function(){$CL.app().stopWait();_processFeatureData();},this),error:function(col,jqX){$CL.app().stopWait().alert("Failed fetching data for features. Server Response: "+jqX.responseText);}});return;}
_processFeatureData();},onRemoveFeatureClick:function(e){e.preventDefault();var $a=$CL.jTarget(e.target,'a');this._deactivateFeature($a.data('id'));},processFeatureData:function(elementData){this.elementLoader.loadElement(elementData,$CL.bind(function(element){if(!_.isNull(this.activeFeature)){if(this.activeFeatureView){this.activeFeatureView.undelegateEvents();}
this.$el.find('.js-feature-options .js-feature-options-container').html('');if(this.activeFeatureHelpView){this.activeFeatureHelpView.undelegateEvents();}}
this.$el.find('#feature-help-con').html('').parent().addClass('hide');this.activeFeature=element;this.activeFeatureData=elementData;this.activeFeatureView=element.getOptionsView(elementData);if(this.activeFeatureView){this.activeFeatureView.setElement(this.$el.find('.js-feature-options .js-feature-options-container'));if($CL.has(this.activeFeatureView,'setMainEditView')){this.activeFeatureView.setMainEditView(this.mainEditView);}
this.activeFeatureView.render();}
this.activeFeatureHelpView=element.getHelpView(elementData);if(this.activeFeatureHelpView){this.activeFeatureHelpView.setElement(this.$el.find('#feature-help-con'));this.activeFeatureHelpView.render();this.$el.find('#feature-help-con').parent().removeClass('hide');}},this));},onAddFeatureClick:function(e){e.preventDefault();var $a=$CL.jTarget(e.target,'a'),_processFeatureDialog=$CL.bind(function(){this._showFeatureEdit({feature_type:'all',feature_data:{}});},this);if(!$a.hasClass('disabled')){if(this.featureCollection.isEmpty()){$CL.app().wait();this.featureCollection.fetch({success:$CL.bind(function(){$CL.app().stopWait();_processFeatureDialog();},this),error:function(col,jqX){$CL.app().stopWait().alert("Failed fetching data for features. Server Response: "+jqX.responseText);}});return;}
_processFeatureDialog();}},onFeatureFilterChange:function(e){this._fillFeatureSelect($(e.target).val());},onFeatureEditChange:function(e){var $sel=$(e.target);if($sel.val()!="none"){$sel.parent().removeClass('error');var feature=this.featureCollection.findWhere({id:parseInt($sel.val())});this.processFeatureData(feature.toJSON());}else{this._removeActiveFeature();}},_removeActiveFeature:function(){this.activeFeature=null;this.activeFeatureData=null;if(!_.isNull(this.activeFeatureView)){this.activeFeatureView.undelegateEvents();}
this.activeFeatureView=null;if(!_.isNull(this.activeFeatureHelpView)){this.activeFeatureHelpView.undelegateEvents();}
this.activeFeatureHelpView=null;this.$el.find('.js-feature-options .js-feature-options-container').html('');},_showFeatureEdit:function(options){this._removeActiveFeature();this.$el.find('select[name=js-feature-filter]').val(options.feature_type);this._fillFeatureSelect(options.feature_type);this.$el.find('.feature-tab').addClass('hide').filter('.add-feature').removeClass('hide');},_fillFeatureSelect:function(featureType){this.$el.find('select[name=feature-edit]').find(':not(.intro-option)').remove();var features=$CL.clone(this.featureCollection.toJSON());if(featureType!='all'){features=_.where(features,{type:featureType});}
_.each(features,function(feature){$('select[name=feature-edit]').append($('<option />').attr('value',feature.id).html(feature.module+'::'+feature.name));});},_activateFeature:function(feature,options){if(_.isNull(this.activatedFeatures)){this.activatedFeatures=[];}
var elementData=feature.toJSON();elementData.options=$CL.clone(options);this.activatedFeatures.push({elementData:elementData});this._renderActivatedFeatures();},_deactivateFeature:function(featureId){var removedFeature=this._getFeatureData(featureId);this.activatedFeatures=_.without(this.activatedFeatures,removedFeature);this._renderActivatedFeatures();},_replaceEditedFeature:function(feature,options){var featureData=this._getFeatureData(feature.get('id'));featureData.elementData=feature.toJSON();featureData.elementData.options=options;this.editFeatureId=-1;},_renderActivatedFeatures:function(){$('#activated-features').find('.ts-tr').filter(':not(.js-default-row)').remove();var $copyTr=$('#activated-features').find('.js-copy-row');if(this.activatedFeatures.length==0){$('#activated-features').find('.js-th').addClass('hide');}else{$('#activated-features').find('.js-th').removeClass('hide');$.each(this.activatedFeatures,$CL.bind(function(i,activatedFeatureData){var $newTr=$copyTr.clone();$newTr.removeClass('hide js-copy-row js-default-row').addClass('activated-feature').children().first().html(helpers.wrapVisibleSpans(activatedFeatureData.elementData.module+"::"
+activatedFeatureData.elementData.name,'::'));$newTr.children().last().html($CL._template('application_edit_remove')({id:activatedFeatureData.elementData.id,showSort:true}));$('#activated-features .ts-tr').last().after($newTr);},this));$('#activated-features .span12').clickableSort({cancel:'.js-default-row'});}},_getFeatureData:function(featureId){return _.find(this.activatedFeatures,function(feature){return feature.elementData.id==featureId;});}});var Configuration=$CL.namespace('Ginger.Jobs.View.Configuration');$CL.require('Cl.Backbone.View');$CL.require('Cl.Bootstrap.Modal');$CL.require('Cl.Popup.Dialog');Configuration.Edit=function(){};Configuration.Edit=$CL.extendClass(Configuration.Edit,Cl.Backbone.View,{jobName:null,elementLoader:null,footer:null,sidebar:null,activeSource:null,activeSourceData:null,activeSourceView:null,activeSourceHelpView:null,activeTarget:null,activeTargetData:null,activeTargetView:null,activeTargetHelpView:null,activeMapper:null,activeMapperData:null,activeMapperView:null,activeMapperHelpView:null,canRefreshMapper:true,sourceModal:null,targetModal:null,setElementLoader:function(elementLoader){this.elementLoader=elementLoader;},setJobName:function(jobName){this.jobName=jobName;},setFooter:function(footer){this.footer=footer;},setSidebar:function(sidebar){this.sidebar=sidebar;},events:{'change select[name=source]':'onSourceChange','click #js-source-question':'onSourceQuestionClick','click #js-source-options-btn':'onSourceOptionsClick','change select[name=target]':'onTargetChange','click #js-target-question':'onTargetQuestionClick','click #js-target-options-btn':'onTargetOptionsClick'},render:function(){this.parent.prototype.render.apply(this);this.reset();if($CL.isDefined(this.data['config'])){this.provideConfigToElements();}
if(!_.isNull(this.activeSourceData)){this.$el.find('select[name=source]').val(this.activeSourceData.id);this.$el.find('select[name=target]').val(this.activeTargetData.id);this.processSourceData(this.activeSourceData);}
if(_.isNull(this.sourceModal)){this.sourceModal=$CL.makeObj('Cl.Popup.Dialog',{selector:'#sourceModal'});}
this.sourceModal.initPopup();if(_.isNull(this.targetModal)){this.targetModal=$CL.makeObj('Cl.Popup.Dialog',{selector:'#targetModal'});}
this.targetModal.initPopup();this._enableAreas();},reset:function(){this.activeSource=null;this.activeSourceData=null;this.activeSourceView=null;this.activeSourceHelpView=null;this.activeTarget=null;this.activeTargetData=null;this.activeTargetView=null;this.activeTargetHelpView=null;this.activeMapper=null;this.activeMapperData=null;this.activeMapperView=null;this.activeMapperHelpView=null;this.canRefreshMapper=true;},resetMapperOptions:function(){this.canRefreshMapper=true;if($CL.isDefined(this.data['config'])&&$CL.isDefined(this.data.config['mapper'])){this.data.config.mapper.options={};var elementData=_.findWhere(this.data.mappers,{name:this.data.config.mapper.name});elementData.options={};}},refreshMapper:function(){if(this.activeSourceData.data_type==0&&this.activeTargetData.data_type==0){this._disableMapper();}else{this.canRefreshMapper=true;this._enableMapper();}},provideConfigToElements:function(){this.activeSourceData=_.findWhere(this.data.sources,{id:parseInt(this.data.config.source.id)});this.activeSourceData.options=this.data.config.source.options;this.activeTargetData=_.findWhere(this.data.targets,{id:parseInt(this.data.config.target.id)});this.activeTargetData.options=this.data.config.target.options;if($CL.isDefined(this.data.config['mapper'])){var elementData=_.findWhere(this.data.mappers,{name:this.data.config.mapper.name});elementData.options=this.data.config.mapper.options;}},processSourceData:function(elementData){this.elementLoader.loadElement(elementData,$CL.bind(function(element){this._hideSourceViews();if(!_.isNull(this.activeSource)){if(this.activeSourceView){this.activeSourceView.undelegateEvents();}
this.$el.find('#js-source-options').html('');}
this.activeSource=element;this.activeSourceData=elementData;this.activeSourceView=element.getOptionsView(elementData);if(this.activeSourceView){this.activeSourceView.setElement(this.$el.find('#js-source-options'));if($CL.has(this.activeSourceView,"setMainEditView")){this.activeSourceView.setMainEditView(this);}
this.activeSourceView.render();$('#js-source-options-btn').removeClass('disabled');}
this.activeSourceHelpView=element.getHelpView(elementData);if(!_.isNull(this.activeSourceHelpView)){$('#js-source-question').removeClass('hide');}
this._enableAreas();},this));},processTargetData:function(elementData){this.elementLoader.loadElement(elementData,$CL.bind(function(element){this._hideTargetViews();if(!_.isNull(this.activeTarget)){if(this.activeTargetView){this.activeTargetView.undelegateEvents();}
this.$el.find('#js-target-options').html('');}
this.activeTarget=element;this.activeTargetData=elementData;this.activeTargetView=element.getOptionsView(elementData);if(this.activeTargetView){this.activeTargetView.setElement(this.$el.find('#js-target-options'));if($CL.has(this.activeTargetView,"setMainEditView")){this.activeTargetView.setMainEditView(this);}
this.activeTargetView.render();$('#js-target-options-btn').removeClass('disabled');}
this.activeTargetHelpView=element.getHelpView(elementData);this._enableAreas();},this));},onConfigSave:function(){var sourceId=$('select[name=source]').val(),targetId=$('select[name=target]').val(),mapperId=this.activeMapper?this.activeMapperData.id:null,sourceOptions={},targetOptions={},mapperOptions={};if(this.activeSource){var result=this.activeSource.collectOptions();if(result===false){return;}
sourceOptions=result;}
if(this.activeTarget){var result=this.activeTarget.collectOptions();if(result===false){return;}
targetOptions=result;}
if(this.activeMapper){var result=this.activeMapper.collectOptions();if(result===false){return;}
mapperOptions=result;}
var configData={source:{id:sourceId,options:sourceOptions},target:{id:targetId,options:targetOptions}};if(!_.isNull(mapperId)){configData['mapper']={id:mapperId,options:mapperOptions};}
if($CL.isDefined(this.data['config'])){configData['id']=this.data.config.id;}
this.trigger('config-save',configData);$CL.app().router.forward('jobs_configuration_save',{jobname:this.jobName,config:configData,callback:$CL.bind(function(configModel){this.data.config=configModel.toJSON();this.provideConfigToElements();this.footer.showSavedSuccessful();$CL.app().router.navigate(helpers.uri('jobs_configuration_edit',{jobname:this.jobName,id:this.data.config.id}),{replace:true});this.trigger('config-save-post',this.data.config);},this)});},onConfigCancel:function(){$CL.app().router.callRoute('jobs_job_edit',{name:this.jobName});},onConfigExport:function(){if($CL.isDefined(this.data['config'])){$CL.setUri('/export/configuration/'+this.jobName+'/'+this.data.config.id);}else{var savePostListener=$CL.bind(function(config){$CL.setUri('/export/configuration/'+this.jobName+'/'+config.id);},this);this.on('config-save-post',function(config){savePostListener(config);this.off(savePostListener);},this);this.onConfigSave();}},onConfigImport:function(config){if($CL.isDefined(this.data['config'])){config['id']=this.data.config.id;}
$CL.app().router.forward('jobs_configuration_save',{jobname:this.jobName,config:config,callback:$CL.bind(function(configModel){$CL.app().router.navigate('placebo');$CL.app().router.callRoute('jobs_configuration_edit',{jobname:this.jobName,id:configModel.get('id')});},this)});},onSourceQuestionClick:function(e){e.preventDefault();this.sourceModal.show();this.activeSourceHelpView.setElement($('#sourceModal').find('.modal-body')[0]);this.activeSourceHelpView.render();},onSourceOptionsClick:function(e){var $btn=$CL.jTarget(e.target,'button');if(!$btn.hasClass('disabled')){$btn.toggleClass('active');if($btn.hasClass('active')){$('#js-source-options').position({my:'left top',at:'left bottom',of:'#js-source-area'});$('#js-source-options').width($('#js-source-area').width()).removeClass('hide').slideDown(400);}else{$('#js-source-options').slideUp(400,function(){$('#js-source-options').addClass('hide');});}}},onSourceChange:function(e){var $sel=$(e.target);var elementData=_.findWhere(this.data.sources,{id:parseInt($sel.val())});this.resetMapperOptions();if(elementData){this.processSourceData(elementData);}else{this.activeSourceData=null;this.activeSource=null;this.activeSourceView=null;this.activeSourceHelpView=null;this._hideSourceViews();this._disableAreas();}},onTargetQuestionClick:function(e){e.preventDefault();this.targetModal.show();this.activeTargetHelpView.setElement($('#targetModal').find('.modal-body')[0]);this.activeTargetHelpView.render();},onTargetOptionsClick:function(e){var $btn=$CL.jTarget(e.target,'button');if(!$btn.hasClass('disabled')){$btn.toggleClass('active');if($btn.hasClass('active')){$('#js-target-options').position({my:'left top',at:'left bottom',of:'#js-source-area'});$('#js-target-options').width($('#js-target-area').width()).removeClass('hide').slideDown(400);}else{$('#js-target-options').slideUp(400,function(){$('#js-target-options').addClass('hide');});}}},onTargetChange:function(e){var $sel=$(e.target);var elementData=_.findWhere(this.data.targets,{id:parseInt($sel.val())});this.resetMapperOptions();if(elementData){this.processTargetData(elementData);}else{this.activeTargetData=null;this.activeTarget=null;this.activeTargetView=null;this.activeTargetHelpView=null;this._hideTargetViews();this._disableAreas();}},_enableAreas:function(){if(!_.isNull(this.activeSource)&&!_.isNull(this.activeTarget)){this._enableSave();this._enableMapper();}
if(!_.isNull(this.activeSource)){this._enableTarget();}
if(!_.isNull(this.activeSource)||!_.isNull(this.activeTarget)){this._enableFeatures();}},_disableAreas:function(){if(_.isNull(this.activeSource)||_.isNull(this.activeTarget)){this._disableMapper();this._disableSave();}
if(_.isNull(this.activeSource)){this._disableTarget();}
if(_.isNull(this.activeSource)&&_.isNull(this.activeTarget)){this._disableFeatures();}},_enableTarget:function(){var $area=this.$el.find('#js-target-area');if($area.hasClass('disabled')){$area.removeClass('disabled');$area.find('legend').removeClass('muted');var targetId=$area.find('select').removeAttr('disabled').val();var targetData=_.findWhere(this.data.targets,{id:parseInt(targetId)});if(targetData){this.processTargetData(targetData);}}
if(!_.isNull(this.activeTargetView)){$('#js-target-options-btn').removeClass('disabled');}
if(!_.isNull(this.activeTargetHelpView)){$('#js-target-question').removeClass('hide');}},_disableTarget:function(){var $area=this.$el.find('#js-target-area');$area.addClass('disabled').find('legend').addClass('muted');$area.find('select').attr({disabled:true});this._hideTargetViews();},_enableFeatures:function(){this.trigger('enableFeatures');},_disableFeatures:function(){this.trigger('disableFeatures');},_enableMapper:function(){var mapperName=null;if(this.activeSourceData.data_type==1&&this.activeTargetData.data_type==1){mapperName="TableStructureMapper";}else if(this.activeSourceData.data_type!=0&&this.activeTargetData.data_type!=0){mapperName="DocumentStructureMapper";}
var elementData=_.findWhere(this.data.mappers,{name:mapperName});if(elementData){this.elementLoader.loadElement(elementData,$CL.bind(function(element){if(!_.isNull(this.activeMapper)&&this.activeMapper!=element){if(this.activeMapperView){this.activeMapperView.undelegateEvents();}
this.$el.find('#js-mapper-options').html('');}else{if(!this.canRefreshMapper){return;}}
this.activeMapper=element;this.canRefreshMapper=false;if($CL.isDefined(this.data['config'])){if($CL.has(this.activeMapper,"setJobname")){this.activeMapper.setJobname(this.data.config.job.name);}
if($CL.has(this.activeMapper,"setConfigurationId")){this.activeMapper.setConfigurationId(this.data.config.id);}}else{this.activeMapper.setJobname(null);this.activeMapper.setConfigurationId(null);}
this.activeMapperData=elementData;this.activeMapperView=element.getOptionsView(elementData);if(this.activeMapperView){this.activeMapperView.setElement(this.$el.find('#js-mapper-options'));if($CL.has(this.activeMapperView,"setMainEditView")){this.activeMapperView.setMainEditView(this);}
this.activeMapperView.render();}},this));}},_disableMapper:function(){this.activeMapperData=null;this.activeMapper=null;this.activeMapperView=null;$('#js-mapper-options').html('');},_enableSave:function(){this.footer.enableSave();},_disableSave:function(){this.footer.disableSave();},_hideSourceViews:function(){$('#js-source-question').addClass('hide');$('#js-source-options').addClass('hide');$('#js-source-options-btn').addClass('disabled');$('#js-source-options-btn').removeClass('active');},_hideTargetViews:function(){$('#js-target-question').addClass('hide');$('#js-target-options').addClass('hide');$('#js-target-options-btn').addClass('disabled');$('#js-target-options-btn').removeClass('active');}});var Partial=$CL.namespace('Ginger.Jobs.View.Index.Partial');$CL.require('Cl.Backbone.View');Partial.JobSidebar=function(){};Partial.JobSidebar=$CL.extendClass(Partial.JobSidebar,Cl.Backbone.View,{events:{'click label[for=job-edit]':'onJobEditClick'},onJobEditClick:function(e){e.preventDefault();var $a=$CL.jTarget(e.target,'label').find('.js-edit');$CL.app().router.callRoute('jobs_job_edit',{name:$a.data('id')});},render:function(){this.parent.prototype.render.apply(this);var editSidebar=$CL.get('Ginger.Jobs.View.Index.Partial.EditSidebar');editSidebar.setElement($('#js-edit-sidebar'));editSidebar.setData(_.extend({showAlways:true},this.data));editSidebar.render();}});var Partial=$CL.namespace('Ginger.Jobs.View.Index.Partial');$CL.require('Cl.Backbone.View');Partial.EditSidebar=function(){};Partial.EditSidebar=$CL.extendClass(Partial.EditSidebar,Cl.Backbone.View,{events:{'click #job-starter':'onStartJobClick'},onStartJobClick:function(e){e.preventDefault();$CL.app().router.forward('jobs_jobrun_start',{jobname:this.data.name});}});var Index=$CL.namespace('Ginger.Jobs.View.Index');$CL.require('Cl.Backbone.View');Index.Edit=function(){};Index.Edit=$CL.extendClass(Index.Edit,Cl.Backbone.View,{events:{'click .js-add-configuration':'onConfigAddClick','click .js-configuration .js-edit':'onConfigEditClick','click .js-configuration .js-remove':'onConfigRemoveClick','click label[for=break_on_failure]':'onBreakOnFailureClick','click .js-save-btn':'onSaveClick','click .js-remove-job-btn':'onRemoveJobClick'},onConfigAddClick:function(e){$CL.app().router.forward('jobs_job_save',{jobname:this.data.name,jobData:this._getJobData()});},onConfigEditClick:function(e){e.preventDefault();var $a=$CL.jTarget(e.target,'a');$CL.app().router.forward('jobs_job_save',{jobname:this.data.name,jobData:this._getJobData()});$CL.app().router.callRoute('jobs_configuration_edit',{jobname:this.data.name,id:$a.data('id')});},onConfigRemoveClick:function(e){e.preventDefault();var $a=$CL.jTarget(e.target,'a');$CL.app().router.forward('jobs_configuration_remove',{jobname:this.data.name,id:$a.data('id')});$a.parents('.ts-tr').remove();},onBreakOnFailureClick:function(e){var $label=$CL.jTarget(e.target,'label');$label.find('input').attr('checked','checked');},onSaveClick:function(e){e.preventDefault();$CL.app().router.forward('jobs_job_save',{jobname:this.data.name,jobData:this._getJobData(),callback:$CL.bind(function(){$CL.app().router.callRoute('jobs_job',{name:this.data.name});},this)});},onRemoveJobClick:function(e){$CL.app().router.forward('jobs_job_remove',{jobname:this.data.name,callback:$CL.bind(function(){$CL.app().router.callRoute('jobs_overview');},this)});},_getJobData:function(){return{description:this.$el.find('textarea[name=description]').val(),break_on_failure:this.$el.find('input[name=break_on_failure]').filter(':checked').val()};}});var View=$CL.namespace('Cl.Form.View');$CL.require('Cl.Form.View.ErrorUl');View.Textarea={print:function(element,errors,displayErrorMsgs){var html="";if(!$CL.isDefined(displayErrorMsgs)){displayErrorMsgs=true;}
if(displayErrorMsgs){html+=Cl.Form.View.ErrorUl.print(errors,element.getName());}
if(!_.isNull(element.getLabel())){html+='<label for="'+element.getName()+'"><span>'+element.getLabel()+'&nbsp;</span></label>';}
html+='<textarea name="'+element.getName()+'" type="text" ';html+=($CL.isDefined(errors[element.getName()]))?'class="'+element.errorClass+'"':'';html+='>'+_.escape(element.getValue())+'</textarea>';return html;}};var Index=$CL.namespace('Ginger.Jobs.View.Index');$CL.require('Cl.Backbone.FormView');$CL.require('Cl.Form.View.InputText');$CL.require('Cl.Form.View.Textarea');Index.AddJobForm=function(){};Index.AddJobForm=$CL.extendClass(Index.AddJobForm,Cl.Backbone.FormView);var Index=$CL.namespace('Ginger.Jobs.View.Index');$CL.require('Cl.Backbone.View');Index.Job=function(){};Index.Job=$CL.extendClass(Index.Job,Cl.Backbone.View,{events:{'click .js-jobrun-row .js-show-details':'onShowDetailsClick','click .js-jobrun-details .js-remove':'onRemoveJobrunClick'},onShowDetailsClick:function(e){e.preventDefault();var $a=$CL.jTarget(e.target,'a'),$details=$a.parents('.js-jobrun-row').next();if($details.hasClass('hide')){$a.find('i').removeClass('icon-arrow-down').addClass('icon-arrow-up');$details.slideDown().removeClass('hide');}else{$a.find('i').removeClass('icon-arrow-up').addClass('icon-arrow-down');$details.slideUp().addClass('hide');}},onRemoveJobrunClick:function(e){e.preventDefault();var $a=$CL.jTarget(e.target,'a');$CL.app().router.forward('jobs_jobrun_remove',{jobname:this.data.name,id:$a.data('id'),callback:$CL.bind(function(){$CL.app().router.forward('jobs_job',{name:this.data.name});},this)});}});var Index=$CL.namespace('Ginger.Jobs.View.Index');$CL.require('Cl.Backbone.View');Index.Index=function(){};Index.Index=$CL.extendClass(Index.Index,Cl.Backbone.View);var Controller=$CL.namespace("Ginger.Jobs.Controller");$CL.require("Cl.Application.Mvc.AbstractController");$CL.require("Ginger.Jobs.Collection.Jobs");$CL.require("Ginger.Jobs.Entity.Job");Controller.Jobrun=function(){};Controller.Jobrun=$CL.extendClass(Controller.Jobrun,Cl.Application.Mvc.AbstractController,{jobCollection:null,setJobCollection:function(jobCollection){this.jobCollection=jobCollection;},showAction:function(){var jobname=this.getMvcEvent().getRouteMatch().getParam('jobname',''),runId=this.getMvcEvent().getRouteMatch().getParam('id',-1),_processJob=$CL.bind(function(job){if(!job){$CL.app().stopWait().alert('The job ":jobname" is not present in the job collection'.replace(':jobname',jobname));return;}
var _finish=$CL.bind(function(job){var jobrun=job.get('jobruns').get(runId);if(!jobrun){$CL.app().alert('Jobrun with id ":id" can not be found.'.replace(':id',runId));return;}
this._addBreadcrumbs(jobname,helpers.datetime(jobrun.get('startTime')));return $CL.get('Ginger.Jobs.View.Jobrun.Show').setData(_.extend({jobname:jobname,configurations:job.get('configurations').toJSON()},jobrun.toJSON()));},this);if(job.get('jobruns').isEmpty()||!job.get('jobruns').get(runId)){job.fetch({success:$CL.bind(function(job){$CL.app().stopWait();$CL.app().continueDispatch(this.getMvcEvent().setResponse(_finish(job)));this.getMvcEvent().stopPropagation();},this),error:function(){$CL.app().alert('Fetching data for job failed');}});this.getMvcEvent().stopPropagation();return;}
return _finish(job);},this);if(this.jobCollection.isEmpty()){$CL.app().wait();this.jobCollection.fetch({success:$CL.bind(function(coll){_processJob(coll.get(jobname));},this),error:function(coll,jqX){$CL.app().stopWait().alert('Failed to fetch data for jobs.\nServer Response: '+jqX.responseText);}});this.getMvcEvent().stopPropagation();return;}
return _processJob(this.jobCollection.get(jobname));},startAction:function(){var jobName=this.getMvcEvent().getRouteMatch().getParam('jobname','-'),_startJob=function(job){var jobRun=job.get('jobruns').create({},{success:function(jobRun){var runCount=job.get('jobrun_count');job.set('jobrun_count',++runCount);$CL.app().router.forward('jobs_jobrun_run',{jobname:jobName,id:jobRun.get('id')});},error:function(entity,jqXhr){$CL.app().alert('Failed starting new jobrun for job ":jobname". Server says: '.replace(':jobname',jobName)+jqXhr.responseText);}});};if(this.jobCollection.isEmpty()){this.jobCollection.fetch({success:function(){_startJob(this.jobCollection.get(jobName));},error:function(collection,jqXhr){$CL.app().alert('Failed to fetch job collection data. Server says: '+jqXhr.responseText);}});this.getMvcEvent().stopPropagation();return;}
this.getMvcEvent().stopPropagation();_startJob(this.jobCollection.get(jobName));},runAction:function(){var jobName=this.getMvcEvent().getRouteMatch().getParam('jobname','-'),id=this.getMvcEvent().getRouteMatch().getParam('id',-1),_showJobRun=$CL.bind(function(job){var _finish=$CL.bind(function(job){var jobRun=job.get('jobruns').get(id);if(!jobRun){$CL.app().alert('Can not find jobrun with id ":id" for job ":jobname"'.replace(':id',id).replace(':jobname',jobName));}
jobRun.sync("update",jobRun,{success:function(jobRunData){if(jobRunData.success){var successCount=job.get('jobrun_count_success');job.set('jobrun_count_success',++successCount);}else{var failedCount=job.get('jobrun_count_failed');job.set('jobrun_count_failed',++failedCount);}},error:function(jqX){$CL.app().alert("Jobrun failed.",jqX);}});jobRun.fetch().done(function(){$CL.app().router.callRoute('jobs_jobrun',{jobname:job.get('name'),id:id});}).fail(function(jqX){$CL.app().alert("Failed to refresh jobrun data after jobrun start.",jqX);});},this);if(job.get('jobruns').isEmpty()){$CL.app().wait();job.fetch({success:$CL.bind(function(job){$CL.app().stopWait();_finish(job);},this),error:function(){$CL.app().alert('Fetching data for job failed');}});this.getMvcEvent().stopPropagation();return;}
this.getMvcEvent().stopPropagation();_finish(job);},this);if(this.jobCollection.isEmpty()){this.jobCollection.fetch({success:$CL.bind(function(){_showJobRun(this.jobCollection.get(jobName));},this),error:function(collection,jqXhr){$CL.app().alert('Failed to fetch job collection data.',jqXhr);}});this.getMvcEvent().stopPropagation();return;}
this.getMvcEvent().stopPropagation();_showJobRun(this.jobCollection.get(jobName));},refreshAction:function(){var jobName=this.getMvcEvent().getRouteMatch().getParam('jobname','-'),id=this.getMvcEvent().getRouteMatch().getParam('id',-1),jobrun=this.jobCollection.get(jobName).get('jobruns').get(id);jobrun.fetch().done(function(){$CL.app().router.forward('jobs_jobrun',{jobname:jobName,id:id});}).fail(function(jqX){$CL.app().alert("Failed to refresh jobrun.",jqX);});this.getMvcEvent().stopPropagation();},removeAction:function(){this.getMvcEvent().stopPropagation();var jobName=this.getMvcEvent().getRouteMatch().getParam('jobname','-'),id=this.getMvcEvent().getRouteMatch().getParam('id',-1),callback=this.getMvcEvent().getRouteMatch().getParam('callback',function(){}),_removeJobRun=$CL.bind(function(job){var _finish=$CL.bind(function(job){var jobRun=job.get('jobruns').get(id);if(!jobRun){$CL.app().alert('Can not find jobrun with id ":id" for job ":jobname"'.replace(':id',id).replace(':jobname',jobName));}
$CL.app().wait();jobRun.destroy().done(function(){job.fetch().done(function(){callback();}).fail(function(jqX){$CL.app().alert("Failed to fetch data for job with name :name".replace(':name',job.get('name')),jqX);}).always(function(){$CL.app().stopWait();});}).fail(function(jqX){$CL.app().stopWait().alert("Jobrun remove failed.",jqX);});},this);if(job.get('jobruns').isEmpty()){$CL.app().wait();job.fetch({success:$CL.bind(function(job){$CL.app().stopWait();_finish(job);},this),error:function(){$CL.app().alert('Fetching data for job failed');}});return;}
_finish(job);},this);if(this.jobCollection.isEmpty()){this.jobCollection.fetch({success:$CL.bind(function(){_removeJobRun(this.jobCollection.get(jobName));},this),error:function(collection,jqXhr){$CL.app().alert('Failed to fetch job collection data. Server says: '+jqXhr.responseText);}});return;}
_removeJobRun(this.jobCollection.get(jobName));return;},_addBreadcrumbs:function(jobname,startDate){var breadcrumbs=[{link:helpers.uri('jobs_overview'),label:$CL.translate('HEADLINE::JOBS')},{link:helpers.uri('jobs_job',{name:jobname}),label:jobname},{link:'',label:startDate}];this.getMvcEvent().setParam('breadcrumbs',breadcrumbs);}});var Ajax=$CL.namespace('Cl.Ajax');$CL.require("Cl.Event.EventManagerProvider");Ajax.Queue=function(){this.count=0;this.done=0;this.failed=function(){};};Ajax.Queue.prototype={setFailedCallback:function(callback){this.failed=callback;},setFinishCallback:function(callback){this.events().attach("finish",callback,0,true);},addJqXhr:function(jqXhr){if(this.count==0){this.events().trigger("start");}
this.count++;jqXhr.always($CL.bind(function(){this.done++;if(this.done==this.count){this.events().trigger("finish");}},this)).fail(this.failed);},isRunning:function()
{return this.done!=this.count;},reset:function(){this.count=0;this.done=0;this.failed=function(){};},close:function(){if(!this.isRunning()){this.events().trigger("finish");}}};_.extend(Ajax.Queue.prototype,Cl.Event.EventManagerProvider);var Controller=$CL.namespace("Ginger.Jobs.Controller");$CL.require("Cl.Application.Mvc.AbstractController");$CL.require("Cl.Ajax.Queue");$CL.require("Ginger.Jobs.Collection.Jobs");$CL.require("Ginger.Jobs.Entity.Job");Controller.Configuration=function(){};Controller.Configuration=$CL.extendClass(Controller.Configuration,Cl.Application.Mvc.AbstractController,{jobCollection:null,sourceCollection:null,targetCollection:null,mapperCollection:null,view:null,setJobCollection:function(jobCollection){this.jobCollection=jobCollection;},setSourceCollection:function(sourceCollection){this.sourceCollection=sourceCollection;},setTargetCollection:function(targetCollection){this.targetCollection=targetCollection;},setMapperCollection:function(mapperCollection){this.mapperCollection=mapperCollection;},setView:function(view){this.view=view;},addAction:function(){this._processView('add');},editAction:function(){this._processView('edit');},saveAction:function(){this.getMvcEvent().stopPropagation();var jobname=this.getMvcEvent().getRouteMatch().getParam('jobname','-'),config=this.getMvcEvent().getRouteMatch().getParam('config',{}),callback=this.getMvcEvent().getRouteMatch().getParam('callback',function(){}),configCollection=this.jobCollection.get(jobname).get('configurations');$CL.app().wait();if(!$CL.isDefined(config['id'])){configCollection.create(config,{success:function(model){$CL.app().stopWait();callback(model);},error:function(){$CL.app().stopWait().alert("Creating config failed. See Browser Console for more details.");}});}else{var configEntity=configCollection.get(config.id);configEntity.save(config,{success:function(model){$CL.app().stopWait();callback(model);},error:function(){$CL.app().stopWait().alert("Save config data failed.");}});}},removeAction:function(){this.getMvcEvent().stopPropagation();var jobname=this.getMvcEvent().getRouteMatch().getParam('jobname','-'),configCollection=this.jobCollection.get(jobname).get('configurations'),configId=this.getMvcEvent().getRouteMatch().getParam('id',0),configEntity=configCollection.get(configId);if(configEntity){configEntity.destroy().fail(function(){$CL.app().alert('Failed to remove config with id: '+configEntity.get('id'));});}else{$CL.app().alert('Can not remove config with id: ":id". No entity found.'.replace(':id',configId));}},_processView:function(action){var jobname=this.getMvcEvent().getRouteMatch().getParam('jobname');var queue=$CL.makeObj('Cl.Ajax.Queue');queue.events().attach("start",function(){$CL.app().wait();},0,true);queue.setFinishCallback($CL.bind(function(){this.view.setJobName(jobname);var _finish=$CL.bind(function(viewData){this.view.setData(viewData);$CL.get('Ginger.Jobs.View.Configuration.Sidebar').setData(viewData);this.getMvcEvent().setResponse(this.view);$CL.app().stopWait().continueDispatch(this.getMvcEvent());},this);var _getConfigData=$CL.bind(function(job){var configId=this.getMvcEvent().getRouteMatch().getParam('id');var config=job.get('configurations').get(configId);return $CL.clone(config.toJSON());},this);var viewData={sources:this.sourceCollection.toJSON(),targets:this.targetCollection.toJSON(),mappers:this.mapperCollection.toJSON()};if(this.jobCollection.isEmpty()){this.jobCollection.fetch({success:$CL.bind(function(){var job=this.jobCollection.get(jobname);job.fetch({success:$CL.bind(function(){if(action=="edit"){viewData['config']=_getConfigData(job);}
_finish(viewData);},this),error:function(){$CL.app().alert("Failed to fetch job data.");}});},this),error:function(){$CL.app().alert("Failed to fetch job collection.");}});return;}else{var job=this.jobCollection.get(jobname);if(action=="edit"){if(action=="edit"){viewData['config']=_getConfigData(job);}}}
_finish(viewData);},this));if(this.sourceCollection.isEmpty()){queue.addJqXhr(this.sourceCollection.fetch().fail(function(){$CL.app().alert('Failed fetching data for available sources');}));}
if(this.targetCollection.isEmpty()){queue.addJqXhr(this.targetCollection.fetch().fail(function(){$CL.app().alert('Failed fetching data for available targets');}));}
if(this.mapperCollection.isEmpty()){queue.addJqXhr(this.mapperCollection.fetch().fail(function(){$CL.app().alert('Failed fetching data for available mappers');}));}
this._addBreadcrumbs(jobname,action);this.getMvcEvent().setParam('sidebar',$CL.get('Ginger.Jobs.View.Configuration.Sidebar'));this.getMvcEvent().setParam('footer',$CL.get('Ginger.Jobs.View.Configuration.Footer'));queue.close();this.getMvcEvent().stopPropagation();return;},_addBreadcrumbs:function(jobname,action){var translations={'add':$CL.translate('HEADLINE::JOBS::CONFIGURATION::ADD'),'edit':$CL.translate('HEADLINE::JOBS::CONFIGURATION::EDIT')};var breadcrumbs=[{link:helpers.uri('jobs_overview'),label:$CL.translate('HEADLINE::JOBS')},{link:helpers.uri('jobs_job_edit',{name:jobname}),label:jobname+' '+$CL.translate('HEADLINE::JOBS::EDIT')},{link:'',label:translations[action]}];this.getMvcEvent().setParam('breadcrumbs',breadcrumbs);}});var Controller=$CL.namespace("Ginger.Jobs.Controller");$CL.require("Cl.Application.Mvc.AbstractController");$CL.require("Ginger.Jobs.Collection.Jobs");$CL.require("Ginger.Jobs.Entity.Job");Controller.Index=function(){};Controller.Index=$CL.extendClass(Controller.Index,Cl.Application.Mvc.AbstractController,{jobCollection:null,setJobCollection:function(jobCollection){this.jobCollection=jobCollection;},indexAction:function()
{this._addBreadcrumbs();var _processJobs=$CL.bind(function(jobs){var v=$CL.get("Ginger.Jobs.View.Index.Index");v.setData({jobs:jobs.toJSON()});return v;},this);if(this.jobCollection.isEmpty()){$CL.app().wait();this.jobCollection.fetch().done($CL.bind(function(response){$CL.app().continueDispatch(this.getMvcEvent().setResponse(_processJobs(this.jobCollection)));},this)).fail(function(){$CL.app().alert('Fetching jobs failed. See browser console for details.');}).always(function(){$CL.app().stopWait();});this.getMvcEvent().stopPropagation();return;}
return _processJobs(this.jobCollection);},jobAction:function(){this._addBreadcrumbs('job');var jobname=this.getMvcEvent().getRouteMatch().getParam('name',''),_processJob=$CL.bind(function(job){if(!job){$CL.app().alert('The job ":jobname" is not present in the job collection'.replace(':jobname',jobname));return;}
var _finish=$CL.bind(function(job){var jobData=job.toJSON(),sidebar=$CL.get('Ginger.Jobs.View.Index.Partial.JobSidebar');sidebar.setData(jobData);this.getMvcEvent().setParam('sidebar',sidebar);return $CL.get('Ginger.Jobs.View.Index.Job').setData(jobData);},this);if(job.get('jobruns').isEmpty()){$CL.app().wait();job.fetch({success:$CL.bind(function(job){$CL.app().stopWait().continueDispatch(this.getMvcEvent().setResponse(_finish(job)));this.getMvcEvent().stopPropagation();},this),error:function(){$CL.app().alert('Fetching data for job failed');}});this.getMvcEvent().stopPropagation();return;}
return _finish(job);},this);if(this.jobCollection.isEmpty()){$CL.app().wait();this.jobCollection.fetch({success:$CL.bind(function(coll){_processJob(coll.get(jobname));},this),error:function(coll,jqX){$CL.app().alert('Failed to fetch data for jobs.\nServer Response: '+jqX.responseText);}});this.getMvcEvent().stopPropagation();return;}
return _processJob(this.jobCollection.get(jobname));},editAction:function(){var jobName=this.getMvcEvent().getRouteMatch().getParam("name","");if(jobName==""){$CL.app().alert('Missing job name in JobsController::editAction');return;}
this._addBreadcrumbs('edit');var _processJob=$CL.bind(function(){var job=this.jobCollection.get(jobName);if(!job){$CL.app().alert('Job ":jobname" could not be found. Is the name correct?'.replace(':jobname',jobName));}
var _finish=$CL.bind(function(job){var view=$CL.get('Ginger.Jobs.View.Index.Edit'),jobData=job.toJSON(),sidebar=$CL.get('Ginger.Jobs.View.Index.Partial.EditSidebar');view.setData(jobData);sidebar.setData(jobData);this.getMvcEvent().setParam('sidebar',sidebar);return view;},this);if(job.get('configurations').isEmpty()){$CL.app().wait();job.fetch({success:$CL.bind(function(){$CL.app().stopWait().continueDispatch(this.getMvcEvent().setResponse(_finish(job)));this.getMvcEvent().stopPropagation();},this),error:function(){$CL.app().alert('Fetching data for job failed');}});this.getMvcEvent().stopPropagation();return;}
return _finish(job);},this);if(this.jobCollection.isEmpty()){$CL.app().wait();this.jobCollection.fetch({success:$CL.bind(function(){$CL.app().stopWait();var view=_processJob();if(view){$CL.app().continueDispatch(this.getMvcEvent().setResponse(view));this.getMvcEvent().stopPropagation();}},this),error:function(col,jqX){$CL.app().alert("Fetching data for job collection failed. Server Response: "+jqX.responseText);}});this.getMvcEvent().stopPropagation();return;}
return _processJob();},addJobFormAction:function(){this._addBreadcrumbs('add');var view=$CL.get('Ginger.Jobs.View.Index.AddJobForm');return view;},addJobAction:function(){var jobData=this.getMvcEvent().getRouteMatch().getParam('jobData',{name:"",description:""});var view=$CL.get('Ginger.Jobs.View.Index.AddJobForm');$CL.app().wait();var job=this.jobCollection.get(jobData.name);if(!job){job=$CL.makeObj('Ginger.Jobs.Entity.Job');this.jobCollection.add(job);}
job.set(jobData);job.sync("create",job,{success:$CL.bind(function(response){$CL.app().stopWait().router.callRoute('jobs_job_edit',{name:jobData.name});},this),error:$CL.bind(function(jqXhr,type,thrown){if(thrown=="Conflict"){var response=JSON.parse(jqXhr.responseText);view.form.setErrors({'name':[{name:"ServerError",msg:response.error}]});this.getMvcEvent().setResponse(view);this._addBreadcrumbs();$CL.app().stopWait().continueDispatch(this.getMvcEvent());}else{$CL.get("application").alert().stopWait();}},this)});this.getMvcEvent().stopPropagation();},saveAction:function(){var jobData=this.getMvcEvent().getRouteMatch().getParam('jobData');var jobname=this.getMvcEvent().getRouteMatch().getParam('jobname');var callback=this.getMvcEvent().getRouteMatch().getParam('callback',function(){});var job=this.jobCollection.get(jobname);if(!job){$CL.app().alert('Failed to save job data. Can not find the job ":jobname"'.replace(':jobname',jobname));return;}
$CL.app().wait();job.save(jobData).done(function(){callback();}).fail(function(m,jqX){$CL.app().alert("Failed to save job data.",jqX);}).always(function(){$CL.app().stopWait();});this.getMvcEvent().stopPropagation();},removeAction:function(){var jobname=this.getMvcEvent().getRouteMatch().getParam('jobname'),callback=this.getMvcEvent().getRouteMatch().getParam('callback',function(){}),job=this.jobCollection.get(jobname);if(!job){$CL.app().alert('Can not find the job ":jobname"'.replace(':jobname',jobname));return;}
$CL.app().wait();job.destroy().done(function(){callback();}).fail(function(jqX){$CL.app().alert('Failed to delete job.',jqX);}).always(function(){$CL.app().stopWait();});this.getMvcEvent().stopPropagation();return;},_addBreadcrumbs:function(action){var indexLink=($CL.isDefined(action))?helpers.uri('jobs_overview'):'';var breadcrumbs=[{link:indexLink,label:$CL.translate('HEADLINE::JOBS')}];if($CL.isDefined(action)){var translations={add:$CL.translate('HEADLINE::JOBS::ADD'),job:this.getMvcEvent().getRouteMatch().getParam('name',''),edit:this.getMvcEvent().getRouteMatch().getParam('name','')+' '+$CL.translate('HEADLINE::JOBS::EDIT')};breadcrumbs.push({link:'',label:translations[action]});}
this.getMvcEvent().setParam('breadcrumbs',breadcrumbs);}});var Jobs=$CL.namespace("Ginger.Jobs");$CL.require("Cl.Application.Module.ModuleInterface");$CL.require('Ginger.Jobs.Controller.Index');$CL.require('Ginger.Jobs.Controller.Configuration');$CL.require('Ginger.Jobs.Controller.Jobrun');$CL.require("Ginger.Jobs.View.Index.Index");$CL.require("Ginger.Jobs.View.Index.Job");$CL.require("Ginger.Jobs.View.Index.AddJobForm");$CL.require("Ginger.Jobs.View.Index.Edit");$CL.require('Ginger.Jobs.View.Index.Partial.EditSidebar');$CL.require('Ginger.Jobs.View.Index.Partial.JobSidebar');$CL.require("Ginger.Jobs.View.Configuration.Edit");$CL.require("Ginger.Jobs.View.Configuration.Sidebar");$CL.require("Ginger.Jobs.View.Configuration.Footer");$CL.require("Ginger.Jobs.View.Jobrun.Show");$CL.require('Ginger.Jobs.View.Jobrun.Entry');$CL.require("Ginger.Jobs.Form.AddJob");$CL.require("Ginger.Jobs.Collection.Jobs");$CL.require("Ginger.Jobs.Collection.Sources");$CL.require("Ginger.Jobs.Collection.SourceInfos");$CL.require("Ginger.Jobs.Collection.Mappers");$CL.require("Ginger.Jobs.Collection.Targets");$CL.require("Ginger.Jobs.Collection.TargetInfos");$CL.require("Ginger.Jobs.Collection.Features");$CL.require('Ginger.Jobs.Collection.LatestJobruns');Jobs.Module=function(){this.__IMPLEMENTS__=[Cl.Application.Module.ModuleInterface];};Jobs.Module.prototype={getConfig:function(){return{router:{routes:{'jobs_overview':{route:'jobs/overview/',callback:function(){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"index",action:"index"});},build:function(routeParams){return this.route;}},'jobs_add_form':{route:'jobs/add/form/',callback:function(){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"index",action:"addJobForm"});},build:function(routeParams){return this.route;}},'jobs_add_job':{route:'jobs/add/',jobData:{},callback:function(){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"index",action:"addJob",params:{jobData:this.jobData}});},build:function(routeParams){this.jobData=routeParams.jobData;return this.route;}},'jobs_job':{route:'jobs/:name',callback:function(name){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"index",action:"job",params:{name:name}});},build:function(routeParams){return this.route.replace(':name',routeParams.name);}},'jobs_job_edit':{route:'jobs/update/:name',callback:function(name){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"index",action:"edit",params:{name:name}});},build:function(routeParams){return this.route.replace(':name',routeParams.name);}},'jobs_job_save':{route:'jobs/save/:jobname',jobData:{},customCallback:function(){},callback:function(jobname){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"index",action:"save",params:{jobname:jobname,jobData:this.jobData,callback:this.customCallback}});},build:function(routeParams){this.jobData=routeParams.jobData;if($CL.isDefined(routeParams.callback)){this.customCallback=routeParams.callback;}else{this.customCallback=function(){};}
return this.route.replace(':jobname',routeParams.jobname);}},'jobs_job_remove':{route:'jobs/remove/:jobname',customCallback:function(){},callback:function(jobname){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"index",action:"remove",params:{jobname:jobname,callback:this.customCallback}});},build:function(routeParams){if($CL.isDefined(routeParams.callback)){this.customCallback=routeParams.callback;}else{this.customCallback=function(){};}
return this.route.replace(':jobname',routeParams.jobname);}},'jobs_jobrun':{route:'jobs/:jobname/jobrun/:id',callback:function(jobname,id){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"jobrun",action:"show",params:{jobname:jobname,id:id}});},build:function(routeParams){return this.route.replace(':jobname',routeParams.jobname).replace(':id',routeParams.id);}},'jobs_jobrun_start':{route:'jobs/:jobname/jobrun/start/',callback:function(jobname){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"jobrun",action:"start",params:{jobname:jobname}});},build:function(routeParams){return this.route.replace(':jobname',routeParams.jobname);}},'jobs_jobrun_run':{route:'jobs/:jobname/jobrun/:id/run/',callback:function(jobname,id){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"jobrun",action:"run",params:{jobname:jobname,id:id}});},build:function(routeParams){return this.route.replace(':jobname',routeParams.jobname).replace(':id',routeParams.id);}},'jobs_jobrun_refresh':{route:'jobs/:jobname/jobrun/:id/refresh/',callback:function(jobname,id){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"jobrun",action:"refresh",params:{jobname:jobname,id:id}});},build:function(routeParams){return this.route.replace(':jobname',routeParams.jobname).replace(':id',routeParams.id);}},'jobs_jobrun_remove':{route:'jobs/:jobname/jobrun/:id/remove/',customCallback:function(){},callback:function(jobname,id){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"jobrun",action:"remove",params:{jobname:jobname,id:id,callback:this.customCallback}});},build:function(routeParams){this.customCallback=routeParams.callback;return this.route.replace(':jobname',routeParams.jobname).replace(':id',routeParams.id);}},'jobs_configuration_add':{route:'jobs/:jobname/config/add/',callback:function(jobname){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"configuration",action:"add",params:{jobname:jobname}});},build:function(routeParams){return this.route.replace(':jobname',routeParams.jobname);}},'jobs_configuration_edit':{route:'jobs/:jobname/config/edit/:id',callback:function(jobname,id){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"configuration",action:"edit",params:{jobname:jobname,id:id}});},build:function(routeParams){return this.route.replace(':jobname',routeParams.jobname).replace(':id',routeParams.id);}},'jobs_configuration_save':{route:'jobs/:jobname/config/save/',config:null,customCallback:function(){},callback:function(jobname){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"configuration",action:"save",params:{jobname:jobname,config:this.config,callback:this.customCallback}});},build:function(routeParams){this.config=routeParams.config;if($CL.isDefined(routeParams['callback'])){this.customCallback=routeParams.callback;}
return this.route.replace(':jobname',routeParams.jobname);}},'jobs_configuration_remove':{route:'jobs/:jobname/config/remove/:id',config:null,callback:function(jobname,id){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Jobs.Module",controller:"configuration",action:"remove",params:{jobname:jobname,id:id}});},build:function(routeParams){return this.route.replace(':jobname',routeParams.jobname).replace(':id',routeParams.id);}}}},service_manager:{'factories':{'Ginger.Jobs.Controller.Index':function(sl){var c=$CL.makeObj('Ginger.Jobs.Controller.Index');c.setJobCollection(sl.get('Ginger.Jobs.Collection.Jobs'));return c;},'Ginger.Jobs.Controller.Configuration':function(sl){var c=$CL.makeObj('Ginger.Jobs.Controller.Configuration');c.setJobCollection(sl.get('Ginger.Jobs.Collection.Jobs'));c.setSourceCollection(sl.get('Ginger.Jobs.Collection.Sources'));c.setTargetCollection(sl.get('Ginger.Jobs.Collection.Targets'));c.setMapperCollection(sl.get('Ginger.Jobs.Collection.Mappers'));c.setView(sl.get('Ginger.Jobs.View.Configuration.Add'));return c;},'Ginger.Jobs.Controller.Jobrun':function(sl){var c=$CL.makeObj('Ginger.Jobs.Controller.Jobrun');c.setJobCollection(sl.get('Ginger.Jobs.Collection.Jobs'));return c;},'Ginger.Jobs.View.Index.Index':function(sl){var v=$CL.makeObj('Ginger.Jobs.View.Index.Index');v.setTemplate($CL._template('jobs_index'));return v;},'Ginger.Jobs.View.Index.Job':function(sl){var v=$CL.makeObj('Ginger.Jobs.View.Index.Job');v.setTemplate($CL._template('jobs_job'));return v;},'Ginger.Jobs.View.Index.AddJobForm':function(sl){var v=$CL.makeObj('Ginger.Jobs.View.Index.AddJobForm');v.setForm($CL.makeObj('Ginger.Jobs.Form.AddJob'));v.setSubmitCallback(function(formData){$CL.app().router.forward('jobs_add_job',{jobData:formData})});v.setTemplate($CL._template('jobs_add'));return v;},'Ginger.Jobs.View.Index.Edit':function(sl){var v=$CL.makeObj('Ginger.Jobs.View.Index.Edit');v.setTemplate($CL._template('jobs_job_edit'));return v;},'Ginger.Jobs.View.Index.Partial.EditSidebar':function(sl){var v=$CL.makeObj('Ginger.Jobs.View.Index.Partial.EditSidebar');v.setTemplate($CL._template('jobs_job_edit_sidebar'));return v;},'Ginger.Jobs.View.Index.Partial.JobSidebar':function(sl){var v=$CL.makeObj('Ginger.Jobs.View.Index.Partial.JobSidebar');v.setTemplate($CL._template('jobs_job_sidebar'));return v;},'Ginger.Jobs.View.Configuration.Edit':function(sl){var v=$CL.makeObj('Ginger.Jobs.View.Configuration.Edit');v.setTemplate($CL._template('jobs_config_edit'));v.setElementLoader(sl.get('module_element_loader'));var footer=sl.get('Ginger.Jobs.View.Configuration.Footer');footer.on('save',v.onConfigSave,v);footer.on('cancel',v.onConfigCancel,v);footer.on('export',v.onConfigExport,v);footer.on('import',v.onConfigImport,v);v.setFooter(footer);return v;},'Ginger.Jobs.View.Configuration.Sidebar':function(sl){var v=$CL.makeObj('Ginger.Jobs.View.Configuration.Sidebar');v.setTemplate($CL._template('jobs_config_sidebar'));v.setElementLoader(sl.get('module_element_loader'));v.setFeatureCollection(sl.get('Ginger.Jobs.Collection.Features'));var editView=sl.get('Ginger.Jobs.View.Configuration.Edit');editView.on('enableFeatures',v.onEnableFeatures,v);editView.on('disableFeatures',v.onDisableFeatures,v);editView.on('config-save',v.onConfigSave,v);v.setMainEditView(editView);return v;},'Ginger.Jobs.View.Configuration.Footer':function(sl){var v=$CL.makeObj('Ginger.Jobs.View.Configuration.Footer');v.setTemplate($CL._template('jobs_config_footer'));return v;},'Ginger.Jobs.View.Configuration.Add':function(sl){return sl.get('Ginger.Jobs.View.Configuration.Edit');},'Ginger.Jobs.View.Jobrun.Show':function(sl){var v=$CL.makeObj('Ginger.Jobs.View.Jobrun.Show');v.setTemplate($CL._template('jobs_jobrun_show'));return v;},'Ginger.Jobs.View.Jobrun.Entry':function(sl){var v=$CL.makeObj('Ginger.Jobs.View.Jobrun.Entry');v.setTemplate($CL._template('jobs_jobrun_entry'));return v;}},'non_shared_services':['Ginger.Jobs.View.Jobrun.Entry']}}},getController:function(controllerName){controllerName=controllerName.ucfirst();if($CL.classExists("Ginger.Jobs.Controller."+controllerName)){return $CL.get("Ginger.Jobs.Controller."+controllerName);}else{$CL.exception("unknown controllername","Ginger.Jobs.Module",controllerName);}}};var Partial=$CL.namespace('Ginger.Dashboard.View.Index.Partial');$CL.require('Cl.Backbone.View');Partial.LatestJobruns=function(){};Partial.LatestJobruns=$CL.extendClass(Partial.LatestJobruns,Cl.Backbone.View,{data:null,events:{'click .js-jobrun-row .js-show-details':'onShowDetailsClick','click .js-jobrun-details .js-remove':'onRemoveJobrunClick'},render:function(){if(!_.isNull(this.data)){Cl.Backbone.View.prototype.render.apply(this);this.$el.removeClass('loading loading-left');}},updateData:function(data){this.data=data;this.render();},onShowDetailsClick:function(e){e.preventDefault();var $a=$CL.jTarget(e.target,'a'),$details=$a.parents('.js-jobrun-row').next();if($details.hasClass('hide')){$a.find('i').removeClass('icon-arrow-down').addClass('icon-arrow-up');$details.slideDown().removeClass('hide');}else{$a.find('i').removeClass('icon-arrow-up').addClass('icon-arrow-down');$details.slideUp().addClass('hide');}},onRemoveJobrunClick:function(e){e.preventDefault();var $a=$CL.jTarget(e.target,'a');var jobrun=_.findWhere(this.data.jobruns,{id:$a.data('id')});$CL.app().router.forward('jobs_jobrun_remove',{jobname:jobrun.jobName,id:$a.data('id'),callback:$CL.bind(function(){$CL.app().router.forward('dashboard');},this)});}});var Partial=$CL.namespace('Ginger.Dashboard.View.Index.Partial');$CL.require('Cl.Backbone.View');Partial.Module=function(){};Partial.Module=$CL.extendClass(Partial.Module,Cl.Backbone.View);var Partial=$CL.namespace('Ginger.Dashboard.View.Index.Partial');$CL.require('Cl.Backbone.View');Partial.Modules=function(){};Partial.Modules=$CL.extendClass(Partial.Modules,Cl.Backbone.View,{moduleView:null,id:'js_modules',events:{'click .connect-module-link':'onModuleLinkClick'},setModuleView:function(moduleView){this.moduleView=moduleView;},render:function(){_.each(this.data.modules,function(moduleData){this.moduleView.setData(moduleData);this.moduleView.render();this.$el.append(this.moduleView.$el.clone());},this);},onModuleLinkClick:function(e){e.preventDefault();var $a=$CL.jTarget(e.target,'a');$CL.get('application').router.forward('application_load_module',{moduleName:$a.data('name'),gotoRoute:$a.data('route')});}});var Index=$CL.namespace('Ginger.Dashboard.View.Index');$CL.require('Cl.Backbone.View');Index.Sidebar=function(){};Index.Sidebar=$CL.extendClass(Index.Sidebar,Cl.Backbone.View,{render:function(){this.$el.html('');}});var Index=$CL.namespace('Ginger.Dashboard.View.Index');$CL.require('Cl.Backbone.View');Index.Index=function(){};Index.Index=$CL.extendClass(Index.Index,Cl.Backbone.View,{modulesView:null,jobrunsView:null,setModulesView:function(modulesView){this.modulesView=modulesView;},setJobrunsView:function(jobrunsView){this.jobrunsView=jobrunsView;},getJobrunsView:function(){return this.jobrunsView;},render:function(){this.$el.html(this.tpl());this.renderModules();this.renderJobrunsView();},renderModules:function(){this.modulesView.setElement(this.$el.find('#js_modules')[0]);this.modulesView.setData({modules:this.data.modules});this.modulesView.render();},renderJobrunsView:function(){this.jobrunsView.setElement(this.$el.find('#js_latest_jobruns'));this.jobrunsView.render();}});var Service=$CL.namespace('Ginger.Dashboard.Service');Service.LatestJobruns=function(){};Service.LatestJobruns.prototype={url:"/rest/latest-jobruns",fetch:function(options){var successCb=function(){};var errorCb=function(){};if(options){if(options.success){successCb=options.success;}
if(options.error){errorCb=options.error;}}
$.get(this.url,function(data){successCb(data);}).fail(function(jqX){errorCb(jqX);});}}
var Controller=$CL.namespace("Ginger.Dashboard.Controller");$CL.require("Cl.Application.Mvc.AbstractController");Controller.Index=function(){};Controller.Index=$CL.extendClass(Controller.Index,Cl.Application.Mvc.AbstractController,{modulesCollection:null,latestJobrunsService:null,setModulesCollection:function(modulesCollection){this.modulesCollection=modulesCollection;},setLatestJobrunsService:function(latestJobrunsService){this.latestJobrunsService=latestJobrunsService;},indexAction:function()
{this.getMvcEvent().setParam('breadcrumbs',[{link:'',label:'Dashboard'}]);var view=$CL.get('Ginger.Dashboard.View.Index.Index');var jobrunsView=view.getJobrunsView();this.latestJobrunsService.fetch({success:function(data){jobrunsView.updateData({jobruns:data});},error:function(jqX){$CL.app().alert('Failed to load latest Jobruns.',jqX);}});view.setData({modules:this.modulesCollection.toJSON()});return view;}});var Dashboard=$CL.namespace("Ginger.Dashboard");$CL.require("Cl.Application.Module.ModuleInterface");$CL.require('Ginger.Dashboard.Controller.Index');$CL.require('Ginger.Dashboard.Service.LatestJobruns');$CL.require("Ginger.Dashboard.View.Index.Index");$CL.require("Ginger.Dashboard.View.Index.Sidebar");$CL.require("Ginger.Dashboard.View.Index.Partial.Modules");$CL.require("Ginger.Dashboard.View.Index.Partial.Module");$CL.require("Ginger.Dashboard.View.Index.Partial.LatestJobruns");Dashboard.Module=function(){this.__IMPLEMENTS__=[Cl.Application.Module.ModuleInterface];};Dashboard.Module.prototype={getConfig:function(){return{router:{routes:{'dashboard':{route:'dashboard',callback:function(){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Dashboard.Module",controller:"index",action:"index"});},build:function(routeParams){return this.route;}}}},service_manager:{'factories':{'Ginger.Dashboard.Controller.Index':function(sl){var c=$CL.makeObj('Ginger.Dashboard.Controller.Index');c.setModulesCollection(sl.get('Ginger.Application.Collection.Modules'));c.setLatestJobrunsService(sl.get('Ginger.Dashboard.Service.LatestJobruns'));return c;},'Ginger.Dashboard.View.Index.Index':function(sl){var view=$CL.makeObj('Ginger.Dashboard.View.Index.Index');view.setTemplate($CL._template('dashboard_main'));view.setModulesView(sl.get('Ginger.Dashboard.View.Index.Partial.Modules'));view.setJobrunsView(sl.get('Ginger.Dashboard.View.Index.Partial.LatestJobruns'));return view;},'Ginger.Dashboard.View.Index.Partial.Modules':function(sl){var v=$CL.makeObj('Ginger.Dashboard.View.Index.Partial.Modules');v.setModuleView(sl.get('Ginger.Dashboard.View.Index.Partial.Module'));return v;},'Ginger.Dashboard.View.Index.Partial.Module':function(sl){var v=$CL.makeObj('Ginger.Dashboard.View.Index.Partial.Module');v.setTemplate($CL._template('dashboard_module'));return v;},'Ginger.Dashboard.View.Index.Partial.LatestJobruns':function(sl){var v=$CL.makeObj('Ginger.Dashboard.View.Index.Partial.LatestJobruns');v.setTemplate($CL._template('dashboard_latest_jobruns'));return v;}}}}},getController:function(controllerName){controllerName=controllerName.ucfirst();if($CL.classExists("Ginger.Dashboard.Controller."+controllerName)){return $CL.get("Ginger.Dashboard.Controller."+controllerName);}else{$CL.exception("unknown controllername","Ginger.Dashboard.Module",controllerName);}}};var Partial=$CL.namespace('Ginger.Application.View.Partial');$CL.require('Cl.Backbone.View');Partial.Footer=function(){};Partial.Footer=$CL.extendClass(Partial.Footer,Cl.Backbone.View,{render:function(){this.$el.html("");}});var Partial=$CL.namespace('Ginger.Application.View.Partial');$CL.require("Cl.Backbone.View");Partial.StaticValueFeatureHelp=function(){};Partial.StaticValueFeatureHelp=$CL.extendClass(Partial.StaticValueFeatureHelp,Cl.Backbone.View,{render:function(){this.$el.html($CL.translate('FEATURES::STATIC_VALUE::HELP::FEATURE'));}});var Partial=$CL.namespace('Ginger.Application.View.Partial');$CL.require("Cl.Backbone.View");Partial.StaticValueFeatureOptions=function(){};Partial.StaticValueFeatureOptions=$CL.extendClass(Partial.StaticValueFeatureOptions,Cl.Backbone.View,{render:function(){this.parent.prototype.render.apply(this);if(this.data.options&&this.data.options.static_value){this.$el.find('input[name=staticvalue-value]').val(this.data.options.static_value);}}});var Partial=$CL.namespace('Ginger.Application.View.Partial');$CL.require("Cl.Backbone.View");Partial.AttributeMapFeatureHelp=function(){};Partial.AttributeMapFeatureHelp=$CL.extendClass(Partial.AttributeMapFeatureHelp,Cl.Backbone.View,{render:function(){this.$el.html($CL.translate('ATTRIBUTEMAP::HELP'));}});var Partial=$CL.namespace('Ginger.Application.View.Partial');$CL.require("Cl.Backbone.View");Partial.AttributeMapFeatureOptions=function(){};Partial.AttributeMapFeatureOptions=$CL.extendClass(Partial.AttributeMapFeatureOptions,Cl.Backbone.View,{mainEditView:null,events:{'click .js-attributemap-column-ok':'onColumnOkClick','click .js-attributemap-column .js-remove':'onColumnRemoveClick','click .js-attributemap-column .js-edit':'onColumnEditClick'},setMainEditView:function(editView){this.mainEditView=editView;},render:function(){this.data.sourceInfo=$CL.clone(this.mainEditView.activeMapper.sourceInfoData);this.data.targetInfo=$CL.clone(this.mainEditView.activeMapper.targetInfoData);if($CL.isDefined(this.data.options['attribute_map'])){var definedSourceColumns=[];var definedTargetColumns=[];$.each(this.data.options.attribute_map,$CL.bind(function(sourceColumn,targetColumn){definedSourceColumns.push(sourceColumn);definedTargetColumns.push(targetColumn);},this));this.data.sourceInfo.data_structure=_.filter(this.mainEditView.activeMapper.sourceInfoData.data_structure,function(columnDesc){return _.contains(definedSourceColumns,columnDesc.name)!=true;});this.data.targetInfo.data_structure=_.filter(this.mainEditView.activeMapper.targetInfoData.data_structure,function(columnDesc){return _.contains(definedTargetColumns,columnDesc.name)!=true;});}
Cl.Backbone.View.prototype.render.apply(this);},onColumnOkClick:function(e){e.preventDefault();var $tr=$(e.target).parents('.ts-tr'),$sourceSelect=$tr.find('.js-source-td').find('select'),sourceColumn=$sourceSelect.val(),$targetSelect=$tr.find('.js-target-td').find('select'),targetColumn=$targetSelect.val(),$dataTr=$tr.clone();$dataTr.removeAttr('id').addClass('js-attributemap-column');$dataTr.find('.js-source-td').html(sourceColumn);$dataTr.find('.js-target-td').html(targetColumn).next().html($CL._template('application_edit_remove')({id:0}));$tr.before($dataTr);if($tr.parent().find('.ts-tr').last()[0]!=$tr[0]){$tr.parent().find('.ts-tr').last().after($tr);}},onColumnRemoveClick:function(e){e.preventDefault();$(e.target).parents('.ts-tr').remove();},onColumnEditClick:function(e){e.preventDefault();var $tr=$(e.target).parents('.ts-tr'),sourceColumn=$tr.find('.js-source-td').html(),targetColumn=$tr.find('.js-target-td').html(),$sourceSelect=$('#js-attributemap-column-chooser').find('.js-source-td').find('select'),$targetSelect=$('#js-attributemap-column-chooser').find('.js-target-td').find('select');$sourceSelect.val(sourceColumn);$targetSelect.val(targetColumn);$tr.replaceWith($('#js-attributemap-column-chooser').removeClass('hide'));}});var Partial=$CL.namespace('Ginger.Application.View.Partial');$CL.require("Cl.Backbone.View");Partial.ValidatorFeatureOptions=function(){};Partial.ValidatorFeatureOptions=$CL.extendClass(Partial.ValidatorFeatureOptions,Cl.Backbone.View,{events:{'click label[for=validator-error-handling]':'onValidatorErrorHandlingClick'},onValidatorErrorHandlingClick:function(e){$CL.jTarget(e.target,'label').find('input[type=radio]').attr('checked','checked');},render:function(){this.parent.prototype.render.apply(this);if(this.data.options&&this.data.options.error_handling){this.$el.find('input[type=radio]').filter('input[value='+this.data.options.error_handling+']').click();}}});var Partial=$CL.namespace('Ginger.Application.View.Partial');$CL.require("Cl.Backbone.View");Partial.AbstractFeatureOptions=function(){};Partial.AbstractFeatureOptions=$CL.extendClass(Partial.AbstractFeatureOptions,Cl.Backbone.View,{advancedOptionsView:null,siteToAlter:null,attributesToAlter:[],mainEditView:null,id:null,events:{'click label[for=feature-site-to-alter]':'onFeatureSiteToAlterClick','click .js-feature-attribute-ok':'onFeatureAttributeOkClick','click .js-attribute-tr .js-remove':'onRemoveAttributeClick'},setMainEditView:function(editView){this.mainEditView=editView;},setAdvancedOptionsView:function(advancedOptionsView){this.advancedOptionsView=advancedOptionsView;},render:function(){this.parent.prototype.render.apply(this);if(!_.isNull(this.advancedOptionsView)){this.advancedOptionsView.setElement(this.$el.find('.js-feature-advanced-options'));this.advancedOptionsView.setData(this.data);this.advancedOptionsView.render();}
if(this.data.options){if(this.data.options.site_to_alter){this.$el.find('label[for=feature-site-to-alter]').find('input[value='+this.data.options.site_to_alter+']').click();}
if(this.data.options.attributes_to_alter){this.attributesToAlter=this.data.options.attributes_to_alter;if($CL.isEmpty(this.attributesToAlter)){this.attributesToAlter=[];}
this.renderAttributesOption();}}},renderAttributesOption:function(){var possibleAttributes=[],sourceId=$('select[name=source]').val(),targetId=$('select[name=target]').val(),$sel=this.$el.find('select[name=feature-attribute-chooser]');if(this.siteToAlter=="source"){possibleAttributes=this._getAttributesFromDataStructure(this.mainEditView.activeMapper.sourceInfoData.data_structure);}else if(this.siteToAlter=="target"){possibleAttributes=this._getAttributesFromDataStructure(this.mainEditView.activeMapper.targetInfoData.data_structure);}
possibleAttributes=_.difference(possibleAttributes,this.attributesToAlter);$sel.find(':not(option[value=all])').remove();if(possibleAttributes.length>0){$sel.parents('.ts-tr').removeClass('hide');_.each(possibleAttributes,function(possibleAttribute){$sel.append($('<option />').html(possibleAttribute));});}else{$sel.parents('.ts-tr').addClass('hide');}
this.$el.find('.js-feature-attributes').find('.js-attribute-tr').remove();_.each(this.attributesToAlter,$CL.bind(function(attributeToAlter){this.$el.find('.js-feature-attributes').find('.ts-tr').last().after($('<div />').addClass('ts-tr js-attribute-tr').html($('<div />').addClass('ts-td11').html(attributeToAlter)).append($('<div />').addClass('ts-td1').html($CL._template('application_edit_remove')({id:attributeToAlter,hideEdit:true}))));},this));this.$el.find('.js-feature-attributes-option').removeClass('hide');},setSiteToAlterError:function(){var $cg=this.$el.find('input[name=feature-site-to-alter]').parents('.control-group');$cg.find('.well').removeClass('well').addClass('alert alert-block alert-error');$cg.find('.label').addClass('label-important');},removeSiteToAlterError:function(){var $cg=this.$el.find('input[name=feature-site-to-alter]').parents('.control-group');$cg.find('.alert').removeClass('alert alert-block alert-error').addClass('well');$cg.find('.label').removeClass('label-important');},setAttributesToAlterError:function(){var $cg=this.$el.find('select[name=feature-attribute-chooser]').parents('.control-group');$cg.find('.well').removeClass('well').addClass('alert alert-error');},removeAttributesToAlterError:function(){var $cg=this.$el.find('select[name=feature-attribute-chooser]').parents('.control-group');$cg.find('.alert').removeClass('alert alert-error').addClass('well');},onFeatureSiteToAlterClick:function(e){var $label=$CL.jTarget(e.target,'label'),siteToAlter=$label.find('input').attr('checked','checked').val();this.removeSiteToAlterError();this.siteToAlter=siteToAlter;this.attributesToAlter=[];this.renderAttributesOption();},onFeatureAttributeOkClick:function(e){e.preventDefault();var $a=$CL.jTarget(e.target,'a'),$sel=this.$el.find('select[name=feature-attribute-chooser]');this.removeAttributesToAlterError();if($sel.val()=="all"){$sel.find(':not(option[value=all])').each($CL.bind(function(i,opt){this.attributesToAlter.push($(opt).html());},this));}else{this.attributesToAlter.push($sel.val());}
this.renderAttributesOption();},onRemoveAttributeClick:function(e){e.preventDefault();var $a=$CL.jTarget(e.target,'a'),attribute=$a.data('id');this.attributesToAlter=_.without(this.attributesToAlter,attribute);this.renderAttributesOption();},_getAttributesFromDataStructure:function(dataStructure){var attributes=[];if(dataStructure){_.each(dataStructure,function(columnDesc){attributes.push(columnDesc.name);});}
return attributes;}});var Partial=$CL.namespace('Ginger.Application.View.Partial');$CL.require('Cl.Backbone.View');Partial.DevNullOptions=function(){};Partial.DevNullOptions=$CL.extendClass(Partial.DevNullOptions,Cl.Backbone.View,{render:function(){Cl.Backbone.View.prototype.render.apply(this);if($CL.isDefined(this.data.options)){this.$el.find('input[name=devnull-log-file-name]').val(this.data.options.log_file_name);}}});var Partial=$CL.namespace('Ginger.Application.View.Partial');$CL.require('Cl.Backbone.View');Partial.SourceScriptOptions=function(){};Partial.SourceScriptOptions=$CL.extendClass(Partial.SourceScriptOptions,Cl.Backbone.View,{render:function(){Cl.Backbone.View.prototype.render.apply(this);if($CL.isDefined(this.data.options)){this.$el.find('input[name=sourcescript-script-name]').val(this.data.options.script_name);}}});var Partial=$CL.namespace('Ginger.Application.View.Partial');$CL.require('Cl.Backbone.View');Partial.TargetDirectoryOptions=function(){};Partial.TargetDirectoryOptions=$CL.extendClass(Partial.TargetDirectoryOptions,Cl.Backbone.View,{events:{'change select[name=targetdirectory-dir]':'onDirChange'},render:function(){Cl.Backbone.View.prototype.render.apply(this);if($CL.isDefined(this.data.options)){this.$el.find('input[name=targetdirectory-filename-pattern]').val(this.data.options.filename_pattern);if(this.data.options.target_dir!="inbox"&&this.data.options.target_dir!="outbox"){this.$el.find('select[name=targetdirectory-dir]').val('custom');this.$el.find('input[name=targetdirectory-custom-dir]').val(this.data.options.target_dir);$('#targetdirectory-custom-dir-row').removeClass('hide');}else{this.$el.find('select[name=targetdirectory-dir]').val(this.data.options.target_dir);}}},onDirChange:function(e){var dir=$(e.target).val();if(dir=="custom"){$('#targetdirectory-custom-dir-row').removeClass('hide');}else{$('#targetdirectory-custom-dir-row').addClass('hide');}},collectOptions:function(){var options={target_dir:this.$el.find('select[name=targetdirectory-dir]').val(),filename_pattern:this.$el.find('input[name=targetdirectory-filename-pattern]').val()};if(options.target_dir=="custom"){options.target_dir=this.$el.find('input[name=targetdirectory-custom-dir]').val();}
return options;}});var Partial=$CL.namespace('Ginger.Application.View.Partial');$CL.require('Cl.Backbone.View');Partial.SourceDirectoryOptions=function(){};Partial.SourceDirectoryOptions=$CL.extendClass(Partial.SourceDirectoryOptions,Cl.Backbone.View,{mainEditView:null,events:{'click label[for=sourcedirectory-iterator-mode]':'onIteratorModeClick','change select[name=sourcedirectory-dir]':'onDirChange'},render:function(){Cl.Backbone.View.prototype.render.apply(this);if($CL.isDefined(this.data.options)){this.$el.find('input[name=sourcedirectory-file-pattern]').val(this.data.options.file_pattern);if(this.data.options.source_dir!="inbox"&&this.data.options.source_dir!="outbox"){this.$el.find('select[name=sourcedirectory-dir]').val('custom');this.$el.find('input[name=sourcedirectory-custom-dir]').val(this.data.options.source_dir);$('#sourcedirectory-custom-dir-row').removeClass('hide');}else{this.$el.find('select[name=sourcedirectory-dir]').val(this.data.options.source_dir);}
if(this.data.options.iterator_mode=="data"){this.$el.find('input[name=sourcedirectory-iterator-mode]').attr('checked','checked');this.mainEditView.activeSourceData.data_type=3;}}},setMainEditView:function(editView){if(_.isNull(this.mainEditView)||this.mainEditView!=editView){editView.on('config-save-post',this.onPostConfigSave,this);this.mainEditView=editView;}},onIteratorModeClick:function(e){if(e.target.nodeName.toLowerCase()!="input"){var $label=$CL.jTarget(e.target,'label');if($label.find('input').is(':checked')){$label.find('input').removeAttr('checked');}else{$label.find('input').attr('checked','checked');}}
if(this.$el.find('input[name=sourcedirectory-iterator-mode]').is(':checked')){this.mainEditView.activeSourceData.data_type=3;}else{this.mainEditView.activeSourceData.data_type=0;}},onDirChange:function(e){var dir=$(e.target).val();if(dir=="custom"){$('#sourcedirectory-custom-dir-row').removeClass('hide');}else{$('#sourcedirectory-custom-dir-row').addClass('hide');}},onPostConfigSave:function(config){this.mainEditView.refreshMapper();},collectOptions:function(){var options={source_dir:this.$el.find('select[name=sourcedirectory-dir]').val(),iterator_mode:"file",file_pattern:this.$el.find('input[name=sourcedirectory-file-pattern]').val()};if(options.source_dir=="custom"){options.source_dir=this.$el.find('input[name=sourcedirectory-custom-dir]').val();}
if(this.$el.find('input[name=sourcedirectory-iterator-mode]').is(':checked')){options.iterator_mode="data";}
return options;}});var Partial=$CL.namespace('Ginger.Application.View.Partial');$CL.require('Cl.Backbone.View');Partial.SourcefileOptions=function(){};Partial.SourcefileOptions=$CL.extendClass(Partial.SourcefileOptions,Cl.Backbone.View,{render:function(){Cl.Backbone.View.prototype.render.apply(this);if($CL.isDefined(this.data.options)){this.$el.find('input[name=sourcefile-file-pattern]').val(this.data.options.file_pattern);}}});$CL.require("Cl.Jquery.Plugin.Ui.Core");(function($,undefined){function isOverAxis(x,reference,size){return(x>reference)&&(x<(reference+size));}
$.widget("ui.sortable",$.ui.mouse,{version:"1.10.1",widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var o=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?o.axis==="x"||(/left|right/).test(this.items[0].item.css("float"))||(/inline|table-cell/).test(this.items[0].item.css("display")):false;this.offset=this.element.offset();this._mouseInit();this.ready=true;},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var i=this.items.length-1;i>=0;i--){this.items[i].item.removeData(this.widgetName+"-item");}
return this;},_setOption:function(key,value){if(key==="disabled"){this.options[key]=value;this.widget().toggleClass("ui-sortable-disabled",!!value);}else{$.Widget.prototype._setOption.apply(this,arguments);}},_mouseCapture:function(event,overrideHandle){var currentItem=null,validHandle=false,that=this;if(this.reverting){return false;}
if(this.options.disabled||this.options.type==="static"){return false;}
this._refreshItems(event);$(event.target).parents().each(function(){if($.data(this,that.widgetName+"-item")===that){currentItem=$(this);return false;}});if($.data(event.target,that.widgetName+"-item")===that){currentItem=$(event.target);}
if(!currentItem){return false;}
if(this.options.handle&&!overrideHandle){$(this.options.handle,currentItem).find("*").addBack().each(function(){if(this===event.target){validHandle=true;}});if(!validHandle){return false;}}
this.currentItem=currentItem;this._removeCurrentsFromItems();return true;},_mouseStart:function(event,overrideHandle,noActivation){var i,o=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(event);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(event);this.originalPageX=event.pageX;this.originalPageY=event.pageY;(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0]){this.currentItem.hide();}
this._createPlaceholder();if(o.containment){this._setContainment();}
if(o.cursor){if($("body").css("cursor")){this._storedCursor=$("body").css("cursor");}
$("body").css("cursor",o.cursor);}
if(o.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity");}
this.helper.css("opacity",o.opacity);}
if(o.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex");}
this.helper.css("zIndex",o.zIndex);}
if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset();}
this._trigger("start",event,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions();}
if(!noActivation){for(i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("activate",event,this._uiHash(this));}}
if($.ui.ddmanager){$.ui.ddmanager.current=this;}
if($.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}
this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(event);return true;},_mouseDrag:function(event){var i,item,itemElement,intersection,o=this.options,scrolled=false;this.position=this._generatePosition(event);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs;}
if(this.options.scroll){if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-event.pageY<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed;}else if(event.pageY-this.overflowOffset.top<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed;}
if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-event.pageX<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed;}else if(event.pageX-this.overflowOffset.left<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed;}}else{if(event.pageY-$(document).scrollTop()<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed);}else if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed);}
if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed);}else if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed);}}
if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}}
this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px";}
if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px";}
for(i=this.items.length-1;i>=0;i--){item=this.items[i];itemElement=item.item[0];intersection=this._intersectsWithPointer(item);if(!intersection){continue;}
if(item.instance!==this.currentContainer){continue;}
if(itemElement!==this.currentItem[0]&&this.placeholder[intersection===1?"next":"prev"]()[0]!==itemElement&&!$.contains(this.placeholder[0],itemElement)&&(this.options.type==="semi-dynamic"?!$.contains(this.element[0],itemElement):true)){this.direction=intersection===1?"down":"up";if(this.options.tolerance==="pointer"||this._intersectsWithSides(item)){this._rearrange(event,item);}else{break;}
this._trigger("change",event,this._uiHash());break;}}
this._contactContainers(event);if($.ui.ddmanager){$.ui.ddmanager.drag(this,event);}
this._trigger("sort",event,this._uiHash());this.lastPositionAbs=this.positionAbs;return false;},_mouseStop:function(event,noPropagation){if(!event){return;}
if($.ui.ddmanager&&!this.options.dropBehaviour){$.ui.ddmanager.drop(this,event);}
if(this.options.revert){var that=this,cur=this.placeholder.offset();this.reverting=true;$(this.helper).animate({left:cur.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft),top:cur.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){that._clear(event);});}else{this._clear(event,noPropagation);}
return false;},cancel:function(){if(this.dragging){this._mouseUp({target:null});if(this.options.helper==="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");}else{this.currentItem.show();}
for(var i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("deactivate",null,this._uiHash(this));if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",null,this._uiHash(this));this.containers[i].containerCache.over=0;}}}
if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0]);}
if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove();}
$.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){$(this.domPosition.prev).after(this.currentItem);}else{$(this.domPosition.parent).prepend(this.currentItem);}}
return this;},serialize:function(o){var items=this._getItemsAsjQuery(o&&o.connected),str=[];o=o||{};$(items).each(function(){var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||(/(.+)[\-=_](.+)/));if(res){str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]));}});if(!str.length&&o.key){str.push(o.key+"=");}
return str.join("&");},toArray:function(o){var items=this._getItemsAsjQuery(o&&o.connected),ret=[];o=o||{};items.each(function(){ret.push($(o.item||this).attr(o.attribute||"id")||"");});return ret;},_intersectsWith:function(item){var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height,l=item.left,r=l+item.width,t=item.top,b=t+item.height,dyClick=this.offset.click.top,dxClick=this.offset.click.left,isOverElement=(y1+dyClick)>t&&(y1+dyClick)<b&&(x1+dxClick)>l&&(x1+dxClick)<r;if(this.options.tolerance==="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"])){return isOverElement;}else{return(l<x1+(this.helperProportions.width/2)&&x2-(this.helperProportions.width/2)<r&&t<y1+(this.helperProportions.height/2)&&y2-(this.helperProportions.height/2)<b);}},_intersectsWithPointer:function(item){var isOverElementHeight=(this.options.axis==="x")||isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),isOverElementWidth=(this.options.axis==="y")||isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width),isOverElement=isOverElementHeight&&isOverElementWidth,verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();if(!isOverElement){return false;}
return this.floating?(((horizontalDirection&&horizontalDirection==="right")||verticalDirection==="down")?2:1):(verticalDirection&&(verticalDirection==="down"?2:1));},_intersectsWithSides:function(item){var isOverBottomHalf=isOverAxis(this.positionAbs.top+this.offset.click.top,item.top+(item.height/2),item.height),isOverRightHalf=isOverAxis(this.positionAbs.left+this.offset.click.left,item.left+(item.width/2),item.width),verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();if(this.floating&&horizontalDirection){return((horizontalDirection==="right"&&isOverRightHalf)||(horizontalDirection==="left"&&!isOverRightHalf));}else{return verticalDirection&&((verticalDirection==="down"&&isOverBottomHalf)||(verticalDirection==="up"&&!isOverBottomHalf));}},_getDragVerticalDirection:function(){var delta=this.positionAbs.top-this.lastPositionAbs.top;return delta!==0&&(delta>0?"down":"up");},_getDragHorizontalDirection:function(){var delta=this.positionAbs.left-this.lastPositionAbs.left;return delta!==0&&(delta>0?"right":"left");},refresh:function(event){this._refreshItems(event);this.refreshPositions();return this;},_connectWith:function(){var options=this.options;return options.connectWith.constructor===String?[options.connectWith]:options.connectWith;},_getItemsAsjQuery:function(connected){var i,j,cur,inst,items=[],queries=[],connectWith=this._connectWith();if(connectWith&&connected){for(i=connectWith.length-1;i>=0;i--){cur=$(connectWith[i]);for(j=cur.length-1;j>=0;j--){inst=$.data(cur[j],this.widgetFullName);if(inst&&inst!==this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst]);}}}}
queries.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(i=queries.length-1;i>=0;i--){queries[i][0].each(function(){items.push(this);});}
return $(items);},_removeCurrentsFromItems:function(){var list=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=$.grep(this.items,function(item){for(var j=0;j<list.length;j++){if(list[j]===item.item[0]){return false;}}
return true;});},_refreshItems:function(event){this.items=[];this.containers=[this];var i,j,cur,inst,targetData,_queries,item,queriesLength,items=this.items,queries=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],event,{item:this.currentItem}):$(this.options.items,this.element),this]],connectWith=this._connectWith();if(connectWith&&this.ready){for(i=connectWith.length-1;i>=0;i--){cur=$(connectWith[i]);for(j=cur.length-1;j>=0;j--){inst=$.data(cur[j],this.widgetFullName);if(inst&&inst!==this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],event,{item:this.currentItem}):$(inst.options.items,inst.element),inst]);this.containers.push(inst);}}}}
for(i=queries.length-1;i>=0;i--){targetData=queries[i][1];_queries=queries[i][0];for(j=0,queriesLength=_queries.length;j<queriesLength;j++){item=$(_queries[j]);item.data(this.widgetName+"-item",targetData);items.push({item:item,instance:targetData,width:0,height:0,left:0,top:0});}}},refreshPositions:function(fast){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset();}
var i,item,t,p;for(i=this.items.length-1;i>=0;i--){item=this.items[i];if(item.instance!==this.currentContainer&&this.currentContainer&&item.item[0]!==this.currentItem[0]){continue;}
t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item;if(!fast){item.width=t.outerWidth();item.height=t.outerHeight();}
p=t.offset();item.left=p.left;item.top=p.top;}
if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this);}else{for(i=this.containers.length-1;i>=0;i--){p=this.containers[i].element.offset();this.containers[i].containerCache.left=p.left;this.containers[i].containerCache.top=p.top;this.containers[i].containerCache.width=this.containers[i].element.outerWidth();this.containers[i].containerCache.height=this.containers[i].element.outerHeight();}}
return this;},_createPlaceholder:function(that){that=that||this;var className,o=that.options;if(!o.placeholder||o.placeholder.constructor===String){className=o.placeholder;o.placeholder={element:function(){var el=$(document.createElement(that.currentItem[0].nodeName)).addClass(className||that.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];if(!className){el.style.visibility="hidden";}
return el;},update:function(container,p){if(className&&!o.forcePlaceholderSize){return;}
if(!p.height()){p.height(that.currentItem.innerHeight()-parseInt(that.currentItem.css("paddingTop")||0,10)-parseInt(that.currentItem.css("paddingBottom")||0,10));}
if(!p.width()){p.width(that.currentItem.innerWidth()-parseInt(that.currentItem.css("paddingLeft")||0,10)-parseInt(that.currentItem.css("paddingRight")||0,10));}}};}
that.placeholder=$(o.placeholder.element.call(that.element,that.currentItem));that.currentItem.after(that.placeholder);o.placeholder.update(that,that.placeholder);},_contactContainers:function(event){var i,j,dist,itemWithLeastDistance,posProperty,sizeProperty,base,cur,nearBottom,innermostContainer=null,innermostIndex=null;for(i=this.containers.length-1;i>=0;i--){if($.contains(this.currentItem[0],this.containers[i].element[0])){continue;}
if(this._intersectsWith(this.containers[i].containerCache)){if(innermostContainer&&$.contains(this.containers[i].element[0],innermostContainer.element[0])){continue;}
innermostContainer=this.containers[i];innermostIndex=i;}else{if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",event,this._uiHash(this));this.containers[i].containerCache.over=0;}}}
if(!innermostContainer){return;}
if(this.containers.length===1){this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1;}else{dist=10000;itemWithLeastDistance=null;posProperty=this.containers[innermostIndex].floating?"left":"top";sizeProperty=this.containers[innermostIndex].floating?"width":"height";base=this.positionAbs[posProperty]+this.offset.click[posProperty];for(j=this.items.length-1;j>=0;j--){if(!$.contains(this.containers[innermostIndex].element[0],this.items[j].item[0])){continue;}
if(this.items[j].item[0]===this.currentItem[0]){continue;}
cur=this.items[j].item.offset()[posProperty];nearBottom=false;if(Math.abs(cur-base)>Math.abs(cur+this.items[j][sizeProperty]-base)){nearBottom=true;cur+=this.items[j][sizeProperty];}
if(Math.abs(cur-base)<dist){dist=Math.abs(cur-base);itemWithLeastDistance=this.items[j];this.direction=nearBottom?"up":"down";}}
if(!itemWithLeastDistance&&!this.options.dropOnEmpty){return;}
this.currentContainer=this.containers[innermostIndex];itemWithLeastDistance?this._rearrange(event,itemWithLeastDistance,null,true):this._rearrange(event,null,this.containers[innermostIndex].element,true);this._trigger("change",event,this._uiHash());this.containers[innermostIndex]._trigger("change",event,this._uiHash(this));this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1;}},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event,this.currentItem])):(o.helper==="clone"?this.currentItem.clone():this.currentItem);if(!helper.parents("body").length){$(o.appendTo!=="parent"?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(helper[0]);}
if(helper[0]===this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")};}
if(!helper[0].style.width||o.forceHelperSize){helper.width(this.currentItem.width());}
if(!helper[0].style.height||o.forceHelperSize){helper.height(this.currentItem.height());}
return helper;},_adjustOffsetFromHelper:function(obj){if(typeof obj==="string"){obj=obj.split(" ");}
if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0};}
if("left"in obj){this.offset.click.left=obj.left+this.margins.left;}
if("right"in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left;}
if("top"in obj){this.offset.click.top=obj.top+this.margins.top;}
if("bottom"in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top;}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop();}
if(this.offsetParent[0]===document.body||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&$.ui.ie)){po={top:0,left:0};}
return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var p=this.currentItem.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()};}else{return{top:0,left:0};}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)};},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};},_setContainment:function(){var ce,co,over,o=this.options;if(o.containment==="parent"){o.containment=this.helper[0].parentNode;}
if(o.containment==="document"||o.containment==="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,$(o.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,($(o.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];}
if(!(/^(document|window|parent)$/).test(o.containment)){ce=$(o.containment)[0];co=$(o.containment).offset();over=($(ce).css("overflow")!=="hidden");this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top];}},_convertPositionTo:function(d,pos){if(!pos){pos=this.position;}
var mod=d==="absolute"?1:-1,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);return{top:(pos.top+
this.offset.relative.top*mod+
this.offset.parent.top*mod-
((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop()))*mod)),left:(pos.left+
this.offset.relative.left*mod+
this.offset.parent.left*mod-
((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod))};},_generatePosition:function(event){var top,left,o=this.options,pageX=event.pageX,pageY=event.pageY,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0])){this.offset.relative=this._getRelativeOffset();}
if(this.originalPosition){if(this.containment){if(event.pageX-this.offset.click.left<this.containment[0]){pageX=this.containment[0]+this.offset.click.left;}
if(event.pageY-this.offset.click.top<this.containment[1]){pageY=this.containment[1]+this.offset.click.top;}
if(event.pageX-this.offset.click.left>this.containment[2]){pageX=this.containment[2]+this.offset.click.left;}
if(event.pageY-this.offset.click.top>this.containment[3]){pageY=this.containment[3]+this.offset.click.top;}}
if(o.grid){top=this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1];pageY=this.containment?((top-this.offset.click.top>=this.containment[1]&&top-this.offset.click.top<=this.containment[3])?top:((top-this.offset.click.top>=this.containment[1])?top-o.grid[1]:top+o.grid[1])):top;left=this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0];pageX=this.containment?((left-this.offset.click.left>=this.containment[0]&&left-this.offset.click.left<=this.containment[2])?left:((left-this.offset.click.left>=this.containment[0])?left-o.grid[0]:left+o.grid[0])):left;}}
return{top:(pageY-
this.offset.click.top-
this.offset.relative.top-
this.offset.parent.top+
((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop())))),left:(pageX-
this.offset.click.left-
this.offset.relative.left-
this.offset.parent.left+
((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())))};},_rearrange:function(event,i,a,hardRefresh){a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction==="down"?i.item[0]:i.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var counter=this.counter;this._delay(function(){if(counter===this.counter){this.refreshPositions(!hardRefresh);}});},_clear:function(event,noPropagation){this.reverting=false;var i,delayedTriggers=[];if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem);}
this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(i in this._storedCSS){if(this._storedCSS[i]==="auto"||this._storedCSS[i]==="static"){this._storedCSS[i]="";}}
this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");}else{this.currentItem.show();}
if(this.fromOutside&&!noPropagation){delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside));});}
if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!noPropagation){delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash());});}
if(this!==this.currentContainer){if(!noPropagation){delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash());});delayedTriggers.push((function(c){return function(event){c._trigger("receive",event,this._uiHash(this));};}).call(this,this.currentContainer));delayedTriggers.push((function(c){return function(event){c._trigger("update",event,this._uiHash(this));};}).call(this,this.currentContainer));}}
for(i=this.containers.length-1;i>=0;i--){if(!noPropagation){delayedTriggers.push((function(c){return function(event){c._trigger("deactivate",event,this._uiHash(this));};}).call(this,this.containers[i]));}
if(this.containers[i].containerCache.over){delayedTriggers.push((function(c){return function(event){c._trigger("out",event,this._uiHash(this));};}).call(this,this.containers[i]));this.containers[i].containerCache.over=0;}}
if(this._storedCursor){$("body").css("cursor",this._storedCursor);}
if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity);}
if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex);}
this.dragging=false;if(this.cancelHelperRemoval){if(!noPropagation){this._trigger("beforeStop",event,this._uiHash());for(i=0;i<delayedTriggers.length;i++){delayedTriggers[i].call(this,event);}
this._trigger("stop",event,this._uiHash());}
this.fromOutside=false;return false;}
if(!noPropagation){this._trigger("beforeStop",event,this._uiHash());}
this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(this.helper[0]!==this.currentItem[0]){this.helper.remove();}
this.helper=null;if(!noPropagation){for(i=0;i<delayedTriggers.length;i++){delayedTriggers[i].call(this,event);}
this._trigger("stop",event,this._uiHash());}
this.fromOutside=false;return true;},_trigger:function(){if($.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel();}},_uiHash:function(_inst){var inst=_inst||this;return{helper:inst.helper,placeholder:inst.placeholder||$([]),position:inst.position,originalPosition:inst.originalPosition,offset:inst.positionAbs,item:inst.currentItem,sender:_inst?_inst.element:null};}});})(jQuery);var ClBackbone=$CL.namespace("Cl.Backbone");$CL.require("Cl.Backbone.View");ClBackbone.BlockingView=function(){};ClBackbone.BlockingView=$CL.extendClass(ClBackbone.BlockingView,Cl.Backbone.View,{renderingIsBlocked:false,renderingQueued:false,blockRendering:function(){this.renderingIsBlocked=true;},stopBlocking:function(){this.renderingIsBlocked=false;if(this.renderingQueued){this.render();this.renderingQueued=false;}},render:function(){if(!this.renderingIsBlocked){Cl.Backbone.View.prototype.render.apply(this);}else{this.renderingQueued=true;}}});var Partial=$CL.namespace('Ginger.Application.View.Partial');$CL.require("Cl.Backbone.BlockingView");$CL.require("Cl.Jquery.Plugin.Ui.Sortable");Partial.StructureMapperOptions=function(){};Partial.StructureMapperOptions=$CL.extendClass(Partial.StructureMapperOptions,Cl.Backbone.BlockingView,{events:{'click .js-mapper-column-ok':'onColumnOkClick','click .js-mapper-columns .js-remove':'onColumnRemoveClick','click .js-mapper-columns .js-edit':'onColumnEditClick'},setData:function(data){if($CL.isDefined(data.elementData.options['mapping'])){var definedSourceColumns=[];var definedTargetColumns=[];$.each(data.elementData.options.mapping,$CL.bind(function(sourceColumn,targetColumn){definedSourceColumns.push(sourceColumn);definedTargetColumns.push(targetColumn);},this));data.sourceInfo.data_structure=_.filter(data.sourceInfo.data_structure,function(columnDesc){return _.contains(definedSourceColumns,columnDesc.name)!=true;});data.targetInfo.data_structure=_.filter(data.targetInfo.data_structure,function(columnDesc){return _.contains(definedTargetColumns,columnDesc.name)!=true;});}
this.data=data;},onColumnOkClick:function(e){e.preventDefault();var $tr=$(e.target).parents('.ts-tr'),$sourceSelect=$tr.find('.js-source-td').find('select'),sourceColumn=$sourceSelect.val(),$targetSelect=$tr.find('.js-target-td').find('select'),targetColumn=$targetSelect.val(),$dataTr=$tr.clone();$dataTr.removeAttr('id').addClass('js-mapper-columns');$dataTr.find('.js-source-td').html(sourceColumn);$dataTr.find('.js-target-td').html(targetColumn).next().html($CL._template('application_edit_remove')({id:0}));$tr.before($dataTr);$sourceSelect.find('option').each(function(i,option){if($(option).html()==sourceColumn){$(option).remove();}});if($sourceSelect.find('option').length==0){$tr.addClass('hide');}
$targetSelect.find('option').each(function(i,option){if($(option).html()==targetColumn){$(option).remove();}});if($targetSelect.find('option').length==0){$tr.addClass('hide');}
if($tr.parent().find('tr').last()[0]!=$tr[0]){$tr.parent().find('tr').last().after($tr);}},onColumnRemoveClick:function(e){e.preventDefault();var $tr=$(e.target).parents('.ts-tr'),sourceColumn=$tr.find('.js-source-td').html(),targetColumn=$tr.find('.js-target-td').html(),$sourceSelect=$('#js-mapper-column-chooser').find('.js-source-td').find('select'),$targetSelect=$('#js-mapper-column-chooser').find('.js-target-td').find('select');$sourceSelect.append($('<option />').html(sourceColumn));$targetSelect.append($('<option />').html(targetColumn));$tr.remove();$('#js-mapper-column-chooser').removeClass('hide');},onColumnEditClick:function(e){e.preventDefault();var $tr=$(e.target).parents('.ts-tr'),sourceColumn=$tr.find('.js-source-td').html(),targetColumn=$tr.find('.js-target-td').html(),$sourceSelect=$('#js-mapper-column-chooser').find('.js-source-td').find('select'),$targetSelect=$('#js-mapper-column-chooser').find('.js-target-td').find('select');$sourceSelect.append($('<option />').html(sourceColumn).attr('selected',true));$targetSelect.append($('<option />').html(targetColumn).attr('selected',true));$tr.replaceWith($('#js-mapper-column-chooser').removeClass('hide'));}});var Helper=$CL.namespace("Ginger.Application.View.Helper");$CL.require("Cl.Backbone.View");Helper.Breadcrumbs=function(){};Helper.Breadcrumbs=$CL.extendClass(Helper.Breadcrumbs,Cl.Backbone.View,{initialize:function(){this.$el=$('#js_breadcrumbs');},data:{links:[]},setData:function(data){if(!$CL.isEmpty(data)){if(data[0].label!="Dashboard"){data.unshift({link:helpers.uri('dashboard'),label:'Ginger'});}
this.data={links:data};}}});var Partial=$CL.namespace('Ginger.Application.View.Partial');$CL.require('Cl.Backbone.View');Partial.ActiveUser=function(){};Partial.ActiveUser=$CL.extendClass(Partial.ActiveUser,Cl.Backbone.View);var Auth=$CL.namespace('Ginger.Application.View.Auth');$CL.require('Cl.Backbone.FormView');$CL.require('Cl.Form.View.InputText');$CL.require('Cl.Form.View.Password');Auth.Login=function(){};Auth.Login=$CL.extendClass(Auth.Login,Cl.Backbone.FormView);var Form=$CL.namespace('Ginger.Application.Form');$CL.require('Cl.Form.Form');$CL.require('Cl.Form.Element.Email');Form.Login=function(){};Form.Login=$CL.extendClass(Form.Login,Cl.Form.Form,{name:"Login",init:function(){this.elements=[$CL.makeObj('Cl.Form.Element.Email',{'name':'email','label':$CL.translate('LOGIN::FORM::LABEL::EMAIL')}),$CL.makeObj('Cl.Form.Element.Text',{'name':'password','label':$CL.translate('LOGIN::FORM::LABEL::PASSWORD')})]}});var ModuleElement=$CL.namespace('Ginger.Application.Service.ModuleElement');ModuleElement.ElementInterface=function(){};ModuleElement.ElementInterface.prototype={getOptionsView:function(elementData){},collectOptions:function(){},getHelpView:function(elementData){}};var Feature=$CL.namespace('Ginger.Application.Model.Feature');$CL.require("Ginger.Application.Service.ModuleElement.ElementInterface");Feature.AbstractFeature=function(){this.optionsView=null;this.helpView=null;};Feature.AbstractFeature.prototype={__IMPLEMENTS__:[Ginger.Application.Service.ModuleElement.ElementInterface],setOptionsView:function(optionsView){this.optionsView=optionsView;this.optionsView.setModel(this);},getOptionsView:function(elementData){this.optionsView.setData($CL.clone(elementData));return this.optionsView;},setHelpView:function(helpView){this.helpView=helpView;},getHelpView:function(){return this.helpView;},collectOptions:function(){var advancedOptions=this.collectAdvancedOptions();if(!advancedOptions){return null;}
var siteToAlter=this.optionsView.$el.find('input[name=feature-site-to-alter]').filter('input[checked=checked]').val();if(!siteToAlter){this.optionsView.setSiteToAlterError();return null;}
var attributesToAlter=[];this.optionsView.$el.find('.js-feature-attributes .js-attribute-tr').each(function(i,tr){attributesToAlter.push($(tr).children().first().html());});if(attributesToAlter.length==0){this.optionsView.setAttributesToAlterError();return null;}
return _.extend({site_to_alter:siteToAlter,attributes_to_alter:attributesToAlter},advancedOptions);},collectAdvancedOptions:function(){return{};}};var Feature=$CL.namespace('Ginger.Application.Model.Feature');$CL.require('Ginger.Application.Model.Feature.AbstractFeature');Feature.StaticValueFeature=function(){};Feature.StaticValueFeature=$CL.extendClass(Feature.StaticValueFeature,Feature.AbstractFeature,{collectAdvancedOptions:function(){var staticValue=this.optionsView.advancedOptionsView.$el.find('input[name=staticvalue-value]').val();return{static_value:staticValue};}});var Feature=$CL.namespace('Ginger.Application.Model.Feature');$CL.require("Ginger.Application.Service.ModuleElement.ElementInterface");Feature.AttributeMapFeature=function(){this.optionsView=null;this.helpView=null;};Feature.AttributeMapFeature.prototype={__IMPLEMENTS__:[Ginger.Application.Service.ModuleElement.ElementInterface],setOptionsView:function(optionsView){this.optionsView=optionsView;},setHelpView:function(helpView){this.helpView=helpView;},getOptionsView:function(elementData){this.optionsView.setData($CL.clone(elementData));return this.optionsView;},getHelpView:function(){return this.helpView;},collectOptions:function(){var $table=$('#js-attributemap');var mapping={};$table.find('.ts-tr').each(function(i,tr){var $tr=$(tr);if($tr.attr('id')!="js-attributemap-column-chooser"&&!$tr.children().first().hasClass('ts-th')){mapping[$tr.find('.js-source-td').html()]=$tr.find('.js-target-td').html();}});return{'attribute_map':mapping};}}
var Feature=$CL.namespace('Ginger.Application.Model.Feature');$CL.require('Ginger.Application.Model.Feature.AbstractFeature');Feature.FilterFeature=function(){};Feature.FilterFeature=$CL.extendClass(Feature.FilterFeature,Feature.AbstractFeature);var Feature=$CL.namespace('Ginger.Application.Model.Feature');$CL.require('Ginger.Application.Model.Feature.AbstractFeature');Feature.ValidatorFeature=function(){};Feature.ValidatorFeature=$CL.extendClass(Feature.ValidatorFeature,Feature.AbstractFeature,{collectAdvancedOptions:function(){var errorHandling=this.optionsView.advancedOptionsView.$el.find('input[name=validator-error-handling]').filter('input[checked=checked]').val();return{error_handling:errorHandling};}});var Script=$CL.namespace("Ginger.Application.Model.Script");$CL.require("Ginger.Application.Service.ModuleElement.ElementInterface");Script.DevNullTarget=function(){this.optionsView=null;};Script.DevNullTarget.prototype={__IMPLEMENTS__:[Ginger.Application.Service.ModuleElement.ElementInterface],setOptionsView:function(optionsView){this.optionsView=optionsView;},getOptionsView:function(elementData){this.optionsView.setData(elementData);return this.optionsView;},getHelpView:function(){return null;},collectOptions:function(){return{log_file_name:$('input[name=devnull-log-file-name]').val()};}}
var Script=$CL.namespace("Ginger.Application.Model.Script");$CL.require("Ginger.Application.Service.ModuleElement.ElementInterface");Script.SourceScript=function(){this.optionsView=null;};Script.SourceScript.prototype={__IMPLEMENTS__:[Ginger.Application.Service.ModuleElement.ElementInterface],setOptionsView:function(optionsView){this.optionsView=optionsView;},getOptionsView:function(elementData){this.optionsView.setData(elementData);return this.optionsView;},getHelpView:function(){return null;},collectOptions:function(){return{script_name:$('input[name=sourcescript-script-name]').val()};}}
var Directory=$CL.namespace('Ginger.Application.Model.Directory');$CL.require("Ginger.Application.Service.ModuleElement.ElementInterface");Directory.TargetDirectory=function(){this.optionsView=null;};Directory.TargetDirectory.prototype={__IMPLEMENTS__:[Ginger.Application.Service.ModuleElement.ElementInterface],setOptionsView:function(optionsView){this.optionsView=optionsView;},getOptionsView:function(elementData){this.optionsView.setData(elementData);return this.optionsView;},getHelpView:function(){return null;},collectOptions:function(){return this.optionsView.collectOptions();}}
var Directory=$CL.namespace('Ginger.Application.Model.Directory');$CL.require("Ginger.Application.Service.ModuleElement.ElementInterface");Directory.SourceDirectory=function(){this.optionsView=null;};Directory.SourceDirectory.prototype={__IMPLEMENTS__:[Ginger.Application.Service.ModuleElement.ElementInterface],setOptionsView:function(optionsView){this.optionsView=optionsView;},getOptionsView:function(elementData){this.optionsView.setData(elementData);return this.optionsView;},getHelpView:function(){return null;},collectOptions:function(){return this.optionsView.collectOptions();}}
var File=$CL.namespace("Ginger.Application.Model.File");$CL.require("Ginger.Application.Service.ModuleElement.ElementInterface");File.SourceFile=function(){this.optionsView=null;};File.SourceFile.prototype={__IMPLEMENTS__:[Ginger.Application.Service.ModuleElement.ElementInterface],setOptionsView:function(optionsView){this.optionsView=optionsView;},getOptionsView:function(elementData){this.optionsView.setData(elementData);return this.optionsView;},getHelpView:function(){return null;},collectOptions:function(){return{file_pattern:$('input[name=sourcefile-file-pattern]').val()};}}
var Mapper=$CL.namespace('Ginger.Application.Model.Mapper');$CL.require("Ginger.Application.Service.ModuleElement.ElementInterface");$CL.require("Ginger.Application.View.Partial.StructureMapperOptions");$CL.require("Cl.Ajax.Queue");Mapper.StructureMapper=function(){this.mapping={};this.disabledKeys={};this.optionsView=null;this.lastSourceId=null;this.sourceInfoData=null;this.lastTargetId=null;this.targetInfoData=null;this.sourceInfoCollection=null;this.targetInfoCollection=null;};Mapper.StructureMapper.prototype={__IMPLEMENTS__:[Ginger.Application.Service.ModuleElement.ElementInterface],jobname:null,configurationId:null,setOptionsView:function(optionsView){this.optionsView=optionsView;},setSourceInfoCollection:function(sourceInfoCollection){this.sourceInfoCollection=sourceInfoCollection;},setTargetInfoCollection:function(targetInfoCollection){this.targetInfoCollection=targetInfoCollection;},setJobname:function(jobname){this.jobname=jobname;},setConfigurationId:function(configId){this.configurationId=configId;},getOptionsView:function(elementData){var sourceId=$('select[name=source]').val();var targetId=$('select[name=target]').val();var queue=$CL.makeObj('Cl.Ajax.Queue');queue.events().attach("start",function(){$CL.app().wait();},0,true);if(this.lastSourceId!=sourceId||(!_.isNull(this.jobname)&&!_.isNull(this.configurationId))){this.lastSourceId=sourceId;if(!_.isNull(this.jobname)&&!_.isNull(this.configurationId)){queue.addJqXhr($.get(this.sourceInfoCollection.url
+'/'+sourceId
+'/'+this.jobname
+'/'+this.configurationId,$CL.bind(function(response){this.sourceInfoData=response;},this),"json").fail(function(jqX){$CL.app().alert('Failed to fetch source info for source: '+sourceId,jqX);}));}else{var sourceInfo=this.sourceInfoCollection.get(sourceId);if(!sourceInfo){this.sourceInfoCollection.add({id:sourceId});sourceInfo=this.sourceInfoCollection.get(sourceId);queue.addJqXhr(sourceInfo.fetch({success:$CL.bind(function(model){this.sourceInfoData=model.toJSON();},this)}).fail(function(jqX){$CL.app().alert('Failed to fetch source info for source: '+sourceId,jqX);}));}else{this.sourceInfoData=sourceInfo.toJSON();}}}
if(this.lastTargetId!=targetId||(!_.isNull(this.jobname)&&!_.isNull(this.configurationId))){this.lastTargetId=targetId;if(!_.isNull(this.jobname)&&!_.isNull(this.configurationId)){queue.addJqXhr($.get(this.targetInfoCollection.url
+'/'+targetId
+'/'+this.jobname
+'/'+this.configurationId,$CL.bind(function(response){this.targetInfoData=response;},this),"json").fail(function(jqX){$CL.app().alert('Failed to fetch target info for target: '+targetId,jqX);}));}else{var targetInfo=this.targetInfoCollection.get(targetId);if(!targetInfo){this.targetInfoCollection.add({id:targetId});targetInfo=this.targetInfoCollection.get(targetId);queue.addJqXhr(targetInfo.fetch({success:$CL.bind(function(model){this.targetInfoData=model.toJSON();},this)}).fail(function(jqX){$CL.app().alert('Failed to fetch target info for target: '+targetId,jqX);}));}else{this.targetInfoData=targetInfo.toJSON();}}}
queue.setFinishCallback($CL.bind(function(){this.optionsView.setData({elementData:$CL.clone(elementData),sourceInfo:$CL.clone(this.sourceInfoData),targetInfo:$CL.clone(this.targetInfoData)});this.optionsView.stopBlocking();$CL.app().stopWait();},this));this.optionsView.blockRendering();queue.close();return this.optionsView;},getHelpView:function(){return null;},collectOptions:function(){var $table=$('#js-table-structure-mapping');var mapping={};$table.find('.ts-tr').each(function(i,tr){var $tr=$(tr);if($tr.attr('id')!="js-mapper-column-chooser"&&!$tr.children().first().hasClass('ts-th')){mapping[$tr.find('.js-source-td').html()]=$tr.find('.js-target-td').html();}});return{mapping:mapping};}}
var ClBackbone=$CL.namespace("Cl.Backbone");$CL.require("Cl.Backbone.Backbone");$CL.require("Cl.Event.Manager");$CL.require("Cl.Event.Event");$CL.require("Cl.Event.EventManagerProvider");ClBackbone.Model=function ClBackboneModel(){};ClBackbone.Model=$CL.extendClass(ClBackbone.Model,Backbone.Model,{setup:function(){this.on("all",$CL.bind(this.triggerClEvent,this));},getParams:function(){return _.clone(this.attributes);},triggerClEvent:function(){var eventName=arguments[0];var newArgs=[];for(var i in arguments){if(i!=0)
newArgs[newArgs.length]=arguments[i];}
var event=$CL.get("Cl.Event.Event",{params:{arguments:newArgs},name:eventName});this.events().trigger(event);}});_.extend(ClBackbone.Model.prototype,Cl.Event.EventManagerProvider);var Entity=$CL.namespace('Ginger.Application.Entity');$CL.require('Cl.Backbone.Model');Entity.User=function(){};Entity.User=$CL.extendClass(Entity.User,Cl.Backbone.Model);var User=$CL.namespace('Ginger.Application.Model.User');$CL.require('Ginger.Application.Entity.User');User.UserManager=function(){};User.UserManager.prototype={activeUser:null,authAdpater:null,usersCollection:null,setAuthAdapter:function(authAdapter){this.authAdpater=authAdapter;},setUsersCollection:function(usersCollection){this.usersCollection=usersCollection;},getActiveUser:function(){if(_.isNull(this.activeUser)&&!_.isNull(this.authAdpater.activeApiKey)){$CL.app().wait();var activeUser=$CL.makeObj('Ginger.Application.Entity.User');var jqXhr=$CL.sjax().get('/rest/users/-1',function(data){activeUser.set(data);},'json');jqXhr.fail(function(jqXhr){$CL.app().alert('Failed to fetch data for active user',jqXhr);});$CL.app().stopWait();this.usersCollection.add(activeUser);this.activeUser=activeUser;}
return this.activeUser;},logoutUser:function(){this.activeUser=null;this.authAdpater.clearCredentials();}};var Collection=$CL.namespace('Ginger.Application.Collection');$CL.require("Cl.Backbone.Collection");$CL.require("Ginger.Application.Entity.User");Collection.Users=function(){};Collection.Users=$CL.extendClass(Collection.Users,Cl.Backbone.Collection,{url:"/rest/users",modelClass:"Ginger.Application.Entity.User",model:Ginger.Application.Entity.User});var Entity=$CL.namespace('Ginger.Application.Entity');$CL.require('Cl.Backbone.Model');Entity.Module=function(){};Entity.Module=$CL.extendClass(Entity.Module,Cl.Backbone.Model,{idAttribute:'module'});var Collection=$CL.namespace('Ginger.Application.Collection');$CL.require("Cl.Backbone.Collection");$CL.require("Ginger.Application.Entity.Module");Collection.Modules=function(){};Collection.Modules=$CL.extendClass(Collection.Modules,Cl.Backbone.Collection,{url:"/rest/modules",modelClass:"Ginger.Application.Entity.Module",model:Ginger.Application.Entity.Module});jQuery.store=(function(){var api={},win=window,doc=win.document,localStorageName='localStorage',globalStorageName='globalStorage',storage
api.disabled=false
api.set=function(key,value){}
api.get=function(key){}
api.remove=function(key){}
api.clear=function(){}
api.transact=function(key,transactionFn){var val=api.get(key)
if(typeof val=='undefined'){val={}}
transactionFn(val)
api.set(key,val)}
api.serialize=function(value){return JSON.stringify(value)}
api.deserialize=function(value){if(typeof value!='string'){return undefined}
return JSON.parse(value)}
function isLocalStorageNameSupported(){try{return(localStorageName in win&&win[localStorageName])}
catch(err){return false}}
function isGlobalStorageNameSupported(){try{return(globalStorageName in win&&win[globalStorageName]&&win[globalStorageName][win.location.hostname])}
catch(err){return false}}
if(isLocalStorageNameSupported()){storage=win[localStorageName]
api.set=function(key,val){storage.setItem(key,api.serialize(val))}
api.get=function(key){return api.deserialize(storage.getItem(key))}
api.remove=function(key){storage.removeItem(key)}
api.clear=function(){storage.clear()}}else if(isGlobalStorageNameSupported()){storage=win[globalStorageName][win.location.hostname]
api.set=function(key,val){storage[key]=api.serialize(val)}
api.get=function(key){return api.deserialize(storage[key]&&storage[key].value)}
api.remove=function(key){delete storage[key]}
api.clear=function(){for(var key in storage){delete storage[key]}}}else if(doc.documentElement.addBehavior){var storage=doc.createElement('div')
function withIEStorage(storeFunction){return function(){var args=Array.prototype.slice.call(arguments,0)
args.unshift(storage)
doc.body.appendChild(storage)
storage.addBehavior('#default#userData')
storage.load(localStorageName)
var result=storeFunction.apply(api,args)
doc.body.removeChild(storage)
return result}}
api.set=withIEStorage(function(storage,key,val){storage.setAttribute(key,api.serialize(val))
storage.save(localStorageName)})
api.get=withIEStorage(function(storage,key){return api.deserialize(storage.getAttribute(key))})
api.remove=withIEStorage(function(storage,key){storage.removeAttribute(key)
storage.save(localStorageName)})
api.clear=withIEStorage(function(storage){var attributes=storage.XMLDocument.documentElement.attributes
storage.load(localStorageName)
for(var i=0,attr;attr=attributes[i];i++){storage.removeAttribute(attr.name)}
storage.save(localStorageName)})}else{api.disabled=true}
return api})();var CryptoJS=CryptoJS||function(g,l){var e={},d=e.lib={},m=function(){},k=d.Base={extend:function(a){m.prototype=this;var c=new m;a&&c.mixIn(a);c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)});c.init.prototype=c;c.$super=this;return c},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},p=d.WordArray=k.extend({init:function(a,c){a=this.words=a||[];this.sigBytes=c!=l?c:4*a.length},toString:function(a){return(a||n).stringify(this)},concat:function(a){var c=this.words,q=a.words,f=this.sigBytes;a=a.sigBytes;this.clamp();if(f%4)for(var b=0;b<a;b++)c[f+b>>>2]|=(q[b>>>2]>>>24-8*(b%4)&255)<<24-8*((f+b)%4);else if(65535<q.length)for(b=0;b<a;b+=4)c[f+b>>>2]=q[b>>>2];else c.push.apply(c,q);this.sigBytes+=a;return this},clamp:function(){var a=this.words,c=this.sigBytes;a[c>>>2]&=4294967295<<32-8*(c%4);a.length=g.ceil(c/4)},clone:function(){var a=k.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var c=[],b=0;b<a;b+=4)c.push(4294967296*g.random()|0);return new p.init(c,a)}}),b=e.enc={},n=b.Hex={stringify:function(a){var c=a.words;a=a.sigBytes;for(var b=[],f=0;f<a;f++){var d=c[f>>>2]>>>24-8*(f%4)&255;b.push((d>>>4).toString(16));b.push((d&15).toString(16))}return b.join("")},parse:function(a){for(var c=a.length,b=[],f=0;f<c;f+=2)b[f>>>3]|=parseInt(a.substr(f,2),16)<<24-4*(f%8);return new p.init(b,c/2)}},j=b.Latin1={stringify:function(a){var c=a.words;a=a.sigBytes;for(var b=[],f=0;f<a;f++)b.push(String.fromCharCode(c[f>>>2]>>>24-8*(f%4)&255));return b.join("")},parse:function(a){for(var c=a.length,b=[],f=0;f<c;f++)b[f>>>2]|=(a.charCodeAt(f)&255)<<24-8*(f%4);return new p.init(b,c)}},h=b.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(c){throw Error("Malformed UTF-8 data");}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},r=d.BufferedBlockAlgorithm=k.extend({reset:function(){this._data=new p.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=h.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var c=this._data,b=c.words,f=c.sigBytes,d=this.blockSize,e=f/(4*d),e=a?g.ceil(e):g.max((e|0)-this._minBufferSize,0);a=e*d;f=g.min(4*a,f);if(a){for(var k=0;k<a;k+=d)this._doProcessBlock(b,k);k=b.splice(0,a);c.sigBytes-=f}return new p.init(k,f)},clone:function(){var a=k.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});d.Hasher=r.extend({cfg:k.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){r.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,d){return(new a.init(d)).finalize(b)}},_createHmacHelper:function(a){return function(b,d){return(new s.HMAC.init(a,d)).finalize(b)}}});var s=e.algo={};return e}(Math);(function(){var g=CryptoJS,l=g.lib,e=l.WordArray,d=l.Hasher,m=[],l=g.algo.SHA1=d.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(d,e){for(var b=this._hash.words,n=b[0],j=b[1],h=b[2],g=b[3],l=b[4],a=0;80>a;a++){if(16>a)m[a]=d[e+a]|0;else{var c=m[a-3]^m[a-8]^m[a-14]^m[a-16];m[a]=c<<1|c>>>31}c=(n<<5|n>>>27)+l+m[a];c=20>a?c+((j&h|~j&g)+1518500249):40>a?c+((j^h^g)+1859775393):60>a?c+((j&h|j&g|h&g)-1894007588):c+((j^h^g)-899497514);l=g;g=h;h=j<<30|j>>>2;j=n;n=c}b[0]=b[0]+n|0;b[1]=b[1]+j|0;b[2]=b[2]+h|0;b[3]=b[3]+g|0;b[4]=b[4]+l|0},_doFinalize:function(){var d=this._data,e=d.words,b=8*this._nDataBytes,g=8*d.sigBytes;e[g>>>5]|=128<<24-g%32;e[(g+64>>>9<<4)+14]=Math.floor(b/4294967296);e[(g+64>>>9<<4)+15]=b;d.sigBytes=4*e.length;this._process();return this._hash},clone:function(){var e=d.clone.call(this);e._hash=this._hash.clone();return e}});g.SHA1=d._createHelper(l);g.HmacSHA1=d._createHmacHelper(l)})();(function(){var g=CryptoJS,l=g.enc.Utf8;g.algo.HMAC=g.lib.Base.extend({init:function(e,d){e=this._hasher=new e.init;"string"==typeof d&&(d=l.parse(d));var g=e.blockSize,k=4*g;d.sigBytes>k&&(d=e.finalize(d));d.clamp();for(var p=this._oKey=d.clone(),b=this._iKey=d.clone(),n=p.words,j=b.words,h=0;h<g;h++)n[h]^=1549556828,j[h]^=909522486;p.sigBytes=b.sigBytes=k;this.reset()},reset:function(){var e=this._hasher;e.reset();e.update(this._iKey)},update:function(e){this._hasher.update(e);return this},finalize:function(e){var d=this._hasher;e=d.finalize(e);d.reset();return d.finalize(this._oKey.clone().concat(e))}})})();var CryptoJS=CryptoJS||function(e,m){var p={},j=p.lib={},l=function(){},f=j.Base={extend:function(a){l.prototype=this;var c=new l;a&&c.mixIn(a);c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)});c.init.prototype=c;c.$super=this;return c},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},n=j.WordArray=f.extend({init:function(a,c){a=this.words=a||[];this.sigBytes=c!=m?c:4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var c=this.words,q=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var b=0;b<a;b++)c[d+b>>>2]|=(q[b>>>2]>>>24-8*(b%4)&255)<<24-8*((d+b)%4);else if(65535<q.length)for(b=0;b<a;b+=4)c[d+b>>>2]=q[b>>>2];else c.push.apply(c,q);this.sigBytes+=a;return this},clamp:function(){var a=this.words,c=this.sigBytes;a[c>>>2]&=4294967295<<32-8*(c%4);a.length=e.ceil(c/4)},clone:function(){var a=f.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var c=[],b=0;b<a;b+=4)c.push(4294967296*e.random()|0);return new n.init(c,a)}}),b=p.enc={},h=b.Hex={stringify:function(a){var c=a.words;a=a.sigBytes;for(var b=[],d=0;d<a;d++){var f=c[d>>>2]>>>24-8*(d%4)&255;b.push((f>>>4).toString(16));b.push((f&15).toString(16))}return b.join("")},parse:function(a){for(var c=a.length,b=[],d=0;d<c;d+=2)b[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return new n.init(b,c/2)}},g=b.Latin1={stringify:function(a){var c=a.words;a=a.sigBytes;for(var b=[],d=0;d<a;d++)b.push(String.fromCharCode(c[d>>>2]>>>24-8*(d%4)&255));return b.join("")},parse:function(a){for(var c=a.length,b=[],d=0;d<c;d++)b[d>>>2]|=(a.charCodeAt(d)&255)<<24-8*(d%4);return new n.init(b,c)}},r=b.Utf8={stringify:function(a){try{return decodeURIComponent(escape(g.stringify(a)))}catch(c){throw Error("Malformed UTF-8 data");}},parse:function(a){return g.parse(unescape(encodeURIComponent(a)))}},k=j.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new n.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=r.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var c=this._data,b=c.words,d=c.sigBytes,f=this.blockSize,h=d/(4*f),h=a?e.ceil(h):e.max((h|0)-this._minBufferSize,0);a=h*f;d=e.min(4*a,d);if(a){for(var g=0;g<a;g+=f)this._doProcessBlock(b,g);g=b.splice(0,a);c.sigBytes-=d}return new n.init(g,d)},clone:function(){var a=f.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});j.Hasher=k.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){k.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(c,b){return(new a.init(b)).finalize(c)}},_createHmacHelper:function(a){return function(b,f){return(new s.HMAC.init(a,f)).finalize(b)}}});var s=p.algo={};return p}(Math);(function(){var e=CryptoJS,m=e.lib,p=m.WordArray,j=m.Hasher,l=[],m=e.algo.SHA1=j.extend({_doReset:function(){this._hash=new p.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(f,n){for(var b=this._hash.words,h=b[0],g=b[1],e=b[2],k=b[3],j=b[4],a=0;80>a;a++){if(16>a)l[a]=f[n+a]|0;else{var c=l[a-3]^l[a-8]^l[a-14]^l[a-16];l[a]=c<<1|c>>>31}c=(h<<5|h>>>27)+j+l[a];c=20>a?c+((g&e|~g&k)+1518500249):40>a?c+((g^e^k)+1859775393):60>a?c+((g&e|g&k|e&k)-1894007588):c+((g^e^k)-899497514);j=k;k=e;e=g<<30|g>>>2;g=h;h=c}b[0]=b[0]+h|0;b[1]=b[1]+g|0;b[2]=b[2]+e|0;b[3]=b[3]+k|0;b[4]=b[4]+j|0},_doFinalize:function(){var f=this._data,e=f.words,b=8*this._nDataBytes,h=8*f.sigBytes;e[h>>>5]|=128<<24-h%32;e[(h+64>>>9<<4)+14]=Math.floor(b/4294967296);e[(h+64>>>9<<4)+15]=b;f.sigBytes=4*e.length;this._process();return this._hash},clone:function(){var e=j.clone.call(this);e._hash=this._hash.clone();return e}});e.SHA1=j._createHelper(m);e.HmacSHA1=j._createHmacHelper(m)})();var CryptoJS=CryptoJS||function(s,p){var m={},l=m.lib={},n=function(){},r=l.Base={extend:function(b){n.prototype=this;var h=new n;b&&h.mixIn(b);h.hasOwnProperty("init")||(h.init=function(){h.$super.init.apply(this,arguments)});h.init.prototype=h;h.$super=this;return h},create:function(){var b=this.extend();b.init.apply(b,arguments);return b},init:function(){},mixIn:function(b){for(var h in b)b.hasOwnProperty(h)&&(this[h]=b[h]);b.hasOwnProperty("toString")&&(this.toString=b.toString)},clone:function(){return this.init.prototype.extend(this)}},q=l.WordArray=r.extend({init:function(b,h){b=this.words=b||[];this.sigBytes=h!=p?h:4*b.length},toString:function(b){return(b||t).stringify(this)},concat:function(b){var h=this.words,a=b.words,j=this.sigBytes;b=b.sigBytes;this.clamp();if(j%4)for(var g=0;g<b;g++)h[j+g>>>2]|=(a[g>>>2]>>>24-8*(g%4)&255)<<24-8*((j+g)%4);else if(65535<a.length)for(g=0;g<b;g+=4)h[j+g>>>2]=a[g>>>2];else h.push.apply(h,a);this.sigBytes+=b;return this},clamp:function(){var b=this.words,h=this.sigBytes;b[h>>>2]&=4294967295<<32-8*(h%4);b.length=s.ceil(h/4)},clone:function(){var b=r.clone.call(this);b.words=this.words.slice(0);return b},random:function(b){for(var h=[],a=0;a<b;a+=4)h.push(4294967296*s.random()|0);return new q.init(h,b)}}),v=m.enc={},t=v.Hex={stringify:function(b){var a=b.words;b=b.sigBytes;for(var g=[],j=0;j<b;j++){var k=a[j>>>2]>>>24-8*(j%4)&255;g.push((k>>>4).toString(16));g.push((k&15).toString(16))}return g.join("")},parse:function(b){for(var a=b.length,g=[],j=0;j<a;j+=2)g[j>>>3]|=parseInt(b.substr(j,2),16)<<24-4*(j%8);return new q.init(g,a/2)}},a=v.Latin1={stringify:function(b){var a=b.words;b=b.sigBytes;for(var g=[],j=0;j<b;j++)g.push(String.fromCharCode(a[j>>>2]>>>24-8*(j%4)&255));return g.join("")},parse:function(b){for(var a=b.length,g=[],j=0;j<a;j++)g[j>>>2]|=(b.charCodeAt(j)&255)<<24-8*(j%4);return new q.init(g,a)}},u=v.Utf8={stringify:function(b){try{return decodeURIComponent(escape(a.stringify(b)))}catch(g){throw Error("Malformed UTF-8 data");}},parse:function(b){return a.parse(unescape(encodeURIComponent(b)))}},g=l.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new q.init;this._nDataBytes=0},_append:function(b){"string"==typeof b&&(b=u.parse(b));this._data.concat(b);this._nDataBytes+=b.sigBytes},_process:function(b){var a=this._data,g=a.words,j=a.sigBytes,k=this.blockSize,m=j/(4*k),m=b?s.ceil(m):s.max((m|0)-this._minBufferSize,0);b=m*k;j=s.min(4*b,j);if(b){for(var l=0;l<b;l+=k)this._doProcessBlock(g,l);l=g.splice(0,b);a.sigBytes-=j}return new q.init(l,j)},clone:function(){var b=r.clone.call(this);b._data=this._data.clone();return b},_minBufferSize:0});l.Hasher=g.extend({cfg:r.extend(),init:function(b){this.cfg=this.cfg.extend(b);this.reset()},reset:function(){g.reset.call(this);this._doReset()},update:function(b){this._append(b);this._process();return this},finalize:function(b){b&&this._append(b);return this._doFinalize()},blockSize:16,_createHelper:function(b){return function(a,g){return(new b.init(g)).finalize(a)}},_createHmacHelper:function(b){return function(a,g){return(new k.HMAC.init(b,g)).finalize(a)}}});var k=m.algo={};return m}(Math);(function(s){function p(a,k,b,h,l,j,m){a=a+(k&b|~k&h)+l+m;return(a<<j|a>>>32-j)+k}function m(a,k,b,h,l,j,m){a=a+(k&h|b&~h)+l+m;return(a<<j|a>>>32-j)+k}function l(a,k,b,h,l,j,m){a=a+(k^b^h)+l+m;return(a<<j|a>>>32-j)+k}function n(a,k,b,h,l,j,m){a=a+(b^(k|~h))+l+m;return(a<<j|a>>>32-j)+k}for(var r=CryptoJS,q=r.lib,v=q.WordArray,t=q.Hasher,q=r.algo,a=[],u=0;64>u;u++)a[u]=4294967296*s.abs(s.sin(u+1))|0;q=q.MD5=t.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(g,k){for(var b=0;16>b;b++){var h=k+b,w=g[h];g[h]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360}var b=this._hash.words,h=g[k+0],w=g[k+1],j=g[k+2],q=g[k+3],r=g[k+4],s=g[k+5],t=g[k+6],u=g[k+7],v=g[k+8],x=g[k+9],y=g[k+10],z=g[k+11],A=g[k+12],B=g[k+13],C=g[k+14],D=g[k+15],c=b[0],d=b[1],e=b[2],f=b[3],c=p(c,d,e,f,h,7,a[0]),f=p(f,c,d,e,w,12,a[1]),e=p(e,f,c,d,j,17,a[2]),d=p(d,e,f,c,q,22,a[3]),c=p(c,d,e,f,r,7,a[4]),f=p(f,c,d,e,s,12,a[5]),e=p(e,f,c,d,t,17,a[6]),d=p(d,e,f,c,u,22,a[7]),c=p(c,d,e,f,v,7,a[8]),f=p(f,c,d,e,x,12,a[9]),e=p(e,f,c,d,y,17,a[10]),d=p(d,e,f,c,z,22,a[11]),c=p(c,d,e,f,A,7,a[12]),f=p(f,c,d,e,B,12,a[13]),e=p(e,f,c,d,C,17,a[14]),d=p(d,e,f,c,D,22,a[15]),c=m(c,d,e,f,w,5,a[16]),f=m(f,c,d,e,t,9,a[17]),e=m(e,f,c,d,z,14,a[18]),d=m(d,e,f,c,h,20,a[19]),c=m(c,d,e,f,s,5,a[20]),f=m(f,c,d,e,y,9,a[21]),e=m(e,f,c,d,D,14,a[22]),d=m(d,e,f,c,r,20,a[23]),c=m(c,d,e,f,x,5,a[24]),f=m(f,c,d,e,C,9,a[25]),e=m(e,f,c,d,q,14,a[26]),d=m(d,e,f,c,v,20,a[27]),c=m(c,d,e,f,B,5,a[28]),f=m(f,c,d,e,j,9,a[29]),e=m(e,f,c,d,u,14,a[30]),d=m(d,e,f,c,A,20,a[31]),c=l(c,d,e,f,s,4,a[32]),f=l(f,c,d,e,v,11,a[33]),e=l(e,f,c,d,z,16,a[34]),d=l(d,e,f,c,C,23,a[35]),c=l(c,d,e,f,w,4,a[36]),f=l(f,c,d,e,r,11,a[37]),e=l(e,f,c,d,u,16,a[38]),d=l(d,e,f,c,y,23,a[39]),c=l(c,d,e,f,B,4,a[40]),f=l(f,c,d,e,h,11,a[41]),e=l(e,f,c,d,q,16,a[42]),d=l(d,e,f,c,t,23,a[43]),c=l(c,d,e,f,x,4,a[44]),f=l(f,c,d,e,A,11,a[45]),e=l(e,f,c,d,D,16,a[46]),d=l(d,e,f,c,j,23,a[47]),c=n(c,d,e,f,h,6,a[48]),f=n(f,c,d,e,u,10,a[49]),e=n(e,f,c,d,C,15,a[50]),d=n(d,e,f,c,s,21,a[51]),c=n(c,d,e,f,A,6,a[52]),f=n(f,c,d,e,q,10,a[53]),e=n(e,f,c,d,y,15,a[54]),d=n(d,e,f,c,w,21,a[55]),c=n(c,d,e,f,v,6,a[56]),f=n(f,c,d,e,D,10,a[57]),e=n(e,f,c,d,t,15,a[58]),d=n(d,e,f,c,B,21,a[59]),c=n(c,d,e,f,r,6,a[60]),f=n(f,c,d,e,z,10,a[61]),e=n(e,f,c,d,j,15,a[62]),d=n(d,e,f,c,x,21,a[63]);b[0]=b[0]+c|0;b[1]=b[1]+d|0;b[2]=b[2]+e|0;b[3]=b[3]+f|0},_doFinalize:function(){var a=this._data,k=a.words,b=8*this._nDataBytes,h=8*a.sigBytes;k[h>>>5]|=128<<24-h%32;var l=s.floor(b/4294967296);k[(h+64>>>9<<4)+15]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360;k[(h+64>>>9<<4)+14]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360;a.sigBytes=4*(k.length+1);this._process();a=this._hash;k=a.words;for(b=0;4>b;b++)h=k[b],k[b]=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360;return a},clone:function(){var a=t.clone.call(this);a._hash=this._hash.clone();return a}});r.MD5=t._createHelper(q);r.HmacMD5=t._createHmacHelper(q)})(Math);var Auth=$CL.namespace('Ginger.Application.Service.Auth');$CL.require("Cl.Crypto.rollups.md5");$CL.require("Cl.Crypto.rollups.sha1");$CL.require("Cl.Crypto.rollups.hmac-sha1");$CL.require("Cl.Jquery.Plugin.Store");Auth.Adapter=function(){};Auth.Adapter.prototype={activeApiKey:null,activeSecretKey:null,getActiveApiKey:function(){if(_.isNull(this.activeApiKey)){this.activeApiKey=$.store.get('api_key')||null;}
return this.activeApiKey;},getActiveSecretKey:function(){if(_.isNull(this.activeSecretKey)){this.activeSecretKey=$.store.get('secret_key')||null;}
return this.activeSecretKey;},setUsername:function(username){this.activeApiKey=CryptoJS.MD5(username).toString();$.store.set('api_key',this.activeApiKey);},setPassword:function(password){this.activeSecretKey=CryptoJS.SHA1(password).toString();$.store.set('secret_key',this.activeSecretKey);},onBeforeAjaxSend:function(jqXhr,request){if(!_.isNull(this.getActiveApiKey())&&!_.isNull(this.getActiveSecretKey())){var requestHash=CryptoJS.HmacSHA1(decodeURI(request.url),this.getActiveSecretKey());jqXhr.setRequestHeader('Api-Key',this.getActiveApiKey());jqXhr.setRequestHeader('Request-Hash',requestHash);}},clearCredentials:function(){$.store.remove('api_key');$.store.remove('secret_key');}};var ModuleElement=$CL.namespace('Ginger.Application.Service.ModuleElement');$CL.require("Ginger.Application.Service.ModuleElement.ElementInterface");ModuleElement.ElementLoader=function(){};ModuleElement.ElementLoader.prototype={loadElement:function(elementData,callback){$CL.app().lazyLoadModule(elementData.module,function(){var element=$CL.get(elementData['class'].replace(/\\/g,'.'),elementData);if(!$CL.isInstanceOf(element,Ginger.Application.Service.ModuleElement.ElementInterface)){$CL.exception("Module Element has to be instance of Ginger.Application.Service.ModuleElement.ElementInterface",$CL.className(this),{element:element});}
callback(element);});}};var Controller=$CL.namespace('Ginger.Application.Controller');$CL.require("Cl.Application.Mvc.AbstractController");$CL.require("Ginger.Application.Service.Auth.Adapter");Controller.Auth=function(){};Controller.Auth=$CL.extendClass(Controller.Auth,Cl.Application.Mvc.AbstractController,{authAdapter:null,setAuthAdapter:function(authAdapter){this.authAdapter=authAdapter;},loginAction:function(){var v=$CL.get('Ginger.Application.View.Auth.Login');v.setSubmitCallback($CL.bind(function(data){this.authAdapter.setUsername(data.email);this.authAdapter.setPassword(data.password);$CL.app().router.callRoute('dashboard');},this));return v;}});var Controller=$CL.namespace('Ginger.Application.Controller');$CL.require("Cl.Application.Mvc.AbstractController");Controller.ModuleLoader=function(){};Controller.ModuleLoader=$CL.extendClass(Controller.ModuleLoader,Cl.Application.Mvc.AbstractController,{loadModuleAction:function()
{this.getMvcEvent().stopPropagation();var moduleName=this.getMvcEvent().getRouteMatch().getParam('moduleName');var gotoRoute=this.getMvcEvent().getRouteMatch().getParam('gotoRoute');$CL.log('load module: ',moduleName,' and go to route: ',gotoRoute);$CL.get('application').lazyLoadModule(moduleName,function(){if(gotoRoute!="-"){$CL.get('application').router.callRoute(gotoRoute);}});}});jQuery.effects||function(e,t){var n="ui-effects-";e.effects={effect:{}},function(e,t){function h(e,t,n){var r=u[t.type]||{};return e==null?n||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:r.max<e?r.max:e)}function p(t){var n=s(),r=n._rgba=[];return t=t.toLowerCase(),c(i,function(e,i){var s,u=i.re.exec(t),a=u&&i.parse(u),f=i.space||"rgba";if(a)return s=n[f](a),n[o[f].cache]=s[o[f].cache],r=n._rgba=s._rgba,!1}),r.length?(r.join()==="0,0,0,0"&&e.extend(r,l.transparent),n):l[t]}function d(e,t,n){return n=(n+1)%1,n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e}var n="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,i=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1]*2.55,e[2]*2.55,e[3]*2.55,e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],s=e.Color=function(t,n,r,i){return new e.Color.fn.parse(t,n,r,i)},o={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},a=s.support={},f=e("<p>")[0],l,c=e.each;f.style.cssText="background-color:rgba(1,1,1,.5)",a.rgba=f.style.backgroundColor.indexOf("rgba")>-1,c(o,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),s.fn=e.extend(s.prototype,{parse:function(n,r,i,u){if(n===t)return this._rgba=[null,null,null,null],this;if(n.jquery||n.nodeType)n=e(n).css(r),r=t;var a=this,f=e.type(n),d=this._rgba=[];r!==t&&(n=[n,r,i,u],f="array");if(f==="string")return this.parse(p(n)||l._default);if(f==="array")return c(o.rgba.props,function(e,t){d[t.idx]=h(n[t.idx],t)}),this;if(f==="object")return n instanceof s?c(o,function(e,t){n[t.cache]&&(a[t.cache]=n[t.cache].slice())}):c(o,function(t,r){var i=r.cache;c(r.props,function(e,t){if(!a[i]&&r.to){if(e==="alpha"||n[e]==null)return;a[i]=r.to(a._rgba)}a[i][t.idx]=h(n[e],t,!0)}),a[i]&&e.inArray(null,a[i].slice(0,3))<0&&(a[i][3]=1,r.from&&(a._rgba=r.from(a[i])))}),this},is:function(e){var t=s(e),n=!0,r=this;return c(o,function(e,i){var s,o=t[i.cache];return o&&(s=r[i.cache]||i.to&&i.to(r._rgba)||[],c(i.props,function(e,t){if(o[t.idx]!=null)return n=o[t.idx]===s[t.idx],n})),n}),n},_space:function(){var e=[],t=this;return c(o,function(n,r){t[r.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var n=s(e),r=n._space(),i=o[r],a=this.alpha()===0?s("transparent"):this,f=a[i.cache]||i.to(a._rgba),l=f.slice();return n=n[i.cache],c(i.props,function(e,r){var i=r.idx,s=f[i],o=n[i],a=u[r.type]||{};if(o===null)return;s===null?l[i]=o:(a.mod&&(o-s>a.mod/2?s+=a.mod:s-o>a.mod/2&&(s-=a.mod)),l[i]=h((o-s)*t+s,r))}),this[r](l)},blend:function(t){if(this._rgba[3]===1)return this;var n=this._rgba.slice(),r=n.pop(),i=s(t)._rgba;return s(e.map(n,function(e,t){return(1-r)*i[t]+r*e}))},toRgbaString:function(){var t="rgba(",n=e.map(this._rgba,function(e,t){return e==null?t>2?1:0:e});return n[3]===1&&(n.pop(),t="rgb("),t+n.join()+")"},toHslaString:function(){var t="hsla(",n=e.map(this.hsla(),function(e,t){return e==null&&(e=t>2?1:0),t&&t<3&&(e=Math.round(e*100)+"%"),e});return n[3]===1&&(n.pop(),t="hsl("),t+n.join()+")"},toHexString:function(t){var n=this._rgba.slice(),r=n.pop();return t&&n.push(~~(r*255)),"#"+e.map(n,function(e){return e=(e||0).toString(16),e.length===1?"0"+e:e}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}}),s.fn.parse.prototype=s.fn,o.hsla.to=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=e[3],s=Math.max(t,n,r),o=Math.min(t,n,r),u=s-o,a=s+o,f=a*.5,l,c;return o===s?l=0:t===s?l=60*(n-r)/u+360:n===s?l=60*(r-t)/u+120:l=60*(t-n)/u+240,u===0?c=0:f<=.5?c=u/a:c=u/(2-a),[Math.round(l)%360,c,f,i==null?1:i]},o.hsla.from=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/360,n=e[1],r=e[2],i=e[3],s=r<=.5?r*(1+n):r+n-r*n,o=2*r-s;return[Math.round(d(o,s,t+1/3)*255),Math.round(d(o,s,t)*255),Math.round(d(o,s,t-1/3)*255),i]},c(o,function(n,i){var o=i.props,u=i.cache,a=i.to,f=i.from;s.fn[n]=function(n){a&&!this[u]&&(this[u]=a(this._rgba));if(n===t)return this[u].slice();var r,i=e.type(n),l=i==="array"||i==="object"?n:arguments,p=this[u].slice();return c(o,function(e,t){var n=l[i==="object"?e:t.idx];n==null&&(n=p[t.idx]),p[t.idx]=h(n,t)}),f?(r=s(f(p)),r[u]=p,r):s(p)},c(o,function(t,i){if(s.fn[t])return;s.fn[t]=function(s){var o=e.type(s),u=t==="alpha"?this._hsla?"hsla":"rgba":n,a=this[u](),f=a[i.idx],l;return o==="undefined"?f:(o==="function"&&(s=s.call(this,f),o=e.type(s)),s==null&&i.empty?this:(o==="string"&&(l=r.exec(s),l&&(s=f+parseFloat(l[2])*(l[1]==="+"?1:-1))),a[i.idx]=s,this[u](a)))}})}),s.hook=function(t){var n=t.split(" ");c(n,function(t,n){e.cssHooks[n]={set:function(t,r){var i,o,u="";if(r!=="transparent"&&(e.type(r)!=="string"||(i=p(r)))){r=s(i||r);if(!a.rgba&&r._rgba[3]!==1){o=n==="backgroundColor"?t.parentNode:t;while((u===""||u==="transparent")&&o&&o.style)try{u=e.css(o,"backgroundColor"),o=o.parentNode}catch(f){}r=r.blend(u&&u!=="transparent"?u:"_default")}r=r.toRgbaString()}try{t.style[n]=r}catch(f){}}},e.fx.step[n]=function(t){t.colorInit||(t.start=s(t.elem,n),t.end=s(t.end),t.colorInit=!0),e.cssHooks[n].set(t.elem,t.start.transition(t.end,t.pos))}})},s.hook(n),e.cssHooks.borderColor={expand:function(e){var t={};return c(["Top","Right","Bottom","Left"],function(n,r){t["border"+r+"Color"]=e}),t}},l=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function i(t){var n,r,i=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,s={};if(i&&i.length&&i[0]&&i[i[0]]){r=i.length;while(r--)n=i[r],typeof i[n]=="string"&&(s[e.camelCase(n)]=i[n])}else for(n in i)typeof i[n]=="string"&&(s[n]=i[n]);return s}function s(t,n){var i={},s,o;for(s in n)o=n[s],t[s]!==o&&!r[s]&&(e.fx.step[s]||!isNaN(parseFloat(o)))&&(i[s]=o);return i}var n=["add","remove","toggle"],r={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,n){e.fx.step[n]=function(e){if(e.end!=="none"&&!e.setAttr||e.pos===1&&!e.setAttr)jQuery.style(e.elem,n,e.end),e.setAttr=!0}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(t,r,o,u){var a=e.speed(r,o,u);return this.queue(function(){var r=e(this),o=r.attr("class")||"",u,f=a.children?r.find("*").addBack():r;f=f.map(function(){var t=e(this);return{el:t,start:i(this)}}),u=function(){e.each(n,function(e,n){t[n]&&r[n+"Class"](t[n])})},u(),f=f.map(function(){return this.end=i(this.el[0]),this.diff=s(this.start,this.end),this}),r.attr("class",o),f=f.map(function(){var t=this,n=e.Deferred(),r=e.extend({},a,{queue:!1,complete:function(){n.resolve(t)}});return this.el.animate(this.diff,r),n.promise()}),e.when.apply(e,f.get()).done(function(){u(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),a.complete.call(r[0])})})},e.fn.extend({_addClass:e.fn.addClass,addClass:function(t,n,r,i){return n?e.effects.animateClass.call(this,{add:t},n,r,i):this._addClass(t)},_removeClass:e.fn.removeClass,removeClass:function(t,n,r,i){return arguments.length>1?e.effects.animateClass.call(this,{remove:t},n,r,i):this._removeClass.apply(this,arguments)},_toggleClass:e.fn.toggleClass,toggleClass:function(n,r,i,s,o){return typeof r=="boolean"||r===t?i?e.effects.animateClass.call(this,r?{add:n}:{remove:n},i,s,o):this._toggleClass(n,r):e.effects.animateClass.call(this,{toggle:n},r,i,s)},switchClass:function(t,n,r,i,s){return e.effects.animateClass.call(this,{add:n,remove:t},r,i,s)}})}(),function(){function r(t,n,r,i){e.isPlainObject(t)&&(n=t,t=t.effect),t={effect:t},n==null&&(n={}),e.isFunction(n)&&(i=n,r=null,n={});if(typeof n=="number"||e.fx.speeds[n])i=r,r=n,n={};return e.isFunction(r)&&(i=r,r=null),n&&e.extend(t,n),r=r||n.duration,t.duration=e.fx.off?0:typeof r=="number"?r:r in e.fx.speeds?e.fx.speeds[r]:e.fx.speeds._default,t.complete=i||n.complete,t}function i(t){return!t||typeof t=="number"||e.fx.speeds[t]?!0:typeof t=="string"&&!e.effects.effect[t]}e.extend(e.effects,{version:"1.10.1",save:function(e,t){for(var r=0;r<t.length;r++)t[r]!==null&&e.data(n+t[r],e[0].style[t[r]])},restore:function(e,r){var i,s;for(s=0;s<r.length;s++)r[s]!==null&&(i=e.data(n+r[s]),i===t&&(i=""),e.css(r[s],i))},setMode:function(e,t){return t==="toggle"&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,r;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),i={width:t.width(),height:t.height()},s=document.activeElement;try{s.id}catch(o){s=document.body}return t.wrap(r),(t[0]===s||e.contains(t[0],s))&&e(s).focus(),r=t.parent(),t.css("position")==="static"?(r.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,r){n[r]=t.css(r),isNaN(parseInt(n[r],10))&&(n[r]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(i),r.css(n).show()},removeWrapper:function(t){var n=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).focus()),t},setTransition:function(t,n,r,i){return i=i||{},e.each(n,function(e,n){var s=t.cssUnit(n);s[0]>0&&(i[n]=s[0]*r+s[1])}),i}}),e.fn.extend({effect:function(){function o(n){function u(){e.isFunction(i)&&i.call(r[0]),e.isFunction(n)&&n()}var r=e(this),i=t.complete,o=t.mode;(r.is(":hidden")?o==="hide":o==="show")?u():s.call(r[0],t,u)}var t=r.apply(this,arguments),n=t.mode,i=t.queue,s=e.effects.effect[t.effect];return e.fx.off||!s?n?this[n](t.duration,t.complete):this.each(function(){t.complete&&t.complete.call(this)}):i===!1?this.each(o):this.queue(i||"fx",o)},_show:e.fn.show,show:function(e){if(i(e))return this._show.apply(this,arguments);var t=r.apply(this,arguments);return t.mode="show",this.effect.call(this,t)},_hide:e.fn.hide,hide:function(e){if(i(e))return this._hide.apply(this,arguments);var t=r.apply(this,arguments);return t.mode="hide",this.effect.call(this,t)},__toggle:e.fn.toggle,toggle:function(t){if(i(t)||typeof t=="boolean"||e.isFunction(t))return this.__toggle.apply(this,arguments);var n=r.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)},cssUnit:function(t){var n=this.css(t),r=[];return e.each(["em","px","%","pt"],function(e,t){n.indexOf(t)>0&&(r=[parseFloat(n),t])}),r}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,n){t[n]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return e===0||e===1?e:-Math.pow(2,8*(e-1))*Math.sin(((e-1)*80-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){var t,n=4;while(e<((t=Math.pow(2,--n))-1)/11);return 1/Math.pow(4,3-n)-7.5625*Math.pow((t*3-2)/22-e,2)}}),e.each(t,function(t,n){e.easing["easeIn"+t]=n,e.easing["easeOut"+t]=function(e){return 1-n(1-e)},e.easing["easeInOut"+t]=function(e){return e<.5?n(e*2)/2:1-n(e*-2+2)/2}})}()}(jQuery);;(function($){var h=$.scrollTo=function(a,b,c){$(window).scrollTo(a,b,c)};h.defaults={axis:'xy',duration:parseFloat($.fn.jquery)>=1.3?0:1,limit:true};h.window=function(a){return $(window)._scrollable()};$.fn._scrollable=function(){return this.map(function(){var a=this,isWin=!a.nodeName||$.inArray(a.nodeName.toLowerCase(),['iframe','#document','html','body'])!=-1;if(!isWin)return a;var b=(a.contentWindow||a).document||a.ownerDocument||a;return/webkit/i.test(navigator.userAgent)||b.compatMode=='BackCompat'?b.body:b.documentElement})};$.fn.scrollTo=function(e,f,g){if(typeof f=='object'){g=f;f=0}if(typeof g=='function')g={onAfter:g};if(e=='max')e=9e9;g=$.extend({},h.defaults,g);f=f||g.duration;g.queue=g.queue&&g.axis.length>1;if(g.queue)f/=2;g.offset=both(g.offset);g.over=both(g.over);return this._scrollable().each(function(){if(e==null)return;var d=this,$elem=$(d),targ=e,toff,attr={},win=$elem.is('html,body');switch(typeof targ){case'number':case'string':if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(targ)){targ=both(targ);break}targ=$(targ,this);if(!targ.length)return;case'object':if(targ.is||targ.style)toff=(targ=$(targ)).offset()}$.each(g.axis.split(''),function(i,a){var b=a=='x'?'Left':'Top',pos=b.toLowerCase(),key='scroll'+b,old=d[key],max=h.max(d,a);if(toff){attr[key]=toff[pos]+(win?0:old-$elem.offset()[pos]);if(g.margin){attr[key]-=parseInt(targ.css('margin'+b))||0;attr[key]-=parseInt(targ.css('border'+b+'Width'))||0}attr[key]+=g.offset[pos]||0;if(g.over[pos])attr[key]+=targ[a=='x'?'width':'height']()*g.over[pos]}else{var c=targ[pos];attr[key]=c.slice&&c.slice(-1)=='%'?parseFloat(c)/100*max:c}if(g.limit&&/^\d+$/.test(attr[key]))attr[key]=attr[key]<=0?0:Math.min(attr[key],max);if(!i&&g.queue){if(old!=attr[key])animate(g.onAfterFirst);delete attr[key]}});animate(g.onAfter);function animate(a){$elem.animate(attr,f,g.easing,a&&function(){a.call(this,e,g)})}}).end()};h.max=function(a,b){var c=b=='x'?'Width':'Height',scroll='scroll'+c;if(!$(a).is('html,body'))return a[scroll]-$(a)[c.toLowerCase()]();var d='client'+c,html=a.ownerDocument.documentElement,body=a.ownerDocument.body;return Math.max(html[scroll],body[scroll])-Math.min(html[d],body[d])};function both(a){return typeof a=='object'?a:{top:a,left:a}}})(jQuery);var ClBackbone=$CL.namespace('Cl.Backbone');$CL.require('Cl.Backbone.View');ClBackbone.Layout=function(){};ClBackbone.Layout=$CL.extendClass(ClBackbone.Layout,Cl.Backbone.View,{childes:[],previousChildes:[],contentEl:null,init:function(){$CL.get('shared_event_manager').attach('application','render',[this.onRender,this],100);},addChild:function(child){this.childes.push(child);},render:function(){_.each(this.previousChildes,function(child){child.undelegateEvents();});_.each(this.childes,function(child){child.render();child.delegateEvents();});this.previousChildes=this.childes;this.childes=[];},getContentEl:function(){if(_.isNull(this.contentEl)){this.contentEl=$('#js_content')[0];}
return this.contentEl;},onRender:function(mvcEvent){if($CL.isInstanceOf(mvcEvent.getResponse(),Cl.Backbone.View)){var childView=mvcEvent.getResponse();if($CL.has(childView,'isTerminal')&&childView.isTerminal()){return;}
childView.setElement(this.getContentEl());this.addChild(childView);this.previousContentChild=childView;mvcEvent.setResponse(this);}
return;}});var View=$CL.namespace("Cl.Application.View");View.RenderingStrategyInterface=function RenderingStrategyInterface(){};View.RenderingStrategyInterface.prototype={onRender:function(mvcEvent){$CL.implementThis();}};var ClBackbone=$CL.namespace("Cl.Backbone");$CL.require("Cl.Backbone.Backbone");$CL.require("Cl.Application.View.RenderingStrategyInterface");ClBackbone.ViewRenderingStrategy=function ClBackboneViewRenderingStrategy(){this.__IMPLEMENTS__=[Cl.Application.View.RenderingStrategyInterface];};ClBackbone.ViewRenderingStrategy.prototype={onRender:function(mvcEvent){if($CL.isInstanceOf(mvcEvent.getResponse(),Cl.Backbone.View)){mvcEvent.stopPropagation();mvcEvent.getResponse().render();}
return;}};var Core=$CL.namespace("Cl.Core");Core.Date=function(){};Core.Date.DAY_NAMES={en:new Array('Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'),de:new Array('Sonntag','Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag')};Core.Date.SHORT_DAY_NAMES={en:new Array('Su','Mo','Tu','We','Th','Fr','Sa'),de:new Array('So','Mo','Di','Mi','Do','Fr','Sa')};Core.Date.MONTH_NAMES={en:new Array('January','February','March','April','May','June','July','August','September','October','November','December'),de:new Array('Januar','Februar','März','April','Mai','Juni','Juli','August','September','Oktober','November','Dezember')};Core.Date.SHORT_MONTH_NAMES={en:new Array('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'),de:new Array('Jan','Feb','Mrz','Apr','Mai','Jun','Jul','Aug','Sep','Okt','Nov','Dez')};(function(cl){Date.DAYS_IN_MONTH=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;var appMainLanguage=$CL.LANGUAGE.substr(0,2);Date.LANG=(appMainLanguage!="en"&&appMainLanguage!="de")?"en":appMainLanguage;Date.parseDate=function(str,fmt){if(typeof fmt=="undefined")
fmt=Date.getStrFmt();var today=new Date();var y=0;var m=-1;var d=0;var a=str.split(/\W+/);var b=fmt.match(/%./g);var i=0,j=0;var hr=0;var min=0;var sec=0;for(i=0;i<a.length;++i){if(!a[i])continue;switch(b[i]){case"%d":case"%e":d=parseInt(a[i],10);break;case"%m":m=parseInt(a[i],10)-1;break;case"%Y":case"%y":y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);break;case"%b":case"%B":for(j=0;j<12;++j){if(cl.MONTH_NAMES[Date.LANG][j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){m=j;break;}}
break;case"%H":case"%I":case"%k":case"%l":hr=parseInt(a[i],10);break;case"%P":case"%p":if(/pm/i.test(a[i])&&hr<12)
hr+=12;else if(/am/i.test(a[i])&&hr>=12)
hr-=12;break;case"%M":min=parseInt(a[i],10);break;case"%S":sec=parseInt(a[i],10);break;}}
if(isNaN(y))y=today.getFullYear();if(isNaN(m))m=today.getMonth();if(isNaN(d))d=today.getDate();if(isNaN(hr))hr=today.getHours();if(isNaN(min))min=today.getMinutes();if(isNaN(sec))sec=today.getSeconds();if(y!=0&&m!=-1&&d!=0)
return new Date(y,m,d,hr,min,sec);y=0;m=-1;d=0;for(i=0;i<a.length;++i){if(a[i].search(/[a-zA-Z]+/)!=-1){var t=-1;for(j=0;j<12;++j){if(cl.MONTH_NAMES[Date.LANG][j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){t=j;break;}}
if(t!=-1){if(m!=-1){d=m+1;}
m=t;}}else if(parseInt(a[i],10)<=12&&m==-1){m=a[i]-1;}else if(parseInt(a[i],10)>31&&y==0){y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);}else if(d==0){d=a[i];}}
if(y==0)
y=today.getFullYear();if(m!=-1&&d!=0)
return new Date(y,m,d,hr,min,0);return today;};Date.getStrFmt=function(withTime){if(typeof withTime=="undefined")
withTime=true;switch(Date.LANG){case"de":return"%d.%m.%Y"+((withTime)?" %H:%M:%S":"");case"en":default:return Date.getDbStrFmt(withTime);}};Date.getDbStrFmt=function(withTime){if(typeof withTime=="undefined")
withTime=true;return"%Y-%m-%d"+((withTime)?" %H:%M:%S":"");};Date.prototype.getMonthDays=function(month){var year=this.getFullYear()
if(typeof month=="undefined")
month=this.getMonth()
if(((0==(year%4))&&((0!=(year%100))||(0==(year%400))))&&month==1)
return 29
else
return Date.DAYS_IN_MONTH[month]};Date.prototype.getDayOfYear=function(){var now=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var then=new Date(this.getFullYear(),0,0,0,0,0);var time=now-then;return Math.floor(time/Date.DAY);};Date.prototype.getWeekNumber=function(){var d=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var DoW=d.getDay();d.setDate(d.getDate()-(DoW+6)%7+3);var ms=d.valueOf();d.setMonth(0);d.setDate(4);return Math.round((ms-d.valueOf())/(7*864e5))+1;};Date.prototype.equalsTo=function(date){return((this.getFullYear()==date.getFullYear())&&(this.getMonth()==date.getMonth())&&(this.getDate()==date.getDate())&&(this.getHours()==date.getHours())&&(this.getMinutes()==date.getMinutes()));};Date.prototype.setDateOnly=function(date){var tmp=new Date(date);this.setDate(1);this.setFullYear(tmp.getFullYear());this.setMonth(tmp.getMonth());this.setDate(tmp.getDate());};Date.prototype.print=function(str){var m=this.getMonth();var d=this.getDate();var y=this.getFullYear();var wn=this.getWeekNumber();var w=this.getDay();var s={};var hr=this.getHours();var pm=(hr>=12);var ir=(pm)?(hr-12):hr;var dy=this.getDayOfYear();if(ir==0)
ir=12;var min=this.getMinutes();var sec=this.getSeconds();s["%a"]=cl.SHORT_DAY_NAMES[Date.LANG][w];s["%A"]=cl.DAY_NAMES[Date.LANG][w];s["%b"]=cl.SHORT_MONTH_NAMES[Date.LANG][m];s["%B"]=cl.MONTH_NAMES[Date.LANG][m];s["%C"]=1+Math.floor(y/100);s["%d"]=(d<10)?("0"+d):d;s["%e"]=d;s["%H"]=(hr<10)?("0"+hr):hr;s["%I"]=(ir<10)?("0"+ir):ir;s["%j"]=(dy<100)?((dy<10)?("00"+dy):("0"+dy)):dy;s["%k"]=hr;s["%l"]=ir;s["%m"]=(m<9)?("0"+(1+m)):(1+m);s["%M"]=(min<10)?("0"+min):min;s["%n"]="\n";s["%p"]=pm?"PM":"AM";s["%P"]=pm?"pm":"am";s["%s"]=Math.floor(this.getTime()/1000);s["%S"]=(sec<10)?("0"+sec):sec;s["%t"]="\t";s["%U"]=s["%W"]=s["%V"]=(wn<10)?("0"+wn):wn;s["%u"]=w+1;s["%w"]=w;s["%y"]=(''+y).substr(2,2);s["%Y"]=y;s["%%"]="%";var re=/%./g;var a=str.match(re);if(a){for(var i=0;i<a.length;i++){var tmp=s[a[i]];if(tmp){re=new RegExp(a[i],'g');str=str.replace(re,tmp);}}}
return str;};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(y){var d=new Date(this);d.__msh_oldSetFullYear(y);if(d.getMonth()!=this.getMonth())
this.setDate(28);this.__msh_oldSetFullYear(y);};Date.prototype.toString=function(withTime,withoutDate){if(typeof withTime=="undefined")
withTime=true;if(typeof withoutDate=="undefined")
withoutDate=false;switch(Date.LANG){case"de":var str=((!withoutDate)?"%d.%m.%Y":"")+((withTime)?" %H:%M:%S":"");return this.print(str);case"en":default:return this.toDbString(withTime);}};Date.prototype.toDbString=function(withTime,withoutDate){if(typeof withTime=="undefined")
withTime=true;if(typeof withoutDate=="undefined")
withoutDate=false;var str=((!withoutDate)?"%Y-%m-%d":"")+((withTime)?" %H:%M:%S":"");return this.print(str);};Date.prototype.setTimestamp=function(unixtimestamp){unixtimestamp=parseInt(unixtimestamp);this.setTime((unixtimestamp*1000));return this;};Date.prototype.toTimestamp=function(){return Math.floor((this.getTime()/1000));};Date.prototype.getMonthStr=function(){var monthNums=new Array('01','02','03','04','05','06','07','08','09','10','11','12');return monthNums[this.getMonth()];};Date.prototype.getDayStr=function(){var day=this.getDate();return day<10?'0'+day:day;};})(Core.Date);var Application=$CL.namespace("Ginger.Application");$CL.require("Cl.Core.String");$CL.require("Cl.Core.Date");$CL.require("Cl.Application.Module.ModuleInterface");$CL.require("Cl.Backbone.ViewRenderingStrategy");$CL.require("Cl.Backbone.Layout");$CL.require("Cl.Jquery.Plugin.Scroll.To");$CL.require("Cl.Jquery.Plugin.Effect.Core");$CL.require("Ginger.Application.Controller.ModuleLoader");$CL.require("Ginger.Application.Controller.Auth");$CL.require("Ginger.Application.Service.ModuleElement.ElementLoader");$CL.require("Ginger.Application.Service.Auth.Adapter");$CL.require('Ginger.Application.Collection.Modules');$CL.require('Ginger.Application.Collection.Users');$CL.require("Ginger.Application.Model.User.UserManager");$CL.require("Ginger.Application.Model.Mapper.StructureMapper");$CL.require("Ginger.Application.Model.File.SourceFile");$CL.require("Ginger.Application.Model.Directory.SourceDirectory");$CL.require("Ginger.Application.Model.Directory.TargetDirectory");$CL.require("Ginger.Application.Model.Script.SourceScript");$CL.require("Ginger.Application.Model.Script.DevNullTarget");$CL.require("Ginger.Application.Model.Feature.AbstractFeature");$CL.require("Ginger.Application.Model.Feature.ValidatorFeature");$CL.require("Ginger.Application.Model.Feature.FilterFeature");$CL.require("Ginger.Application.Model.Feature.AttributeMapFeature");$CL.require("Ginger.Application.Model.Feature.StaticValueFeature");$CL.require("Ginger.Application.Form.Login");$CL.require("Ginger.Application.View.Auth.Login");$CL.require("Ginger.Application.View.Partial.ActiveUser");$CL.require("Ginger.Application.View.Helper.Breadcrumbs");$CL.require("Ginger.Application.View.Partial.StructureMapperOptions");$CL.require("Ginger.Application.View.Partial.SourcefileOptions");$CL.require("Ginger.Application.View.Partial.SourceDirectoryOptions");$CL.require("Ginger.Application.View.Partial.TargetDirectoryOptions");$CL.require("Ginger.Application.View.Partial.SourceScriptOptions");$CL.require("Ginger.Application.View.Partial.DevNullOptions");$CL.require("Ginger.Application.View.Partial.AbstractFeatureOptions");$CL.require("Ginger.Application.View.Partial.ValidatorFeatureOptions");$CL.require("Ginger.Application.View.Partial.AttributeMapFeatureOptions");$CL.require("Ginger.Application.View.Partial.AttributeMapFeatureHelp");$CL.require("Ginger.Application.View.Partial.StaticValueFeatureOptions");$CL.require("Ginger.Application.View.Partial.StaticValueFeatureHelp");$CL.require("Ginger.Application.View.Partial.Footer");Application.Module=function(){this.__IMPLEMENTS__=[Cl.Application.Module.ModuleInterface];};Application.Module.prototype={getConfig:function(){return{router:{routes:{'application_load_module':{route:'application/load-module/:moduleName/:gotoRoute',callback:function(moduleName,gotoRoute){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Application.Module",controller:"moduleLoader",action:"loadModule",params:{moduleName:moduleName,gotoRoute:gotoRoute}});},build:function(routeParams){return this.route.replace(':moduleName',routeParams.moduleName).replace(':gotoRoute',routeParams.gotoRoute);}},'application_auth_login':{route:'application/auth/login',callback:function(){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:"Ginger.Application.Module",controller:"auth",action:"login",});},build:function(routeParams){return this.route;}}},history:{silent:false,pushState:false,hashChange:true}},view:{strategies:[{key:"Cl.Backbone.ViewRenderingStrategy",priority:-90}]},service_manager:{factories:{'Ginger.Application.Controller.Auth':function(sl){var c=$CL.makeObj('Ginger.Application.Controller.Auth');c.setAuthAdapter(sl.get('auth_adapter'));return c;},'Ginger.Model.Mapper.TableStructureMapper':function(sl){return sl.get('Ginger.Application.Model.Mapper.StructureMapper');},'Ginger.Model.Mapper.DocumentStructureMapper':function(sl){return sl.get('Ginger.Application.Model.Mapper.StructureMapper');},'Ginger.Model.File.SourceFile':function(sl){return sl.get('Ginger.Application.Model.File.SourceFile');},'Ginger.Model.Directory.SourceDirectory':function(sl){return sl.get('Ginger.Application.Model.Directory.SourceDirectory');},'Ginger.Model.Directory.TargetDirectory':function(sl){return sl.get('Ginger.Application.Model.Directory.TargetDirectory');},'Ginger.Model.Script.SourceScript':function(sl){return sl.get('Ginger.Application.Model.Script.SourceScript');},'Ginger.Model.Script.DevNullTarget':function(sl){return sl.get('Ginger.Application.Model.Script.DevNullTarget');},'Ginger.Model.Feature.ValidatorFeature':function(sl){return sl.get('Ginger.Application.Model.Feature.ValidatorFeature');},'Ginger.Model.Feature.FilterFeature':function(sl){return sl.get('Ginger.Application.Model.Feature.FilterFeature');},'Ginger.Model.Feature.AttributeMapFeature':function(sl){return sl.get('Ginger.Application.Model.Feature.AttributeMapFeature');},'Ginger.Model.Feature.StaticValueFeature':function(sl){return sl.get('Ginger.Application.Model.Feature.StaticValueFeature');},'Ginger.Application.Model.Mapper.StructureMapper':function(sl){var m=$CL.makeObj('Ginger.Application.Model.Mapper.StructureMapper');m.setOptionsView(sl.get('Ginger.Application.View.Partial.StructureMapperOptions'));m.setSourceInfoCollection(sl.get('Ginger.Jobs.Collection.SourceInfos'));m.setTargetInfoCollection(sl.get('Ginger.Jobs.Collection.TargetInfos'));return m;},'Ginger.Application.Model.File.SourceFile':function(sl){var m=$CL.makeObj('Ginger.Application.Model.File.SourceFile');m.setOptionsView(sl.get('Ginger.Application.View.Partial.SourcefileOptions'));return m;},'Ginger.Application.Model.Directory.SourceDirectory':function(sl){var m=$CL.makeObj('Ginger.Application.Model.Directory.SourceDirectory');m.setOptionsView(sl.get('Ginger.Application.View.Partial.SourceDirectoryOptions'));return m;},'Ginger.Application.Model.Directory.TargetDirectory':function(sl){var m=$CL.makeObj('Ginger.Application.Model.Directory.TargetDirectory');m.setOptionsView(sl.get('Ginger.Application.View.Partial.TargetDirectoryOptions'));return m;},'Ginger.Application.Model.Script.SourceScript':function(sl){var m=$CL.makeObj('Ginger.Application.Model.Script.SourceScript');m.setOptionsView(sl.get('Ginger.Application.View.Partial.SourceScriptOptions'));return m;},'Ginger.Application.Model.Script.DevNullTarget':function(sl){var m=$CL.makeObj('Ginger.Application.Model.Script.DevNullTarget');m.setOptionsView(sl.get('Ginger.Application.View.Partial.DevNullOptions'));return m;},'Ginger.Application.Model.Feature.ValidatorFeature':function(sl){var m=$CL.makeObj('Ginger.Application.Model.Feature.ValidatorFeature');var v=sl.get('Ginger.Application.View.Partial.AbstractFeatureOptions');v.id="ValidatorFEature";v.setAdvancedOptionsView(sl.get('Ginger.Application.View.Partial.ValidatorFeatureOptions'));m.setOptionsView(v);return m;},'Ginger.Application.Model.Feature.FilterFeature':function(sl){var m=$CL.makeObj('Ginger.Application.Model.Feature.FilterFeature');var v=sl.get('Ginger.Application.View.Partial.AbstractFeatureOptions');v.id="FilterFeature";m.setOptionsView(v);return m;},'Ginger.Application.Model.Feature.AttributeMapFeature':function(sl){var m=$CL.makeObj('Ginger.Application.Model.Feature.AttributeMapFeature');var v=sl.get('Ginger.Application.View.Partial.AttributeMapFeatureOptions');m.setOptionsView(v);m.setHelpView(sl.get('Ginger.Application.View.Partial.AttributeMapFeatureHelp'));return m;},'Ginger.Application.Model.Feature.StaticValueFeature':function(sl){var m=$CL.makeObj('Ginger.Application.Model.Feature.StaticValueFeature');var v=sl.get('Ginger.Application.View.Partial.AbstractFeatureOptions');v.id="StaticValueFeature";v.setAdvancedOptionsView(sl.get('Ginger.Application.View.Partial.StaticValueFeatureOptions'));m.setOptionsView(v);m.setHelpView(sl.get('Ginger.Application.View.Partial.StaticValueFeatureHelp'));return m;},'user_manager':function(sl){var um=$CL.makeObj('Ginger.Application.Model.User.UserManager');um.setAuthAdapter(sl.get('auth_adapter'));um.setUsersCollection(sl.get('Ginger.Application.Collection.Users'));return um;},'Ginger.Application.Collection.Modules':function(sl){var c=$CL.makeObj('Ginger.Application.Collection.Modules');c.reset($CL.variable('connect_modules',{}));return c;},'module_element_loader':function(sl){return $CL.makeObj('Ginger.Application.Service.ModuleElement.ElementLoader');},'auth_adapter':function(sl){return $CL.makeObj("Ginger.Application.Service.Auth.Adapter");},"Ginger.Application.View.Auth.Login":function(sl){var v=$CL.makeObj('Ginger.Application.View.Auth.Login');v.setForm(sl.get('Ginger.Application.Form.Login'));v.setTemplate($CL._template('application_auth_login'));return v;},"Ginger.Application.View.Partial.ActiveUser":function(sl){var v=$CL.makeObj("Ginger.Application.View.Partial.ActiveUser");v.setTemplate($CL._template('application_nav_active_user'));return v;},"Ginger.Application.View.Helper.Breadcrumbs":function(sl){var v=$CL.makeObj("Ginger.Application.View.Helper.Breadcrumbs");v.setTemplate($CL._template('application_breadcrumbs'));return v;},"Ginger.Application.View.Partial.StructureMapperOptions":function(sl){var v=$CL.makeObj('Ginger.Application.View.Partial.StructureMapperOptions');v.setTemplate($CL._template('application_structure_mapper_options'));return v;},"Ginger.Application.View.Partial.SourcefileOptions":function(sl){var v=$CL.makeObj('Ginger.Application.View.Partial.SourcefileOptions');v.setTemplate($CL._template('application_sourcefile_options'));return v;},'Ginger.Application.View.Partial.SourceDirectoryOptions':function(sl){var v=$CL.makeObj('Ginger.Application.View.Partial.SourceDirectoryOptions');v.setTemplate($CL._template('application_sourcedirectory_options'));return v;},'Ginger.Application.View.Partial.TargetDirectoryOptions':function(sl){var v=$CL.makeObj('Ginger.Application.View.Partial.TargetDirectoryOptions');v.setTemplate($CL._template('application_targetdirectory_options'));return v;},'Ginger.Application.View.Partial.SourceScriptOptions':function(sl){var v=$CL.makeObj('Ginger.Application.View.Partial.SourceScriptOptions');v.setTemplate($CL._template('application_sourcescript_options'));return v;},'Ginger.Application.View.Partial.DevNullOptions':function(sl){var v=$CL.makeObj('Ginger.Application.View.Partial.DevNullOptions');v.setTemplate($CL._template('application_devnull_options'));return v;},'Ginger.Application.View.Partial.AbstractFeatureOptions':function(sl){var v=$CL.makeObj('Ginger.Application.View.Partial.AbstractFeatureOptions');v.setTemplate($CL._template('application_abstract_feature_options'));return v;},'Ginger.Application.View.Partial.ValidatorFeatureOptions':function(sl){var v=$CL.makeObj('Ginger.Application.View.Partial.ValidatorFeatureOptions');v.setTemplate($CL._template('application_validator_feature_options'));return v;},'Ginger.Application.View.Partial.AttributeMapFeatureOptions':function(sl){var v=$CL.makeObj('Ginger.Application.View.Partial.AttributeMapFeatureOptions');v.setTemplate($CL._template('application_attributemap_feature_options'));return v;},'Ginger.Application.View.Partial.StaticValueFeatureOptions':function(sl){var v=$CL.makeObj('Ginger.Application.View.Partial.StaticValueFeatureOptions');v.setTemplate($CL._template('application_staticvalue_feature_options'));return v;}},'non_shared_services':["Ginger.Application.View.Partial.AbstractFeatureOptions"]}}},onBootstrap:function(e){$CL.get('Cl.Backbone.Layout',{id:'js_content'});$CL.get("application").events().attach("render",function(e){var layout=e.getResponse();if(layout&&$CL.isInstanceOf(layout,Cl.Backbone.Layout)){var activeUser=$CL.get('user_manager').getActiveUser();if(activeUser){var uv=$CL.get('Ginger.Application.View.Partial.ActiveUser');uv.setElement($('#head-nav-right'));uv.setData(activeUser.toJSON());uv.render();layout.addChild(uv);}
var b=$CL.get("Ginger.Application.View.Helper.Breadcrumbs");b.setData(e.getParam('breadcrumbs',[]));layout.addChild(b);var sidebar=e.getParam('sidebar');if(!sidebar||!$CL.isInstanceOf(sidebar,Cl.Backbone.View)){sidebar=$CL.get('Ginger.Dashboard.View.Index.Sidebar');}
sidebar.setElement($('#js-sidebar'));layout.addChild(sidebar);var footer=e.getParam('footer');if(!footer||!$CL.isInstanceOf(footer,Cl.Backbone.View)){footer=$CL.get('Ginger.Application.View.Partial.Footer');}
footer.setElement($('#js-footer'));layout.addChild(footer);}},90);var _checkSidebar=function(){if($('#js-sidebar').children().first().hasClass('visible-large-desktop')&&$('#js-sidebar').children().first().is(':hidden')){$('#js-sidebar').parent().removeClass('span4').addClass('span0');$('#js_content').removeClass('span8').addClass('span12');}else{$('#js-sidebar').parent().removeClass('span0').addClass('span4');$('#js_content').removeClass('span12').addClass('span8');}
if($('#js-sidebar').children().first().hasClass('topbar-on-small-devices')){$('#js-sidebar').children().first().removeClass('overrideDisplay');if($('#js-sidebar').children().first().is(':hidden')){if($('#js-sidebar').parent().hasClass('span4')||$('#js-sidebar').parent().hasClass('span0')){$('#js-sidebar').parent().removeClass('span4').addClass('span12');$('#js-sidebar').children().first().addClass('overrideDisplay');var $newRow=$('<div />').addClass('row-fluid').append($('#js-sidebar').parent());$('#js_content').removeClass('span8').addClass('span12').parent().before($newRow);}}else{$('#js-sidebar').parent().removeClass('span12').addClass('span4');$('#js-sidebar').children().first().removeClass('overrideDisplay');$('#js_content').removeClass('span12').addClass('span8').after($('#js-sidebar').parent());$('#js_content').prev().remove();}}
if($('#js-sidebar').children().first().hasClass('bottombar-on-small-devices')){$('#js-sidebar').children().first().removeClass('overrideDisplay');if($('#js-sidebar').children().first().is(':hidden')){if($('#js-sidebar').parent().hasClass('span4')||$('#js-sidebar').parent().hasClass('span0')){$('#js-sidebar').parent().removeClass('span4').addClass('span12');$('#js-sidebar').children().first().addClass('overrideDisplay');var $newRow=$('<div />').attr('id','sidebar-to-bottombar').addClass('row-fluid').append($('#js-sidebar').parent());$('#js_content').removeClass('span8').addClass('span12').parent().after($newRow);}}else{$('#js-sidebar').parent().removeClass('span12').addClass('span4');$('#js-sidebar').children().first().removeClass('overrideDisplay');$('#js_content').removeClass('span12').addClass('span8').after($('#js-sidebar').parent());$('#js_content').next('#sidebar-to-bottombar').remove();}}}
$CL.get("application").events().attach("finish",function(){_checkSidebar();});$(window).resize(function(){_checkSidebar();});window.helpers={uri:function(route,params){return $CL.get("application").router.getUri(route,params);},datetime:function(dbDateStr){if(!dbDateStr){return"-";}
var dbDate=Date.parseDate(dbDateStr,Date.getDbStrFmt(true)),dbStr=dbDate.toString(true);if(dbDate.getHours()>11){dbStr+=" "+$CL.translate('GENERAL::TIME::AM');}else{dbStr+=" "+$CL.translate('GENERAL::TIME::PM');}
return dbStr;},time:function(dbDateStr){if(!dbDateStr){return"-";}
var dbDate=Date.parseDate(dbDateStr,Date.getDbStrFmt(true)),dbStr=dbDate.toString(true,true);if(dbDate.getHours()>11){dbStr+=" "+$CL.translate('GENERAL::TIME::AM');}else{dbStr+=" "+$CL.translate('GENERAL::TIME::PM');}
return dbStr;},duration:function(start,end){if(!start||!end){return"-";}
var startDate=Date.parseDate(start,Date.getDbStrFmt(true)),endDate=Date.parseDate(end,Date.getDbStrFmt(true)),duration=endDate.toTimestamp()-startDate.toTimestamp(),durationStr="",h=0,min=0,sec=0;if(duration>0){if(duration<60){sec=duration;}else{min=Math.floor(duration/60);sec=duration%60;if(min>59){h=Math.floor(min/60);min=min%60;}}}
if(h>0){durationStr+=h+" h ";}
if(min>0){durationStr+=min+" min ";}
durationStr+=sec+" s";return durationStr;},wrapVisibleSpans:function(text,separator){var textParts=text.split(separator);var newText="";_.each(textParts,function(part,i){newText+='<span '
+((i+1<textParts.length)?'class="visible-large-desktop"':'')
+'>'
+part
+((i+1<textParts.length)?separator:'')
+'</span>';});return newText;}};var authAdapter=$CL.get('auth_adapter');$CL.attachBeforeAjaxSend($CL.bind(authAdapter.onBeforeAjaxSend,authAdapter));},getController:function(controllerName){controllerName=controllerName.ucfirst();if($CL.classExists("Ginger.Application.Controller."+controllerName)){return $CL.get("Ginger.Application.Controller."+controllerName);}else{$CL.exception("unknown controllername","Ginger.Application.Module",controllerName);}}};var View=$CL.namespace("Cl.Application.View");$CL.require("Cl.Application.View.RenderingStrategyInterface")
View.DefaultStrategy=function DefaultStrategy(){this.__IMPLEMENTS__=[Cl.Application.View.RenderingStrategyInterface];};View.DefaultStrategy.prototype={onRender:function(mvcEvent){var response=mvcEvent.getResponse(),routeMatch=mvcEvent.getRouteMatch(),tplId=mvcEvent.getParam('tpl_id',"#"+routeMatch.getModule()+"_"+routeMatch.getController()+"_"+routeMatch.getAction()+"_template");if($CL.$(tplId).length!=1){$CL.exception("No template found with id: "+tplId,"Cl.Application.Application");}
var tpl=_.template($CL.$(tplId).html());if(!_.isObject(response)){response={content:response};}
var $targetEl=mvcEvent.getParam('$_target_el',$(tplId.replace('_template','')));if($targetEl.length>0){$targetEl.html(tpl(response));}}};var Mvc=$CL.namespace("Cl.Application.Mvc");$CL.require("Cl.Event.Event");Mvc.MvcEvent=function MvcEvent(){};$CL.extendClass(Mvc.MvcEvent,Cl.Event.Event,{setup:function(options){var params={application:options.application,routeMatch:options.routeMatch};if($CL.isDefined(options.params)){params=_.extend(options.params,params);}
this.parent.setup.call(this,_.extend(options,{target:"application",name:"dispatch",params:params}));},getApplication:function(){return this.params.appliation;},getRouteMatch:function(){return this.params.routeMatch;},setResponse:function(response){this.setParam("response",response);return this;},getResponse:function(){return this.getParam("response",{content:""});},continuePropagation:function(){this.propagationStopped=false;}});var Bootstrap=$CL.namespace("Cl.Application.Bootstrap");$CL.require("Cl.Event.Event");Bootstrap.BootstrapEvent=function BootstrapEvent(){};$CL.extendClass(Bootstrap.BootstrapEvent,Cl.Event.Event,{setup:function(options){var params={application:options.application};if($CL.isDefined(options.params)){params=_.extend(options.params,params);}
this.parent.setup(_.extend(options,{target:"application",name:"bootstrap",params:params}));},getModuleManager:function(){return this.params.application.moduleManager;},getApplication:function(){return this.params.application;}});var Module=$CL.namespace("Cl.Application.Module");$CL.require("Cl.Event.Event");Module.LoadModuleEvent=function LoadModuleEvent(){};$CL.extendClass(Module.LoadModuleEvent,Cl.Event.Event,{setup:function(options){var params={moduleManager:options.moduleManager,application:options.application,moduleName:options.moduleName,module:options.module};if($CL.isDefined(options.params)){params=_.extend(options.params,params);}
this.parent.setup(_.extend(options,{target:"application",name:"loadModule",params:params}));},getModuleManager:function(){return this.parent.params.moduleManager;},getApplication:function(){return this.params.application;},getModuleName:function(){return this.parent.params.moduleName;},getModule:function(){return this.parent.params.module;}});var Module=$CL.namespace("Cl.Application.Module");$CL.require("Cl.Core.String");$CL.require("Cl.Application.Module.LoadModuleEvent");Module.ModuleManager=function ModuleManager(){};(function(mm){mm.prototype={setup:function(options){this.application=options.application;this.modules={};},loadModules:function(){if(this.application.modules.length>0){for(var i=0;i<this.application.modules.length;i++){this.loadModule(this.application.modules[i]);}}},loadModule:function(moduleName){moduleName=_getModuleName(moduleName);var module=$CL.get(moduleName);if(_.isNull(module)){$CL.exception('Load module '+moduleName+' failed.','Cl.Application.Module.ModuleManager');}
this.modules[moduleName]=module;if($CL.isDefined(this.modules[moduleName]['getConfig'])){this.application.config=this._mergeConfig(this.application.config,this.modules[moduleName].getConfig());}
if($CL.isDefined(this.modules[moduleName]['onBootstrap'])){this.application.events().attach("bootstrap",$CL.bind(this.modules[moduleName]['onBootstrap'],this.modules[moduleName]));}
var loadEvent=$CL.makeObj("Cl.Application.Module.LoadModuleEvent",{moduleManager:this,application:this.application,moduleName:moduleName,module:this.modules[moduleName]});this.application.events().trigger(loadEvent);},hasModule:function(moduleName){return _getModuleName(moduleName)!==null;},getModule:function(moduleName){if(moduleName=_getModuleName(moduleName)){return this.modules[moduleName];}
return null;},_mergeConfig:function(config1,config2){var oldValue,newValue;for(var key in config2){oldValue=config1[key];newValue=config2[key];if(typeof oldValue==typeof newValue){if(_.isArray(oldValue)){config1[key]=oldValue.concat(newValue);}else if(_.isObject(oldValue)){config1[key]=this._mergeConfig(oldValue,newValue);}else{config1[key]=newValue;}}else{config1[key]=newValue;}}
return config1;}};function _getModuleName(moduleName){if($CL.classExists(moduleName)){return moduleName;}else if(_.isString(moduleName)&&moduleName!=""){moduleName=moduleName.ucfirst()+".Module";if($CL.classExists(moduleName)){return moduleName;}}
return null;}})(Module.ModuleManager);var Router=$CL.namespace("Cl.Application.Router");Router.RouteMatch=function RouteMatch(){};Router.RouteMatch.prototype={params:{},setup:function(options){_.extend(this,options);},getRoute:function(){if($CL.has(this,"route"))
return this.route;else
return"";},getModule:function(){if($CL.has(this,"module"))
return this.module;else
return"";},getController:function(){if($CL.has(this,"controller"))
return this.controller;else
return"";},getAction:function(){if($CL.has(this,"action"))
return this.action;else
return"";},getParams:function(){if($CL.has(this,"params")){return this.params;}else{return{};}},getParam:function(key,defaultVal){if($CL.has(this.params,key)){return this.params[key];}
return defaultVal;}};var Router=$CL.namespace("Cl.Application.Router");$CL.require("Cl.Event.Event");Router.RouteEvent=function RouteEvent(){};$CL.extendClass(Router.RouteEvent,Cl.Event.Event,{setup:function(options){var params={routeMatch:options.routeMatch,application:options.application};if($CL.isDefined(options.params)){params=_.extend(options.params,params);}
this.parent.setup(_.extend(options,{target:"application",name:"route",params:params}));},getRouteMatch:function(){return this.parent.params.routeMatch;},getApplication:function(){return this.params.application;}});var Event=$CL.namespace("Cl.Event");$CL.require("Cl.Event.Event");Event.SharedManager=function SharedEventManager(){this.emInstances=0;};(function(em){em.prototype={setup:function(options){this.targets={};},registerTarget:function(target){this.targets[target]={events:{}};return this;},hasTarget:function(target){return typeof this.targets[target]!="undefined";},hasEvent:function(target,event){if(!this.hasTarget(target))
return false;if(!$CL.has(this.targets[target].events,event)){return false;}
return true;},registerEvent:function(target,event){if(!this.hasTarget(target)){$CL.exception('target: '+target+' not registered',"Cl.Event.SharedManager",{target:target,event:event});}
if(!this.hasEvent(target,event)){this.targets[target].events[event]=[];}
return this;},attach:function(target,event,listener,priority,triggerOnce){if(!this.hasTarget(target)){this.registerTarget(target);}
if(!this.hasEvent(target,event)){this.registerEvent(target,event);}
if(!$CL.isDefined(priority)){priority=0;}
if(!$CL.isDefined(triggerOnce)){triggerOnce=false;}
this.targets[target].events[event].push({listener:listener,priority:parseInt(priority),triggerOnce:triggerOnce});return this;},detach:function(target,event,listener){if(this.hasEvent(target,event)){var events=this.targets[target].events[event];var foundLIstener=false;if(_.isString(listener)&&listener=="all"){delete this.targets[target].events[event];return;}
for(var i=0;i<events.length;i++){if(events[i].listener==listener){foundLIstener=events[i];break;}}
if(event){this.targets[target].events[event]=_.without(this.targets[target].events[event],foundLIstener);}}
return this;},trigger:function(eventOrTarget,eventName){var target,targetId,eName,event,responseCollection=[];if($CL.isInstanceOf(eventOrTarget,Cl.Event.Event)){target=eventOrTarget.target;eName=eventOrTarget.name;event=eventOrTarget;}else{target=eventOrTarget;eName=eventName;event=$CL.makeObj("Cl.Event.Event",{target:target,name:eName});}
if(target.indexOf('___')!=-1){var targetArr=target.split('___');target=targetArr[0];targetId=targetArr[1];event.target=target;}else{targetId="";}
if(this.hasEvent(target,eName)||this.hasEvent(target+'___'+targetId,eName)){var listeners=[];if(this.hasEvent(target+'___'+targetId,eName)){listeners=listeners.concat(this.targets[target+'___'+targetId].events[eName]);}
if(this.hasEvent(target,eName)){listeners=listeners.concat(this.targets[target].events[eName]);}
listeners.sort(function(a,b){return a.priority-b.priority;}).reverse();for(var i=0;i<listeners.length;i++){var listener=listeners[i].listener;if(typeof listener=="object"){var context=listener[1];listener=listener[0];listener=$CL.bind(listener,context);}
if(typeof listener!="function"){$CL.exception("Listener is not a function","Cl.Event.SharedManager",{listeners:listeners,listener:listener});}
if(listeners[i].triggerOnce){this.detach(target,eName,listeners[i].listener);}
responseCollection.push(listener(event));if(event.isPropagationStopped()){break;}}
var tol=[];if(this.hasEvent(target+'___'+targetId,eName)){tol=_.filter(this.targets[target+'___'+targetId].events[eName],function(l){return l.triggerOnce;});if(tol.length>0){_.each(tol,function(l){this.detach(target+'___'+targetId,eName,l.listener);},this);}}
if(this.hasEvent(target,eName)){tol=_.filter(this.targets[target].events[eName],function(l){return l.triggerOnce;});if(tol.length>0){_.each(tol,function(l){this.detach(target,eName,l.listener);},this);}}}
return responseCollection;},getNewInstanceId:function(){this.emInstances++;return this.emInstances;}}})(Event.SharedManager);$CL.invokables["shared_event_manager"]="Cl.Event.SharedManager";var Application=$CL.namespace("Cl.Application");$CL.require("Cl.Backbone.Backbone");$CL.require("Cl.Event.SharedManager");$CL.require("Cl.Event.Manager");$CL.require("Cl.Application.Router.RouteEvent");$CL.require("Cl.Application.Router.RouteMatch");$CL.require("Cl.Application.Module.ModuleManager");$CL.require("Cl.Application.Bootstrap.BootstrapEvent");$CL.require("Cl.Application.Mvc.MvcEvent");$CL.require("Cl.Application.View.DefaultStrategy");$CL.require("Cl.Application.View.RendererInterface");Application.Application=function(){this.runningLoads={};};(function(app){app.prototype={setup:function(options){if(!$CL.isDefined(options)){options={};}
this.config={router:{routes:{'default':{route:':module/:controller/:action',callback:function(module,controller,action){return $CL.makeObj("Cl.Application.Router.RouteMatch",{module:module,controller:controller,action:action});},build:function(routeParams){return routeParams.module+"/"+routeParams.controller+"/"+routeParams.action;}},'pageNotFound':{route:'application/404',callback:function(){window.location.href=window.location.href.replace(/\/[^/]+$/,'/404');},build:function(routeParams){return"application/404";}}},history:{}},view:{strategies:[{key:"Cl.Application.View.DefaultStrategy",priority:-100}]},lazy_load_module_url:"/codelinerjs/load-module/:modulename/default"};if($CL.isDefined(options.app_url)){this.config.router.root=options.app_url;}
this.modules=[];if($CL.isDefined(options.modules)){this.modules=options.modules;}},init:function(){_initModules.call(this);_.each(this.config.view.strategies,$CL.bind(function(strategyConfig){var strategy=$CL.get(strategyConfig.key);if(_.isNull(strategy)){$CL.exception("Can not get strategy from serviceManager","Cl.Application.Application",{strategy:strategyConfig.key});}
if(!$CL.isInstanceOf(strategy,Cl.Application.View.RenderingStrategyInterface)){$CL.exception("Provided view strategy does not implement Cl.Application.View.RenderingStrategyInterface","Cl.Application.Application",{strategy:$CL.className(strategy)});}
this.events().attach("render",[strategy.onRender,strategy],strategyConfig.priority||0);},this));},bootstrap:function(){var bootstrapEvent=$CL.makeObj("Cl.Application.Bootstrap.BootstrapEvent",{application:this});this.events().trigger(bootstrapEvent);return this;},run:function(){_initRouter.call(this);if(!this.router.isPageReload()){Backbone.history.start(this.config.router.history);}else{this.router.navigate=function(url,options){if($CL.isDefined(options.trigger)&&options.trigger){window.location.href=url;}}}
this.events().trigger("run");},events:function(){if(!$CL.has(this,"__eventManager")){this["__eventManager"]=$CL.get("event_manager",{target:"application"});}
return this["__eventManager"];},dispatch:function(routeMatch){if(!$CL.isInstanceOf(routeMatch,Cl.Application.Router.RouteMatch)){$CL.exception("routeMatch has to be instance of Cl.Application.Router.RouteMatch","Cl.Application",{method:"application.dispatch",routeMatch:routeMatch});}
if(routeMatch.getModule()==""||!this.moduleManager.hasModule(routeMatch.getModule())){$CL.exception("Can not dispatch routeMatch, no module found","Cl.Application.Application",{routeMatch:routeMatch,modules:this.moduleManager.modules});}
if(routeMatch.getController()==""){$CL.exception("Can not dispatch routeMatch, no controller provided","Cl.Application.Application",{routeMatch:routeMatch});}
var controller=this.moduleManager.getModule(routeMatch.getModule()).getController(routeMatch.getController());var mvcEvent=$CL.makeObj("Cl.Application.Mvc.MvcEvent",{application:this,routeMatch:routeMatch});mvcEvent.name="dispatch.pre";this.events().trigger(mvcEvent);if(mvcEvent.isPropagationStopped())
return;mvcEvent.name="dispatch";var response=controller.dispatch(mvcEvent);if(mvcEvent.isPropagationStopped()){return;}
mvcEvent.setResponse(response);this.continueDispatch(mvcEvent);},continueDispatch:function(mvcEvent,ignoreZombieEvent){if(!$CL.isDefined(ignoreZombieEvent)){ignoreZombieEvent=false;}
if(!ignoreZombieEvent&&this.router.getCurrentRouteMatch()!=mvcEvent.getRouteMatch()){$CL.log("blocked zombie event");return;}
mvcEvent.continuePropagation();mvcEvent.name="dispatch.post";this.events().trigger(mvcEvent);if(mvcEvent.isPropagationStopped()){return;}
var response=mvcEvent.getResponse();if(_.isNull(response)){response="";}
if(!$CL.isInstanceOf(response,Cl.Application.View.RendererInterface)){var module=mvcEvent.getRouteMatch().getModule().ucfirst();var controller=mvcEvent.getRouteMatch().getController().ucfirst();var action=mvcEvent.getRouteMatch().getAction().ucfirst();var viewClass=module+".View."+controller+"."+action;if($CL.classExists(viewClass)){var view=$CL.get(viewClass);var tplKey=module.toLowerCase()+"/"+controller.toLowerCase()+"/"+action.toLowerCase();if($CL.isDefined(__TEMPLATES__[tplKey])){view.setTemplate($CL._template(tplKey));}
if(_.isObject(response)){view.setData(response);}else if(_.isString(response)){view.setData({content:response});}
mvcEvent.setResponse(view);}}
this.render(mvcEvent);},render:function(mvcEvent){mvcEvent.name="render";this.events().trigger(mvcEvent);mvcEvent.continuePropagation();var activeView=mvcEvent.getResponse();this.previousView=activeView;this.finish(mvcEvent);},finish:function(mvcEvent){mvcEvent.name="finish";this.events().trigger(mvcEvent);var view=mvcEvent.getResponse();},wait:function(){this.events().trigger("wait");return this;},stopWait:function(checkPageReload){if(!$CL.isDefined(checkPageReload)){checkPageReload=false;}
if(checkPageReload){if(this.router.isPageReload()){return this;}}
this.events().trigger("stopWait");return this;},alert:function(msg,jqX){if($CL.isDefined(jqX)&&$CL.has(jqX,"responseText")){msg+="\nServer Response: "+jqX.responseText;}
var event=$CL.get('Cl.Event.Event',{name:"alert",params:{msg:msg}});this.events().trigger(event);return this;},lazyLoadModule:function(moduleName,callback){if(!this.moduleManager.hasModule(moduleName)){this.wait();if(!$CL.isDefined(callback)){callback=function(){};}
var url=this.config.lazy_load_module_url.replace(':modulename',moduleName);if(!$CL.isDefined(this.runningLoads[moduleName])){this.runningLoads[moduleName]=[];}
this.runningLoads[moduleName].push(callback);$.getScript(url).done($CL.bind(function(){this.moduleManager.loadModule(moduleName);var module=this.moduleManager.getModule(moduleName);if($CL.isDefined(module['getConfig'])){var config=module.getConfig();if($CL.isDefined(config['service_manager'])){$CL.addServiceConfig(config['service_manager']);}
if($CL.isDefined(config['router'])){var routes=config.router.routes;$.each(routes,$CL.bind(function(routeName,routeConfig){this.config.router.routes[routeName]=routeConfig;this.router.route(routeConfig.route,routeName);this.router.on('route:'+routeName,_routerRouteCallback,{routeName:routeName,routeConfig:routeConfig,application:this});},this));}}
if($CL.isDefined(module['onBootstrap'])){var bootstrapEvent=$CL.makeObj("Cl.Application.Bootstrap.BootstrapEvent",{application:this});module.onBootstrap(bootstrapEvent);}
_.each(this.runningLoads[moduleName],function(cb){cb();});delete this.runningLoads[moduleName];this.stopWait(false);},this)).fail($CL.bind(function(){this.alert('Lazy loading of module: '+moduleName+' failed.');this.stopWait();},this));}else{callback();}}};function _initRouter(){var routes=this.config.router.routes;var Router=Backbone.Router.extend({hashChange:null,'initialize':function(){var router=this;$.each(routes,function(routeName,routeConfig){router.route(routeConfig.route,routeName);});},getUri:$CL.bind(function(routeNameOrParams,params){return this.router._callRouteConfig("getUri",routeNameOrParams,params);},this),callUri:function(uri){this.navigate(encodeURI(uri),{trigger:true});},callRoute:function(routeNameOrParams,params){this.callUri(this.getUri(routeNameOrParams,params));},forward:function(routeNameOrParams,params){this._callRouteConfig("forward",routeNameOrParams,params);},getCurrentRouteMatch:function(){if($CL.has(this,"currentRouteMatch")){return this.currentRouteMatch;}else{return null;}},setCurrentRouteMatch:function(routeMatch){this.currentRouteMatch=routeMatch;},hasRoute:function(routeLink){var hasRoute=false;_.any(Backbone.history.handlers,function(handler){if(handler.route.test(routeLink)){hasRoute=true;return true;}});return hasRoute;},_callRouteConfig:$CL.bind(function(mode,routeNameOrParams,params){var currentRouteMatch=this.router.getCurrentRouteMatch();if(typeof routeNameOrParams!="string"){params=routeNameOrParams;if(currentRouteMatch!==null)
routeNameOrParams=currentRouteMatch.getRoute();else
routeNameOrParams="default";}
if(!$CL.isDefined(params)){params={};}
if(currentRouteMatch!==null&&currentRouteMatch.getRoute()==routeNameOrParams){var currentParams=_.extend({module:currentRouteMatch.getModule(),controller:currentRouteMatch.getController(),action:currentRouteMatch.getAction(),route:currentRouteMatch.getRoute()},currentRouteMatch.getParams());params=_.extend(currentParams,params);}
var routeConfig=this.config.router.routes[routeNameOrParams];if(!$CL.isDefined(routeConfig)){$CL.exception("route is not defined in config","Cl.Application.Application",{routeName:routeNameOrParams});}
var routeLink=routeConfig.build(params);if(mode=="getUri"){return routeLink;}else if(mode=="forward"){_.any(Backbone.history.handlers,function(handler){if(handler.route.test(routeLink)){handler.callback(routeLink);return true;}});}},this),isPageReload:function()
{if(!(window.history&&window.history.pushState)){var config=$CL.get('Configuration');if($CL.isDefined(config.router)&&$CL.isDefined(config.router.history)){var config=config.router.history;if($CL.isDefined(config.hashChange)){return config.hashChange===false;}}}
return false;}});this.router=new Router();$.each(routes,$CL.bind(function(routeName,routeConfig){this.router.on('route:'+routeName,_routerRouteCallback,{routeName:routeName,routeConfig:routeConfig,application:this});},this));}
function _initModules(){this.moduleManager=$CL.makeObj("Cl.Application.Module.ModuleManager",{application:this});this.moduleManager.loadModules();if($CL.has(this.config,'service_manager')){$CL.addServiceConfig(this.config['service_manager']);}
$CL.register("Configuration",this.config);}
function _routerRouteCallback(){if(arguments){_.map(arguments,decodeURIComponent);}
var routeMatch=this.routeConfig.callback.apply(this.routeConfig,arguments);if(!$CL.isInstanceOf(routeMatch,Cl.Application.Router.RouteMatch)){$CL.exception("Callback did not return a RouteMatch object","Cl.Application",{routeName:this.routeName,routeConfig:this.routeConfig});}
routeMatch.route=this.routeName;this.application.router.setCurrentRouteMatch(routeMatch);var routeEvent=$CL.makeObj("Cl.Application.Router.RouteEvent",{application:this.application,routeMatch:routeMatch});this.application.events().trigger(routeEvent);this.application.router.setCurrentRouteMatch(routeEvent.getRouteMatch());this.application.dispatch(routeEvent.getRouteMatch());}})(Application.Application);var Ginger=$CL.namespace("Ginger");$CL.require("Cl.Application.Application");Ginger.AppInitializer=function(){};Ginger.AppInitializer.prototype={init:function(){$CL.log('loaded modules: ',["Ginger.Application.Module","Ginger.Dashboard.Module","Ginger.Jobs.Module","Ginger.Users.Module"]);var application=$CL.makeObj("Cl.Application.Application",{modules:["Ginger.Application.Module","Ginger.Dashboard.Module","Ginger.Jobs.Module","Ginger.Users.Module"]});var eventManager=$CL.get("shared_event_manager");eventManager.attach("application","wait",function(){if($("#overlay").length==0){$("body").append($("<div />").attr("id","overlay").css({top:"0px",left:"0px",width:"100%",height:"100%",position:"fixed",backgroundColor:"#eee",opacity:"0.4"}).html("&nbsp;"));}});eventManager.attach("application","stopWait",function(){$("#overlay").remove();});eventManager.attach("application","alert",function(e){alert(e.getParam('msg',$CL.translate('ERROR:ERROR')+'\n'+
$CL.translate("ERROR:SORRY")));});$CL.register('application',application);var hash=window.location.hash.replace('#','');window.location.hash="";application.bootstrap().run();if($CL.variable('$LOGIN_REQUIRED',false)){if(_.isNull($CL.get('auth_adapter').getActiveApiKey())){$CL.app().router.callRoute('application_auth_login');return;}}
if(hash==""){$CL.get("application").router.callRoute('dashboard');}else{if($CL.get("application").router.hasRoute(hash)){window.location.hash=hash;}else{var moduleData=_.find($CL.variable('connect_modules',[]),function(data){return hash.indexOf(data.module.toLowerCase()+"/")==0;});if(moduleData){$CL.get('application').lazyLoadModule(moduleData.module,function(){window.location.hash=hash;});}else{$CL.get("application").alert("Can not dispatch the route: "+hash);}}}}};$CL.translate=function(transKey){if($CL.isDefined(window['__TRANSLATIONS__'])&&$CL.isDefined(__TRANSLATIONS__[transKey])){return __TRANSLATIONS__[transKey];}else{return transKey;}};$CL.translatePlural=function(transKey,count){var transObj=this.translate(transKey);if(!_.isObject(transObj)){$CL.exception('Plural translation for key '+transKey+' failed. No plural translation found!','Cl.Core');}
var index=(count==1)?1:0;return transObj[index];}
$CL.loadTranslation=function(locale){$CL.exception('loadTranslation is not supported yet','Cl.Core');}